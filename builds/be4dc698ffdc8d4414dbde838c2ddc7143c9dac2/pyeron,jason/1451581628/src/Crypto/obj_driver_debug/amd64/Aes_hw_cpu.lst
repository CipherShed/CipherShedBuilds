     1                                  ;
     2                                  ; Copyright (c) 2010 TrueCrypt Developers Association. All rights reserved.
     3                                  ;
     4                                  ; Governed by the TrueCrypt License 3.0 the full text of which is contained in
     5                                  ; the file License.txt included in TrueCrypt binary and source code distribution
     6                                  ; packages.
     7                                  ;
     8                                  
     9                                  
    10                                  %ifidn __BITS__, 16
    11                                  	%define R e
    12                                  %elifidn __BITS__, 32
    13                                  	%define R e
    14                                  %elifidn __BITS__, 64
    15                                  	%define R r
    16                                  %endif
    17                                  
    18                                  
    19                                  %macro export_function 1-2 0
    20                                  
    21                                  	%ifdef MS_STDCALL
    22                                  		global %1@%2
    23                                  		export _%1@%2
    24                                  	%1@%2:
    25                                  	%elifidn __BITS__, 16
    26                                  		global _%1
    27                                  	_%1:
    28                                  	%else
    29                                  		global %1
    30                                  	%1:
    31                                  	%endif
    32                                  
    33                                  %endmacro
    34                                  
    35                                  
    36                                  %macro aes_function_entry 1
    37                                  
    38                                  	; void (const byte *ks, byte *data);
    39                                  
    40                                  	export_function %1, 8
    41                                  
    42                                  	%ifidn __BITS__, 32
    43                                  		mov ecx, [esp + 4 + 4 * 0]
    44                                  		mov edx, [esp + 4 + 4 * 1]
    45                                  	%elifidn __BITS__, 64
    46                                  		%ifnidn __OUTPUT_FORMAT__, win64
    47                                  			mov rcx, rdi
    48                                  			mov rdx, rsi
    49                                  		%endif
    50                                  	%endif
    51                                  
    52                                  	; ecx/rcx = ks
    53                                  	; edx/rdx = data
    54                                  
    55                                  %endmacro
    56                                  
    57                                  
    58                                  %macro aes_function_exit 0
    59                                  
    60                                  	; void (const byte *, byte *);
    61                                  
    62                                  	%ifdef MS_STDCALL
    63                                  		ret 8
    64                                  	%else
    65                                  		ret
    66                                  	%endif
    67                                  
    68                                  %endmacro
    69                                  
    70                                  
    71                                  %macro push_xmm 2
    72                                  	sub rsp, 16 * (%2 - %1 + 1)
    73                                  
    74                                  	%assign stackoffset 0
    75                                  	%assign regnumber %1
    76                                  
    77                                  	%rep (%2 - %1 + 1)
    78                                  		movdqu [rsp + 16 * stackoffset], xmm%[regnumber]
    79                                  
    80                                  		%assign stackoffset stackoffset+1
    81                                  		%assign regnumber regnumber+1
    82                                  	%endrep
    83                                  %endmacro
    84                                  
    85                                  
    86                                  %macro pop_xmm 2
    87                                  	%assign stackoffset 0
    88                                  	%assign regnumber %1
    89                                  
    90                                  	%rep (%2 - %1 + 1)
    91                                  		movdqu xmm%[regnumber], [rsp + 16 * stackoffset]
    92                                  
    93                                  		%assign stackoffset stackoffset+1
    94                                  		%assign regnumber regnumber+1
    95                                  	%endrep
    96                                  
    97                                  	add rsp, 16 * (%2 - %1 + 1)
    98                                  %endmacro
    99                                  
   100                                  
   101                                  %macro aes_hw_cpu 2
   102                                  	%define OPERATION %1
   103                                  	%define BLOCK_COUNT %2
   104                                  
   105                                  	; Load data blocks
   106                                  	%assign block 1
   107                                  	%rep BLOCK_COUNT
   108                                  		movdqu xmm%[block], [%[R]dx + 16 * (block - 1)]
   109                                  		%assign block block+1
   110                                  	%endrep
   111                                  
   112                                  	; Encrypt/decrypt data blocks
   113                                  	%assign round 0
   114                                  	%rep 15
   115                                  		movdqu xmm0, [%[R]cx + 16 * round]
   116                                  
   117                                  		%assign block 1
   118                                  		%rep BLOCK_COUNT
   119                                  
   120                                  			%if round = 0
   121                                  				pxor xmm%[block], xmm0
   122                                  			%else
   123                                  				%if round < 14
   124                                  					aes%[OPERATION] xmm%[block], xmm0
   125                                  				%else
   126                                  					aes%[OPERATION]last xmm%[block], xmm0
   127                                  				%endif
   128                                  			%endif
   129                                  
   130                                  			%assign block block+1
   131                                  		%endrep
   132                                  
   133                                  		%assign round round+1
   134                                  	%endrep
   135                                  
   136                                  	; Store data blocks
   137                                  	%assign block 1
   138                                  	%rep BLOCK_COUNT
   139                                  		movdqu [%[R]dx + 16 * (block - 1)], xmm%[block]
   140                                  		%assign block block+1
   141                                  	%endrep
   142                                  
   143                                  	%undef OPERATION
   144                                  	%undef BLOCK_COUNT
   145                                  %endmacro
   146                                  
   147                                  
   148                                  %macro aes_hw_cpu_32_blocks 1
   149                                  	%define OPERATION_32_BLOCKS %1
   150                                  
   151                                  	%ifidn __BITS__, 64
   152                                  		%define MAX_REG_BLOCK_COUNT 15
   153                                  	%else
   154                                  		%define MAX_REG_BLOCK_COUNT 7
   155                                  	%endif
   156                                  
   157                                  	%ifidn __OUTPUT_FORMAT__, win64
   158                                  		%if MAX_REG_BLOCK_COUNT > 5
   159                                  			push_xmm 6, MAX_REG_BLOCK_COUNT
   160                                  		%endif
   161                                  	%endif
   162                                  
   163                                  		mov eax, 32 / MAX_REG_BLOCK_COUNT
   164                                  	.1:
   165                                  		aes_hw_cpu %[OPERATION_32_BLOCKS], MAX_REG_BLOCK_COUNT
   166                                  
   167                                  		add %[R]dx, 16 * MAX_REG_BLOCK_COUNT
   168                                  		dec eax
   169                                  		jnz .1
   170                                  
   171                                  	%if (32 % MAX_REG_BLOCK_COUNT) != 0
   172                                  		aes_hw_cpu %[OPERATION_32_BLOCKS], (32 % MAX_REG_BLOCK_COUNT)
   173                                  	%endif
   174                                  
   175                                  	%ifidn __OUTPUT_FORMAT__, win64
   176                                  		%if MAX_REG_BLOCK_COUNT > 5
   177                                  			pop_xmm 6, MAX_REG_BLOCK_COUNT
   178                                  		%endif
   179                                  	%endif
   180                                  
   181                                  	%undef OPERATION_32_BLOCKS
   182                                  	%undef MAX_REG_BLOCK_COUNT
   183                                  %endmacro
   184                                  
   185                                  
   186                                  %ifidn __BITS__, 16
   187                                  
   188                                  	USE16
   189                                  	SEGMENT _TEXT PUBLIC CLASS=CODE USE16
   190                                  	SEGMENT _DATA PUBLIC CLASS=DATA USE16
   191                                  	GROUP DGROUP _TEXT _DATA
   192                                  	SECTION _TEXT
   193                                  
   194                                  %else
   195                                  
   196                                  	SECTION .text
   197                                  
   198                                  %endif
   199                                  
   200                                  
   201                                  ; void aes_hw_cpu_enable_sse ();
   202                                  
   203                                  	export_function aes_hw_cpu_enable_sse
   204                              <1> 
   205                              <1>  %ifdef MS_STDCALL
   206                              <1>  global %1@%2
   207                              <1>  export _%1@%2
   208                              <1>  %1@%2:
   209                              <1>  %elifidn __BITS__, 16
   210                              <1>  global _%1
   211                              <1>  _%1:
   212                              <1>  %else
   213                              <1>  global %1
   214                              <1>  %1:
   215                              <1>  %endif
   216                              <1> 
   217 00000000 0F20E0                  		mov %[R]ax, cr4
   218 00000003 660D0002                		or ax, 1 << 9
   219 00000007 0F22E0                  		mov cr4, %[R]ax
   220 0000000A C3                      	ret
   221                                  
   222                                  
   223                                  %ifidn __BITS__, 16
   224                                  
   225                                  
   226                                  ; byte is_aes_hw_cpu_supported ();
   227                                  
   228                                  	export_function is_aes_hw_cpu_supported
   229                                  		mov eax, 1
   230                                  		cpuid
   231                                  		mov eax, ecx
   232                                  		shr eax, 25
   233                                  		and al, 1
   234                                  	ret
   235                                  
   236                                  
   237                                  ; void aes_hw_cpu_decrypt (const byte *ks, byte *data);
   238                                  
   239                                  	export_function aes_hw_cpu_decrypt
   240                                  		mov ax, -16
   241                                  		jmp aes_hw_cpu_encrypt_decrypt
   242                                  
   243                                  ; void aes_hw_cpu_encrypt (const byte *ks, byte *data);
   244                                  
   245                                  	export_function aes_hw_cpu_encrypt
   246                                  		mov ax, 16
   247                                  
   248                                  	aes_hw_cpu_encrypt_decrypt:
   249                                  		push bp
   250                                  		mov bp, sp
   251                                  		push di
   252                                  		push si
   253                                  
   254                                  		mov si, [bp + 4]			; ks
   255                                  		mov di, [bp + 4 + 2]		; data
   256                                  
   257                                  		movdqu xmm0, [si]
   258                                  		movdqu xmm1, [di]
   259                                  
   260                                  		pxor xmm1, xmm0
   261                                  
   262                                  		mov cx, 13
   263                                  
   264                                  	.round1_13:
   265                                  		add si, ax
   266                                  		movdqu xmm0, [si]
   267                                  
   268                                  		cmp ax, 0
   269                                  		jl .decrypt
   270                                  		
   271                                  		aesenc xmm1, xmm0
   272                                  		jmp .2
   273                                  	.decrypt:
   274                                  		aesdec xmm1, xmm0
   275                                  	.2:
   276                                  		loop .round1_13
   277                                  
   278                                  		add si, ax
   279                                  		movdqu xmm0, [si]
   280                                  		
   281                                  		cmp ax, 0
   282                                  		jl .decrypt_last
   283                                  
   284                                  		aesenclast xmm1, xmm0
   285                                  		jmp .3
   286                                  	.decrypt_last:
   287                                  		aesdeclast xmm1, xmm0
   288                                  	.3:
   289                                  		movdqu [di], xmm1
   290                                  
   291                                  		pop si
   292                                  		pop di
   293                                  		pop bp
   294                                  	ret
   295                                  
   296                                  
   297                                  %else	; __BITS__ != 16
   298                                  
   299                                  
   300                                  ; byte is_aes_hw_cpu_supported ();
   301                                  
   302                                  	export_function is_aes_hw_cpu_supported
   303                              <1> 
   304                              <1>  %ifdef MS_STDCALL
   305                              <1>  global %1@%2
   306                              <1>  export _%1@%2
   307                              <1>  %1@%2:
   308                              <1>  %elifidn __BITS__, 16
   309                              <1>  global _%1
   310                              <1>  _%1:
   311                              <1>  %else
   312                              <1>  global %1
   313                              <1>  %1:
   314                              <1>  %endif
   315                              <1> 
   316 0000000B 53                      		push %[R]bx
   317                                  
   318 0000000C B801000000              		mov eax, 1
   319 00000011 0FA2                    		cpuid
   320 00000013 89C8                    		mov eax, ecx
   321 00000015 C1E819                  		shr eax, 25
   322 00000018 83E001                  		and eax, 1
   323                                  
   324 0000001B 5B                      		pop %[R]bx
   325 0000001C C3                      	ret
   326                                  
   327                                  
   328                                  ; void aes_hw_cpu_decrypt (const byte *ks, byte *data);
   329                                  
   330                                  	aes_function_entry aes_hw_cpu_decrypt
   331                              <1> 
   332                              <1> 
   333                              <1> 
   334                              <1>  export_function %1, 8
   335                              <2> 
   336                              <2>  %ifdef MS_STDCALL
   337                              <2>  global %1@%2
   338                              <2>  export _%1@%2
   339                              <2>  %1@%2:
   340                              <2>  %elifidn __BITS__, 16
   341                              <2>  global _%1
   342                              <2>  _%1:
   343                              <2>  %else
   344                              <2>  global %1
   345                              <2>  %1:
   346                              <2>  %endif
   347                              <2> 
   348                              <1> 
   349                              <1>  %ifidn __BITS__, 32
   350                              <1>  mov ecx, [esp + 4 + 4 * 0]
   351                              <1>  mov edx, [esp + 4 + 4 * 1]
   352                              <1>  %elifidn __BITS__, 64
   353                              <1>  %ifnidn __OUTPUT_FORMAT__, win64
   354                              <1>  mov rcx, rdi
   355                              <1>  mov rdx, rsi
   356                              <1>  %endif
   357                              <1>  %endif
   358                              <1> 
   359                              <1> 
   360                              <1> 
   361                              <1> 
   362                                  		aes_hw_cpu dec, 1
   363                              <1>  %define OPERATION %1
   364                              <1>  %define BLOCK_COUNT %2
   365                              <1> 
   366                              <1> 
   367                              <1>  %assign block 1
   368                              <1>  %rep BLOCK_COUNT
   369                              <1>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
   370                              <1>  %assign block block+1
   371                              <1>  %endrep
   372 0000001D F30F6F0A            <2>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
   373                              <2>  %assign block block+1
   374                              <1> 
   375                              <1> 
   376                              <1>  %assign round 0
   377                              <1>  %rep 15
   378                              <1>  movdqu xmm0, [Rcx + 16 * round]
   379                              <1> 
   380                              <1>  %assign block 1
   381                              <1>  %rep BLOCK_COUNT
   382                              <1> 
   383                              <1>  %if round = 0
   384                              <1>  pxor xmmblock, xmm0
   385                              <1>  %else
   386                              <1>  %if round < 14
   387                              <1>  aesOPERATION xmmblock, xmm0
   388                              <1>  %else
   389                              <1>  aesOPERATIONlast xmmblock, xmm0
   390                              <1>  %endif
   391                              <1>  %endif
   392                              <1> 
   393                              <1>  %assign block block+1
   394                              <1>  %endrep
   395                              <1> 
   396                              <1>  %assign round round+1
   397                              <1>  %endrep
   398 00000021 F30F6F01            <2>  movdqu xmm0, [Rcx + 16 * round]
   399                              <2> 
   400                              <2>  %assign block 1
   401                              <2>  %rep BLOCK_COUNT
   402                              <2> 
   403                              <2>  %if round = 0
   404                              <2>  pxor xmmblock, xmm0
   405                              <2>  %else
   406                              <2>  %if round < 14
   407                              <2>  aesOPERATION xmmblock, xmm0
   408                              <2>  %else
   409                              <2>  aesOPERATIONlast xmmblock, xmm0
   410                              <2>  %endif
   411                              <2>  %endif
   412                              <2> 
   413                              <2>  %assign block block+1
   414                              <2>  %endrep
   415                              <3> 
   416                              <3>  %if round = 0
   417 00000025 660FEFC8            <3>  pxor xmmblock, xmm0
   418                              <3>  %else
   419                              <3>  %if round < 14
   420                              <3>  aesOPERATION xmmblock, xmm0
   421                              <3>  %else
   422                              <3>  aesOPERATIONlast xmmblock, xmm0
   423                              <3>  %endif
   424                              <3>  %endif
   425                              <3> 
   426                              <3>  %assign block block+1
   427                              <2> 
   428                              <2>  %assign round round+1
   429 00000029 F30F6F4110          <2>  movdqu xmm0, [Rcx + 16 * round]
   430                              <2> 
   431                              <2>  %assign block 1
   432                              <2>  %rep BLOCK_COUNT
   433                              <2> 
   434                              <2>  %if round = 0
   435                              <2>  pxor xmmblock, xmm0
   436                              <2>  %else
   437                              <2>  %if round < 14
   438                              <2>  aesOPERATION xmmblock, xmm0
   439                              <2>  %else
   440                              <2>  aesOPERATIONlast xmmblock, xmm0
   441                              <2>  %endif
   442                              <2>  %endif
   443                              <2> 
   444                              <2>  %assign block block+1
   445                              <2>  %endrep
   446                              <3> 
   447                              <3>  %if round = 0
   448                              <3>  pxor xmmblock, xmm0
   449                              <3>  %else
   450                              <3>  %if round < 14
   451 0000002E 660F38DEC8          <3>  aesOPERATION xmmblock, xmm0
   452                              <3>  %else
   453                              <3>  aesOPERATIONlast xmmblock, xmm0
   454                              <3>  %endif
   455                              <3>  %endif
   456                              <3> 
   457                              <3>  %assign block block+1
   458                              <2> 
   459                              <2>  %assign round round+1
   460 00000033 F30F6F4120          <2>  movdqu xmm0, [Rcx + 16 * round]
   461                              <2> 
   462                              <2>  %assign block 1
   463                              <2>  %rep BLOCK_COUNT
   464                              <2> 
   465                              <2>  %if round = 0
   466                              <2>  pxor xmmblock, xmm0
   467                              <2>  %else
   468                              <2>  %if round < 14
   469                              <2>  aesOPERATION xmmblock, xmm0
   470                              <2>  %else
   471                              <2>  aesOPERATIONlast xmmblock, xmm0
   472                              <2>  %endif
   473                              <2>  %endif
   474                              <2> 
   475                              <2>  %assign block block+1
   476                              <2>  %endrep
   477                              <3> 
   478                              <3>  %if round = 0
   479                              <3>  pxor xmmblock, xmm0
   480                              <3>  %else
   481                              <3>  %if round < 14
   482 00000038 660F38DEC8          <3>  aesOPERATION xmmblock, xmm0
   483                              <3>  %else
   484                              <3>  aesOPERATIONlast xmmblock, xmm0
   485                              <3>  %endif
   486                              <3>  %endif
   487                              <3> 
   488                              <3>  %assign block block+1
   489                              <2> 
   490                              <2>  %assign round round+1
   491 0000003D F30F6F4130          <2>  movdqu xmm0, [Rcx + 16 * round]
   492                              <2> 
   493                              <2>  %assign block 1
   494                              <2>  %rep BLOCK_COUNT
   495                              <2> 
   496                              <2>  %if round = 0
   497                              <2>  pxor xmmblock, xmm0
   498                              <2>  %else
   499                              <2>  %if round < 14
   500                              <2>  aesOPERATION xmmblock, xmm0
   501                              <2>  %else
   502                              <2>  aesOPERATIONlast xmmblock, xmm0
   503                              <2>  %endif
   504                              <2>  %endif
   505                              <2> 
   506                              <2>  %assign block block+1
   507                              <2>  %endrep
   508                              <3> 
   509                              <3>  %if round = 0
   510                              <3>  pxor xmmblock, xmm0
   511                              <3>  %else
   512                              <3>  %if round < 14
   513 00000042 660F38DEC8          <3>  aesOPERATION xmmblock, xmm0
   514                              <3>  %else
   515                              <3>  aesOPERATIONlast xmmblock, xmm0
   516                              <3>  %endif
   517                              <3>  %endif
   518                              <3> 
   519                              <3>  %assign block block+1
   520                              <2> 
   521                              <2>  %assign round round+1
   522 00000047 F30F6F4140          <2>  movdqu xmm0, [Rcx + 16 * round]
   523                              <2> 
   524                              <2>  %assign block 1
   525                              <2>  %rep BLOCK_COUNT
   526                              <2> 
   527                              <2>  %if round = 0
   528                              <2>  pxor xmmblock, xmm0
   529                              <2>  %else
   530                              <2>  %if round < 14
   531                              <2>  aesOPERATION xmmblock, xmm0
   532                              <2>  %else
   533                              <2>  aesOPERATIONlast xmmblock, xmm0
   534                              <2>  %endif
   535                              <2>  %endif
   536                              <2> 
   537                              <2>  %assign block block+1
   538                              <2>  %endrep
   539                              <3> 
   540                              <3>  %if round = 0
   541                              <3>  pxor xmmblock, xmm0
   542                              <3>  %else
   543                              <3>  %if round < 14
   544 0000004C 660F38DEC8          <3>  aesOPERATION xmmblock, xmm0
   545                              <3>  %else
   546                              <3>  aesOPERATIONlast xmmblock, xmm0
   547                              <3>  %endif
   548                              <3>  %endif
   549                              <3> 
   550                              <3>  %assign block block+1
   551                              <2> 
   552                              <2>  %assign round round+1
   553 00000051 F30F6F4150          <2>  movdqu xmm0, [Rcx + 16 * round]
   554                              <2> 
   555                              <2>  %assign block 1
   556                              <2>  %rep BLOCK_COUNT
   557                              <2> 
   558                              <2>  %if round = 0
   559                              <2>  pxor xmmblock, xmm0
   560                              <2>  %else
   561                              <2>  %if round < 14
   562                              <2>  aesOPERATION xmmblock, xmm0
   563                              <2>  %else
   564                              <2>  aesOPERATIONlast xmmblock, xmm0
   565                              <2>  %endif
   566                              <2>  %endif
   567                              <2> 
   568                              <2>  %assign block block+1
   569                              <2>  %endrep
   570                              <3> 
   571                              <3>  %if round = 0
   572                              <3>  pxor xmmblock, xmm0
   573                              <3>  %else
   574                              <3>  %if round < 14
   575 00000056 660F38DEC8          <3>  aesOPERATION xmmblock, xmm0
   576                              <3>  %else
   577                              <3>  aesOPERATIONlast xmmblock, xmm0
   578                              <3>  %endif
   579                              <3>  %endif
   580                              <3> 
   581                              <3>  %assign block block+1
   582                              <2> 
   583                              <2>  %assign round round+1
   584 0000005B F30F6F4160          <2>  movdqu xmm0, [Rcx + 16 * round]
   585                              <2> 
   586                              <2>  %assign block 1
   587                              <2>  %rep BLOCK_COUNT
   588                              <2> 
   589                              <2>  %if round = 0
   590                              <2>  pxor xmmblock, xmm0
   591                              <2>  %else
   592                              <2>  %if round < 14
   593                              <2>  aesOPERATION xmmblock, xmm0
   594                              <2>  %else
   595                              <2>  aesOPERATIONlast xmmblock, xmm0
   596                              <2>  %endif
   597                              <2>  %endif
   598                              <2> 
   599                              <2>  %assign block block+1
   600                              <2>  %endrep
   601                              <3> 
   602                              <3>  %if round = 0
   603                              <3>  pxor xmmblock, xmm0
   604                              <3>  %else
   605                              <3>  %if round < 14
   606 00000060 660F38DEC8          <3>  aesOPERATION xmmblock, xmm0
   607                              <3>  %else
   608                              <3>  aesOPERATIONlast xmmblock, xmm0
   609                              <3>  %endif
   610                              <3>  %endif
   611                              <3> 
   612                              <3>  %assign block block+1
   613                              <2> 
   614                              <2>  %assign round round+1
   615 00000065 F30F6F4170          <2>  movdqu xmm0, [Rcx + 16 * round]
   616                              <2> 
   617                              <2>  %assign block 1
   618                              <2>  %rep BLOCK_COUNT
   619                              <2> 
   620                              <2>  %if round = 0
   621                              <2>  pxor xmmblock, xmm0
   622                              <2>  %else
   623                              <2>  %if round < 14
   624                              <2>  aesOPERATION xmmblock, xmm0
   625                              <2>  %else
   626                              <2>  aesOPERATIONlast xmmblock, xmm0
   627                              <2>  %endif
   628                              <2>  %endif
   629                              <2> 
   630                              <2>  %assign block block+1
   631                              <2>  %endrep
   632                              <3> 
   633                              <3>  %if round = 0
   634                              <3>  pxor xmmblock, xmm0
   635                              <3>  %else
   636                              <3>  %if round < 14
   637 0000006A 660F38DEC8          <3>  aesOPERATION xmmblock, xmm0
   638                              <3>  %else
   639                              <3>  aesOPERATIONlast xmmblock, xmm0
   640                              <3>  %endif
   641                              <3>  %endif
   642                              <3> 
   643                              <3>  %assign block block+1
   644                              <2> 
   645                              <2>  %assign round round+1
   646 0000006F F30F6F8180000000    <2>  movdqu xmm0, [Rcx + 16 * round]
   647                              <2> 
   648                              <2>  %assign block 1
   649                              <2>  %rep BLOCK_COUNT
   650                              <2> 
   651                              <2>  %if round = 0
   652                              <2>  pxor xmmblock, xmm0
   653                              <2>  %else
   654                              <2>  %if round < 14
   655                              <2>  aesOPERATION xmmblock, xmm0
   656                              <2>  %else
   657                              <2>  aesOPERATIONlast xmmblock, xmm0
   658                              <2>  %endif
   659                              <2>  %endif
   660                              <2> 
   661                              <2>  %assign block block+1
   662                              <2>  %endrep
   663                              <3> 
   664                              <3>  %if round = 0
   665                              <3>  pxor xmmblock, xmm0
   666                              <3>  %else
   667                              <3>  %if round < 14
   668 00000077 660F38DEC8          <3>  aesOPERATION xmmblock, xmm0
   669                              <3>  %else
   670                              <3>  aesOPERATIONlast xmmblock, xmm0
   671                              <3>  %endif
   672                              <3>  %endif
   673                              <3> 
   674                              <3>  %assign block block+1
   675                              <2> 
   676                              <2>  %assign round round+1
   677 0000007C F30F6F8190000000    <2>  movdqu xmm0, [Rcx + 16 * round]
   678                              <2> 
   679                              <2>  %assign block 1
   680                              <2>  %rep BLOCK_COUNT
   681                              <2> 
   682                              <2>  %if round = 0
   683                              <2>  pxor xmmblock, xmm0
   684                              <2>  %else
   685                              <2>  %if round < 14
   686                              <2>  aesOPERATION xmmblock, xmm0
   687                              <2>  %else
   688                              <2>  aesOPERATIONlast xmmblock, xmm0
   689                              <2>  %endif
   690                              <2>  %endif
   691                              <2> 
   692                              <2>  %assign block block+1
   693                              <2>  %endrep
   694                              <3> 
   695                              <3>  %if round = 0
   696                              <3>  pxor xmmblock, xmm0
   697                              <3>  %else
   698                              <3>  %if round < 14
   699 00000084 660F38DEC8          <3>  aesOPERATION xmmblock, xmm0
   700                              <3>  %else
   701                              <3>  aesOPERATIONlast xmmblock, xmm0
   702                              <3>  %endif
   703                              <3>  %endif
   704                              <3> 
   705                              <3>  %assign block block+1
   706                              <2> 
   707                              <2>  %assign round round+1
   708 00000089 F30F6F81A0000000    <2>  movdqu xmm0, [Rcx + 16 * round]
   709                              <2> 
   710                              <2>  %assign block 1
   711                              <2>  %rep BLOCK_COUNT
   712                              <2> 
   713                              <2>  %if round = 0
   714                              <2>  pxor xmmblock, xmm0
   715                              <2>  %else
   716                              <2>  %if round < 14
   717                              <2>  aesOPERATION xmmblock, xmm0
   718                              <2>  %else
   719                              <2>  aesOPERATIONlast xmmblock, xmm0
   720                              <2>  %endif
   721                              <2>  %endif
   722                              <2> 
   723                              <2>  %assign block block+1
   724                              <2>  %endrep
   725                              <3> 
   726                              <3>  %if round = 0
   727                              <3>  pxor xmmblock, xmm0
   728                              <3>  %else
   729                              <3>  %if round < 14
   730 00000091 660F38DEC8          <3>  aesOPERATION xmmblock, xmm0
   731                              <3>  %else
   732                              <3>  aesOPERATIONlast xmmblock, xmm0
   733                              <3>  %endif
   734                              <3>  %endif
   735                              <3> 
   736                              <3>  %assign block block+1
   737                              <2> 
   738                              <2>  %assign round round+1
   739 00000096 F30F6F81B0000000    <2>  movdqu xmm0, [Rcx + 16 * round]
   740                              <2> 
   741                              <2>  %assign block 1
   742                              <2>  %rep BLOCK_COUNT
   743                              <2> 
   744                              <2>  %if round = 0
   745                              <2>  pxor xmmblock, xmm0
   746                              <2>  %else
   747                              <2>  %if round < 14
   748                              <2>  aesOPERATION xmmblock, xmm0
   749                              <2>  %else
   750                              <2>  aesOPERATIONlast xmmblock, xmm0
   751                              <2>  %endif
   752                              <2>  %endif
   753                              <2> 
   754                              <2>  %assign block block+1
   755                              <2>  %endrep
   756                              <3> 
   757                              <3>  %if round = 0
   758                              <3>  pxor xmmblock, xmm0
   759                              <3>  %else
   760                              <3>  %if round < 14
   761 0000009E 660F38DEC8          <3>  aesOPERATION xmmblock, xmm0
   762                              <3>  %else
   763                              <3>  aesOPERATIONlast xmmblock, xmm0
   764                              <3>  %endif
   765                              <3>  %endif
   766                              <3> 
   767                              <3>  %assign block block+1
   768                              <2> 
   769                              <2>  %assign round round+1
   770 000000A3 F30F6F81C0000000    <2>  movdqu xmm0, [Rcx + 16 * round]
   771                              <2> 
   772                              <2>  %assign block 1
   773                              <2>  %rep BLOCK_COUNT
   774                              <2> 
   775                              <2>  %if round = 0
   776                              <2>  pxor xmmblock, xmm0
   777                              <2>  %else
   778                              <2>  %if round < 14
   779                              <2>  aesOPERATION xmmblock, xmm0
   780                              <2>  %else
   781                              <2>  aesOPERATIONlast xmmblock, xmm0
   782                              <2>  %endif
   783                              <2>  %endif
   784                              <2> 
   785                              <2>  %assign block block+1
   786                              <2>  %endrep
   787                              <3> 
   788                              <3>  %if round = 0
   789                              <3>  pxor xmmblock, xmm0
   790                              <3>  %else
   791                              <3>  %if round < 14
   792 000000AB 660F38DEC8          <3>  aesOPERATION xmmblock, xmm0
   793                              <3>  %else
   794                              <3>  aesOPERATIONlast xmmblock, xmm0
   795                              <3>  %endif
   796                              <3>  %endif
   797                              <3> 
   798                              <3>  %assign block block+1
   799                              <2> 
   800                              <2>  %assign round round+1
   801 000000B0 F30F6F81D0000000    <2>  movdqu xmm0, [Rcx + 16 * round]
   802                              <2> 
   803                              <2>  %assign block 1
   804                              <2>  %rep BLOCK_COUNT
   805                              <2> 
   806                              <2>  %if round = 0
   807                              <2>  pxor xmmblock, xmm0
   808                              <2>  %else
   809                              <2>  %if round < 14
   810                              <2>  aesOPERATION xmmblock, xmm0
   811                              <2>  %else
   812                              <2>  aesOPERATIONlast xmmblock, xmm0
   813                              <2>  %endif
   814                              <2>  %endif
   815                              <2> 
   816                              <2>  %assign block block+1
   817                              <2>  %endrep
   818                              <3> 
   819                              <3>  %if round = 0
   820                              <3>  pxor xmmblock, xmm0
   821                              <3>  %else
   822                              <3>  %if round < 14
   823 000000B8 660F38DEC8          <3>  aesOPERATION xmmblock, xmm0
   824                              <3>  %else
   825                              <3>  aesOPERATIONlast xmmblock, xmm0
   826                              <3>  %endif
   827                              <3>  %endif
   828                              <3> 
   829                              <3>  %assign block block+1
   830                              <2> 
   831                              <2>  %assign round round+1
   832 000000BD F30F6F81E0000000    <2>  movdqu xmm0, [Rcx + 16 * round]
   833                              <2> 
   834                              <2>  %assign block 1
   835                              <2>  %rep BLOCK_COUNT
   836                              <2> 
   837                              <2>  %if round = 0
   838                              <2>  pxor xmmblock, xmm0
   839                              <2>  %else
   840                              <2>  %if round < 14
   841                              <2>  aesOPERATION xmmblock, xmm0
   842                              <2>  %else
   843                              <2>  aesOPERATIONlast xmmblock, xmm0
   844                              <2>  %endif
   845                              <2>  %endif
   846                              <2> 
   847                              <2>  %assign block block+1
   848                              <2>  %endrep
   849                              <3> 
   850                              <3>  %if round = 0
   851                              <3>  pxor xmmblock, xmm0
   852                              <3>  %else
   853                              <3>  %if round < 14
   854                              <3>  aesOPERATION xmmblock, xmm0
   855                              <3>  %else
   856 000000C5 660F38DFC8          <3>  aesOPERATIONlast xmmblock, xmm0
   857                              <3>  %endif
   858                              <3>  %endif
   859                              <3> 
   860                              <3>  %assign block block+1
   861                              <2> 
   862                              <2>  %assign round round+1
   863                              <1> 
   864                              <1> 
   865                              <1>  %assign block 1
   866                              <1>  %rep BLOCK_COUNT
   867                              <1>  movdqu [Rdx + 16 * (block - 1)], xmmblock
   868                              <1>  %assign block block+1
   869                              <1>  %endrep
   870 000000CA F30F7F0A            <2>  movdqu [Rdx + 16 * (block - 1)], xmmblock
   871                              <2>  %assign block block+1
   872                              <1> 
   873                              <1>  %undef OPERATION
   874                              <1>  %undef BLOCK_COUNT
   875                                  	aes_function_exit
   876                              <1> 
   877                              <1> 
   878                              <1> 
   879                              <1>  %ifdef MS_STDCALL
   880                              <1>  ret 8
   881                              <1>  %else
   882 000000CE C3                  <1>  ret
   883                              <1>  %endif
   884                              <1> 
   885                                  
   886                                  
   887                                  ; void aes_hw_cpu_decrypt_32_blocks (const byte *ks, byte *data);
   888                                  
   889                                  	aes_function_entry aes_hw_cpu_decrypt_32_blocks
   890                              <1> 
   891                              <1> 
   892                              <1> 
   893                              <1>  export_function %1, 8
   894                              <2> 
   895                              <2>  %ifdef MS_STDCALL
   896                              <2>  global %1@%2
   897                              <2>  export _%1@%2
   898                              <2>  %1@%2:
   899                              <2>  %elifidn __BITS__, 16
   900                              <2>  global _%1
   901                              <2>  _%1:
   902                              <2>  %else
   903                              <2>  global %1
   904                              <2>  %1:
   905                              <2>  %endif
   906                              <2> 
   907                              <1> 
   908                              <1>  %ifidn __BITS__, 32
   909                              <1>  mov ecx, [esp + 4 + 4 * 0]
   910                              <1>  mov edx, [esp + 4 + 4 * 1]
   911                              <1>  %elifidn __BITS__, 64
   912                              <1>  %ifnidn __OUTPUT_FORMAT__, win64
   913                              <1>  mov rcx, rdi
   914                              <1>  mov rdx, rsi
   915                              <1>  %endif
   916                              <1>  %endif
   917                              <1> 
   918                              <1> 
   919                              <1> 
   920                              <1> 
   921                                  		aes_hw_cpu_32_blocks dec
   922                              <1>  %define OPERATION_32_BLOCKS %1
   923                              <1> 
   924                              <1>  %ifidn __BITS__, 64
   925                              <1>  %define MAX_REG_BLOCK_COUNT 15
   926                              <1>  %else
   927                              <1>  %define MAX_REG_BLOCK_COUNT 7
   928                              <1>  %endif
   929                              <1> 
   930                              <1>  %ifidn __OUTPUT_FORMAT__, win64
   931                              <1>  %if MAX_REG_BLOCK_COUNT > 5
   932                              <1>  push_xmm 6, MAX_REG_BLOCK_COUNT
   933 000000CF 4881ECA0000000      <2>  sub rsp, 16 * (%2 - %1 + 1)
   934                              <2> 
   935                              <2>  %assign stackoffset 0
   936                              <2>  %assign regnumber %1
   937                              <2> 
   938                              <2>  %rep (%2 - %1 + 1)
   939                              <2>  movdqu [rsp + 16 * stackoffset], xmmregnumber
   940                              <2> 
   941                              <2>  %assign stackoffset stackoffset+1
   942                              <2>  %assign regnumber regnumber+1
   943                              <2>  %endrep
   944 000000D6 F30F7F3424          <3>  movdqu [rsp + 16 * stackoffset], xmmregnumber
   945                              <3> 
   946                              <3>  %assign stackoffset stackoffset+1
   947                              <3>  %assign regnumber regnumber+1
   948 000000DB F30F7F7C2410        <3>  movdqu [rsp + 16 * stackoffset], xmmregnumber
   949                              <3> 
   950                              <3>  %assign stackoffset stackoffset+1
   951                              <3>  %assign regnumber regnumber+1
   952 000000E1 F3440F7F442420      <3>  movdqu [rsp + 16 * stackoffset], xmmregnumber
   953                              <3> 
   954                              <3>  %assign stackoffset stackoffset+1
   955                              <3>  %assign regnumber regnumber+1
   956 000000E8 F3440F7F4C2430      <3>  movdqu [rsp + 16 * stackoffset], xmmregnumber
   957                              <3> 
   958                              <3>  %assign stackoffset stackoffset+1
   959                              <3>  %assign regnumber regnumber+1
   960 000000EF F3440F7F542440      <3>  movdqu [rsp + 16 * stackoffset], xmmregnumber
   961                              <3> 
   962                              <3>  %assign stackoffset stackoffset+1
   963                              <3>  %assign regnumber regnumber+1
   964 000000F6 F3440F7F5C2450      <3>  movdqu [rsp + 16 * stackoffset], xmmregnumber
   965                              <3> 
   966                              <3>  %assign stackoffset stackoffset+1
   967                              <3>  %assign regnumber regnumber+1
   968 000000FD F3440F7F642460      <3>  movdqu [rsp + 16 * stackoffset], xmmregnumber
   969                              <3> 
   970                              <3>  %assign stackoffset stackoffset+1
   971                              <3>  %assign regnumber regnumber+1
   972 00000104 F3440F7F6C2470      <3>  movdqu [rsp + 16 * stackoffset], xmmregnumber
   973                              <3> 
   974                              <3>  %assign stackoffset stackoffset+1
   975                              <3>  %assign regnumber regnumber+1
   976 0000010B F3440F7FB424800000- <3>  movdqu [rsp + 16 * stackoffset], xmmregnumber
   977 00000114 00                  <3>
   978                              <3> 
   979                              <3>  %assign stackoffset stackoffset+1
   980                              <3>  %assign regnumber regnumber+1
   981 00000115 F3440F7FBC24900000- <3>  movdqu [rsp + 16 * stackoffset], xmmregnumber
   982 0000011E 00                  <3>
   983                              <3> 
   984                              <3>  %assign stackoffset stackoffset+1
   985                              <3>  %assign regnumber regnumber+1
   986                              <1>  %endif
   987                              <1>  %endif
   988                              <1> 
   989 0000011F B802000000          <1>  mov eax, 32 / MAX_REG_BLOCK_COUNT
   990                              <1>  .1:
   991                              <1>  aes_hw_cpu OPERATION_32_BLOCKS, MAX_REG_BLOCK_COUNT
   992                              <2>  %define OPERATION %1
   993                              <2>  %define BLOCK_COUNT %2
   994                              <2> 
   995                              <2> 
   996                              <2>  %assign block 1
   997                              <2>  %rep BLOCK_COUNT
   998                              <2>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
   999                              <2>  %assign block block+1
  1000                              <2>  %endrep
  1001 00000124 F30F6F0A            <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  1002                              <3>  %assign block block+1
  1003 00000128 F30F6F5210          <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  1004                              <3>  %assign block block+1
  1005 0000012D F30F6F5A20          <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  1006                              <3>  %assign block block+1
  1007 00000132 F30F6F6230          <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  1008                              <3>  %assign block block+1
  1009 00000137 F30F6F6A40          <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  1010                              <3>  %assign block block+1
  1011 0000013C F30F6F7250          <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  1012                              <3>  %assign block block+1
  1013 00000141 F30F6F7A60          <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  1014                              <3>  %assign block block+1
  1015 00000146 F3440F6F4270        <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  1016                              <3>  %assign block block+1
  1017 0000014C F3440F6F8A80000000  <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  1018                              <3>  %assign block block+1
  1019 00000155 F3440F6F9290000000  <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  1020                              <3>  %assign block block+1
  1021 0000015E F3440F6F9AA0000000  <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  1022                              <3>  %assign block block+1
  1023 00000167 F3440F6FA2B0000000  <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  1024                              <3>  %assign block block+1
  1025 00000170 F3440F6FAAC0000000  <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  1026                              <3>  %assign block block+1
  1027 00000179 F3440F6FB2D0000000  <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  1028                              <3>  %assign block block+1
  1029 00000182 F3440F6FBAE0000000  <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  1030                              <3>  %assign block block+1
  1031                              <2> 
  1032                              <2> 
  1033                              <2>  %assign round 0
  1034                              <2>  %rep 15
  1035                              <2>  movdqu xmm0, [Rcx + 16 * round]
  1036                              <2> 
  1037                              <2>  %assign block 1
  1038                              <2>  %rep BLOCK_COUNT
  1039                              <2> 
  1040                              <2>  %if round = 0
  1041                              <2>  pxor xmmblock, xmm0
  1042                              <2>  %else
  1043                              <2>  %if round < 14
  1044                              <2>  aesOPERATION xmmblock, xmm0
  1045                              <2>  %else
  1046                              <2>  aesOPERATIONlast xmmblock, xmm0
  1047                              <2>  %endif
  1048                              <2>  %endif
  1049                              <2> 
  1050                              <2>  %assign block block+1
  1051                              <2>  %endrep
  1052                              <2> 
  1053                              <2>  %assign round round+1
  1054                              <2>  %endrep
  1055 0000018B F30F6F01            <3>  movdqu xmm0, [Rcx + 16 * round]
  1056                              <3> 
  1057                              <3>  %assign block 1
  1058                              <3>  %rep BLOCK_COUNT
  1059                              <3> 
  1060                              <3>  %if round = 0
  1061                              <3>  pxor xmmblock, xmm0
  1062                              <3>  %else
  1063                              <3>  %if round < 14
  1064                              <3>  aesOPERATION xmmblock, xmm0
  1065                              <3>  %else
  1066                              <3>  aesOPERATIONlast xmmblock, xmm0
  1067                              <3>  %endif
  1068                              <3>  %endif
  1069                              <3> 
  1070                              <3>  %assign block block+1
  1071                              <3>  %endrep
  1072                              <4> 
  1073                              <4>  %if round = 0
  1074 0000018F 660FEFC8            <4>  pxor xmmblock, xmm0
  1075                              <4>  %else
  1076                              <4>  %if round < 14
  1077                              <4>  aesOPERATION xmmblock, xmm0
  1078                              <4>  %else
  1079                              <4>  aesOPERATIONlast xmmblock, xmm0
  1080                              <4>  %endif
  1081                              <4>  %endif
  1082                              <4> 
  1083                              <4>  %assign block block+1
  1084                              <4> 
  1085                              <4>  %if round = 0
  1086 00000193 660FEFD0            <4>  pxor xmmblock, xmm0
  1087                              <4>  %else
  1088                              <4>  %if round < 14
  1089                              <4>  aesOPERATION xmmblock, xmm0
  1090                              <4>  %else
  1091                              <4>  aesOPERATIONlast xmmblock, xmm0
  1092                              <4>  %endif
  1093                              <4>  %endif
  1094                              <4> 
  1095                              <4>  %assign block block+1
  1096                              <4> 
  1097                              <4>  %if round = 0
  1098 00000197 660FEFD8            <4>  pxor xmmblock, xmm0
  1099                              <4>  %else
  1100                              <4>  %if round < 14
  1101                              <4>  aesOPERATION xmmblock, xmm0
  1102                              <4>  %else
  1103                              <4>  aesOPERATIONlast xmmblock, xmm0
  1104                              <4>  %endif
  1105                              <4>  %endif
  1106                              <4> 
  1107                              <4>  %assign block block+1
  1108                              <4> 
  1109                              <4>  %if round = 0
  1110 0000019B 660FEFE0            <4>  pxor xmmblock, xmm0
  1111                              <4>  %else
  1112                              <4>  %if round < 14
  1113                              <4>  aesOPERATION xmmblock, xmm0
  1114                              <4>  %else
  1115                              <4>  aesOPERATIONlast xmmblock, xmm0
  1116                              <4>  %endif
  1117                              <4>  %endif
  1118                              <4> 
  1119                              <4>  %assign block block+1
  1120                              <4> 
  1121                              <4>  %if round = 0
  1122 0000019F 660FEFE8            <4>  pxor xmmblock, xmm0
  1123                              <4>  %else
  1124                              <4>  %if round < 14
  1125                              <4>  aesOPERATION xmmblock, xmm0
  1126                              <4>  %else
  1127                              <4>  aesOPERATIONlast xmmblock, xmm0
  1128                              <4>  %endif
  1129                              <4>  %endif
  1130                              <4> 
  1131                              <4>  %assign block block+1
  1132                              <4> 
  1133                              <4>  %if round = 0
  1134 000001A3 660FEFF0            <4>  pxor xmmblock, xmm0
  1135                              <4>  %else
  1136                              <4>  %if round < 14
  1137                              <4>  aesOPERATION xmmblock, xmm0
  1138                              <4>  %else
  1139                              <4>  aesOPERATIONlast xmmblock, xmm0
  1140                              <4>  %endif
  1141                              <4>  %endif
  1142                              <4> 
  1143                              <4>  %assign block block+1
  1144                              <4> 
  1145                              <4>  %if round = 0
  1146 000001A7 660FEFF8            <4>  pxor xmmblock, xmm0
  1147                              <4>  %else
  1148                              <4>  %if round < 14
  1149                              <4>  aesOPERATION xmmblock, xmm0
  1150                              <4>  %else
  1151                              <4>  aesOPERATIONlast xmmblock, xmm0
  1152                              <4>  %endif
  1153                              <4>  %endif
  1154                              <4> 
  1155                              <4>  %assign block block+1
  1156                              <4> 
  1157                              <4>  %if round = 0
  1158 000001AB 66440FEFC0          <4>  pxor xmmblock, xmm0
  1159                              <4>  %else
  1160                              <4>  %if round < 14
  1161                              <4>  aesOPERATION xmmblock, xmm0
  1162                              <4>  %else
  1163                              <4>  aesOPERATIONlast xmmblock, xmm0
  1164                              <4>  %endif
  1165                              <4>  %endif
  1166                              <4> 
  1167                              <4>  %assign block block+1
  1168                              <4> 
  1169                              <4>  %if round = 0
  1170 000001B0 66440FEFC8          <4>  pxor xmmblock, xmm0
  1171                              <4>  %else
  1172                              <4>  %if round < 14
  1173                              <4>  aesOPERATION xmmblock, xmm0
  1174                              <4>  %else
  1175                              <4>  aesOPERATIONlast xmmblock, xmm0
  1176                              <4>  %endif
  1177                              <4>  %endif
  1178                              <4> 
  1179                              <4>  %assign block block+1
  1180                              <4> 
  1181                              <4>  %if round = 0
  1182 000001B5 66440FEFD0          <4>  pxor xmmblock, xmm0
  1183                              <4>  %else
  1184                              <4>  %if round < 14
  1185                              <4>  aesOPERATION xmmblock, xmm0
  1186                              <4>  %else
  1187                              <4>  aesOPERATIONlast xmmblock, xmm0
  1188                              <4>  %endif
  1189                              <4>  %endif
  1190                              <4> 
  1191                              <4>  %assign block block+1
  1192                              <4> 
  1193                              <4>  %if round = 0
  1194 000001BA 66440FEFD8          <4>  pxor xmmblock, xmm0
  1195                              <4>  %else
  1196                              <4>  %if round < 14
  1197                              <4>  aesOPERATION xmmblock, xmm0
  1198                              <4>  %else
  1199                              <4>  aesOPERATIONlast xmmblock, xmm0
  1200                              <4>  %endif
  1201                              <4>  %endif
  1202                              <4> 
  1203                              <4>  %assign block block+1
  1204                              <4> 
  1205                              <4>  %if round = 0
  1206 000001BF 66440FEFE0          <4>  pxor xmmblock, xmm0
  1207                              <4>  %else
  1208                              <4>  %if round < 14
  1209                              <4>  aesOPERATION xmmblock, xmm0
  1210                              <4>  %else
  1211                              <4>  aesOPERATIONlast xmmblock, xmm0
  1212                              <4>  %endif
  1213                              <4>  %endif
  1214                              <4> 
  1215                              <4>  %assign block block+1
  1216                              <4> 
  1217                              <4>  %if round = 0
  1218 000001C4 66440FEFE8          <4>  pxor xmmblock, xmm0
  1219                              <4>  %else
  1220                              <4>  %if round < 14
  1221                              <4>  aesOPERATION xmmblock, xmm0
  1222                              <4>  %else
  1223                              <4>  aesOPERATIONlast xmmblock, xmm0
  1224                              <4>  %endif
  1225                              <4>  %endif
  1226                              <4> 
  1227                              <4>  %assign block block+1
  1228                              <4> 
  1229                              <4>  %if round = 0
  1230 000001C9 66440FEFF0          <4>  pxor xmmblock, xmm0
  1231                              <4>  %else
  1232                              <4>  %if round < 14
  1233                              <4>  aesOPERATION xmmblock, xmm0
  1234                              <4>  %else
  1235                              <4>  aesOPERATIONlast xmmblock, xmm0
  1236                              <4>  %endif
  1237                              <4>  %endif
  1238                              <4> 
  1239                              <4>  %assign block block+1
  1240                              <4> 
  1241                              <4>  %if round = 0
  1242 000001CE 66440FEFF8          <4>  pxor xmmblock, xmm0
  1243                              <4>  %else
  1244                              <4>  %if round < 14
  1245                              <4>  aesOPERATION xmmblock, xmm0
  1246                              <4>  %else
  1247                              <4>  aesOPERATIONlast xmmblock, xmm0
  1248                              <4>  %endif
  1249                              <4>  %endif
  1250                              <4> 
  1251                              <4>  %assign block block+1
  1252                              <3> 
  1253                              <3>  %assign round round+1
  1254 000001D3 F30F6F4110          <3>  movdqu xmm0, [Rcx + 16 * round]
  1255                              <3> 
  1256                              <3>  %assign block 1
  1257                              <3>  %rep BLOCK_COUNT
  1258                              <3> 
  1259                              <3>  %if round = 0
  1260                              <3>  pxor xmmblock, xmm0
  1261                              <3>  %else
  1262                              <3>  %if round < 14
  1263                              <3>  aesOPERATION xmmblock, xmm0
  1264                              <3>  %else
  1265                              <3>  aesOPERATIONlast xmmblock, xmm0
  1266                              <3>  %endif
  1267                              <3>  %endif
  1268                              <3> 
  1269                              <3>  %assign block block+1
  1270                              <3>  %endrep
  1271                              <4> 
  1272                              <4>  %if round = 0
  1273                              <4>  pxor xmmblock, xmm0
  1274                              <4>  %else
  1275                              <4>  %if round < 14
  1276 000001D8 660F38DEC8          <4>  aesOPERATION xmmblock, xmm0
  1277                              <4>  %else
  1278                              <4>  aesOPERATIONlast xmmblock, xmm0
  1279                              <4>  %endif
  1280                              <4>  %endif
  1281                              <4> 
  1282                              <4>  %assign block block+1
  1283                              <4> 
  1284                              <4>  %if round = 0
  1285                              <4>  pxor xmmblock, xmm0
  1286                              <4>  %else
  1287                              <4>  %if round < 14
  1288 000001DD 660F38DED0          <4>  aesOPERATION xmmblock, xmm0
  1289                              <4>  %else
  1290                              <4>  aesOPERATIONlast xmmblock, xmm0
  1291                              <4>  %endif
  1292                              <4>  %endif
  1293                              <4> 
  1294                              <4>  %assign block block+1
  1295                              <4> 
  1296                              <4>  %if round = 0
  1297                              <4>  pxor xmmblock, xmm0
  1298                              <4>  %else
  1299                              <4>  %if round < 14
  1300 000001E2 660F38DED8          <4>  aesOPERATION xmmblock, xmm0
  1301                              <4>  %else
  1302                              <4>  aesOPERATIONlast xmmblock, xmm0
  1303                              <4>  %endif
  1304                              <4>  %endif
  1305                              <4> 
  1306                              <4>  %assign block block+1
  1307                              <4> 
  1308                              <4>  %if round = 0
  1309                              <4>  pxor xmmblock, xmm0
  1310                              <4>  %else
  1311                              <4>  %if round < 14
  1312 000001E7 660F38DEE0          <4>  aesOPERATION xmmblock, xmm0
  1313                              <4>  %else
  1314                              <4>  aesOPERATIONlast xmmblock, xmm0
  1315                              <4>  %endif
  1316                              <4>  %endif
  1317                              <4> 
  1318                              <4>  %assign block block+1
  1319                              <4> 
  1320                              <4>  %if round = 0
  1321                              <4>  pxor xmmblock, xmm0
  1322                              <4>  %else
  1323                              <4>  %if round < 14
  1324 000001EC 660F38DEE8          <4>  aesOPERATION xmmblock, xmm0
  1325                              <4>  %else
  1326                              <4>  aesOPERATIONlast xmmblock, xmm0
  1327                              <4>  %endif
  1328                              <4>  %endif
  1329                              <4> 
  1330                              <4>  %assign block block+1
  1331                              <4> 
  1332                              <4>  %if round = 0
  1333                              <4>  pxor xmmblock, xmm0
  1334                              <4>  %else
  1335                              <4>  %if round < 14
  1336 000001F1 660F38DEF0          <4>  aesOPERATION xmmblock, xmm0
  1337                              <4>  %else
  1338                              <4>  aesOPERATIONlast xmmblock, xmm0
  1339                              <4>  %endif
  1340                              <4>  %endif
  1341                              <4> 
  1342                              <4>  %assign block block+1
  1343                              <4> 
  1344                              <4>  %if round = 0
  1345                              <4>  pxor xmmblock, xmm0
  1346                              <4>  %else
  1347                              <4>  %if round < 14
  1348 000001F6 660F38DEF8          <4>  aesOPERATION xmmblock, xmm0
  1349                              <4>  %else
  1350                              <4>  aesOPERATIONlast xmmblock, xmm0
  1351                              <4>  %endif
  1352                              <4>  %endif
  1353                              <4> 
  1354                              <4>  %assign block block+1
  1355                              <4> 
  1356                              <4>  %if round = 0
  1357                              <4>  pxor xmmblock, xmm0
  1358                              <4>  %else
  1359                              <4>  %if round < 14
  1360 000001FB 66440F38DEC0        <4>  aesOPERATION xmmblock, xmm0
  1361                              <4>  %else
  1362                              <4>  aesOPERATIONlast xmmblock, xmm0
  1363                              <4>  %endif
  1364                              <4>  %endif
  1365                              <4> 
  1366                              <4>  %assign block block+1
  1367                              <4> 
  1368                              <4>  %if round = 0
  1369                              <4>  pxor xmmblock, xmm0
  1370                              <4>  %else
  1371                              <4>  %if round < 14
  1372 00000201 66440F38DEC8        <4>  aesOPERATION xmmblock, xmm0
  1373                              <4>  %else
  1374                              <4>  aesOPERATIONlast xmmblock, xmm0
  1375                              <4>  %endif
  1376                              <4>  %endif
  1377                              <4> 
  1378                              <4>  %assign block block+1
  1379                              <4> 
  1380                              <4>  %if round = 0
  1381                              <4>  pxor xmmblock, xmm0
  1382                              <4>  %else
  1383                              <4>  %if round < 14
  1384 00000207 66440F38DED0        <4>  aesOPERATION xmmblock, xmm0
  1385                              <4>  %else
  1386                              <4>  aesOPERATIONlast xmmblock, xmm0
  1387                              <4>  %endif
  1388                              <4>  %endif
  1389                              <4> 
  1390                              <4>  %assign block block+1
  1391                              <4> 
  1392                              <4>  %if round = 0
  1393                              <4>  pxor xmmblock, xmm0
  1394                              <4>  %else
  1395                              <4>  %if round < 14
  1396 0000020D 66440F38DED8        <4>  aesOPERATION xmmblock, xmm0
  1397                              <4>  %else
  1398                              <4>  aesOPERATIONlast xmmblock, xmm0
  1399                              <4>  %endif
  1400                              <4>  %endif
  1401                              <4> 
  1402                              <4>  %assign block block+1
  1403                              <4> 
  1404                              <4>  %if round = 0
  1405                              <4>  pxor xmmblock, xmm0
  1406                              <4>  %else
  1407                              <4>  %if round < 14
  1408 00000213 66440F38DEE0        <4>  aesOPERATION xmmblock, xmm0
  1409                              <4>  %else
  1410                              <4>  aesOPERATIONlast xmmblock, xmm0
  1411                              <4>  %endif
  1412                              <4>  %endif
  1413                              <4> 
  1414                              <4>  %assign block block+1
  1415                              <4> 
  1416                              <4>  %if round = 0
  1417                              <4>  pxor xmmblock, xmm0
  1418                              <4>  %else
  1419                              <4>  %if round < 14
  1420 00000219 66440F38DEE8        <4>  aesOPERATION xmmblock, xmm0
  1421                              <4>  %else
  1422                              <4>  aesOPERATIONlast xmmblock, xmm0
  1423                              <4>  %endif
  1424                              <4>  %endif
  1425                              <4> 
  1426                              <4>  %assign block block+1
  1427                              <4> 
  1428                              <4>  %if round = 0
  1429                              <4>  pxor xmmblock, xmm0
  1430                              <4>  %else
  1431                              <4>  %if round < 14
  1432 0000021F 66440F38DEF0        <4>  aesOPERATION xmmblock, xmm0
  1433                              <4>  %else
  1434                              <4>  aesOPERATIONlast xmmblock, xmm0
  1435                              <4>  %endif
  1436                              <4>  %endif
  1437                              <4> 
  1438                              <4>  %assign block block+1
  1439                              <4> 
  1440                              <4>  %if round = 0
  1441                              <4>  pxor xmmblock, xmm0
  1442                              <4>  %else
  1443                              <4>  %if round < 14
  1444 00000225 66440F38DEF8        <4>  aesOPERATION xmmblock, xmm0
  1445                              <4>  %else
  1446                              <4>  aesOPERATIONlast xmmblock, xmm0
  1447                              <4>  %endif
  1448                              <4>  %endif
  1449                              <4> 
  1450                              <4>  %assign block block+1
  1451                              <3> 
  1452                              <3>  %assign round round+1
  1453 0000022B F30F6F4120          <3>  movdqu xmm0, [Rcx + 16 * round]
  1454                              <3> 
  1455                              <3>  %assign block 1
  1456                              <3>  %rep BLOCK_COUNT
  1457                              <3> 
  1458                              <3>  %if round = 0
  1459                              <3>  pxor xmmblock, xmm0
  1460                              <3>  %else
  1461                              <3>  %if round < 14
  1462                              <3>  aesOPERATION xmmblock, xmm0
  1463                              <3>  %else
  1464                              <3>  aesOPERATIONlast xmmblock, xmm0
  1465                              <3>  %endif
  1466                              <3>  %endif
  1467                              <3> 
  1468                              <3>  %assign block block+1
  1469                              <3>  %endrep
  1470                              <4> 
  1471                              <4>  %if round = 0
  1472                              <4>  pxor xmmblock, xmm0
  1473                              <4>  %else
  1474                              <4>  %if round < 14
  1475 00000230 660F38DEC8          <4>  aesOPERATION xmmblock, xmm0
  1476                              <4>  %else
  1477                              <4>  aesOPERATIONlast xmmblock, xmm0
  1478                              <4>  %endif
  1479                              <4>  %endif
  1480                              <4> 
  1481                              <4>  %assign block block+1
  1482                              <4> 
  1483                              <4>  %if round = 0
  1484                              <4>  pxor xmmblock, xmm0
  1485                              <4>  %else
  1486                              <4>  %if round < 14
  1487 00000235 660F38DED0          <4>  aesOPERATION xmmblock, xmm0
  1488                              <4>  %else
  1489                              <4>  aesOPERATIONlast xmmblock, xmm0
  1490                              <4>  %endif
  1491                              <4>  %endif
  1492                              <4> 
  1493                              <4>  %assign block block+1
  1494                              <4> 
  1495                              <4>  %if round = 0
  1496                              <4>  pxor xmmblock, xmm0
  1497                              <4>  %else
  1498                              <4>  %if round < 14
  1499 0000023A 660F38DED8          <4>  aesOPERATION xmmblock, xmm0
  1500                              <4>  %else
  1501                              <4>  aesOPERATIONlast xmmblock, xmm0
  1502                              <4>  %endif
  1503                              <4>  %endif
  1504                              <4> 
  1505                              <4>  %assign block block+1
  1506                              <4> 
  1507                              <4>  %if round = 0
  1508                              <4>  pxor xmmblock, xmm0
  1509                              <4>  %else
  1510                              <4>  %if round < 14
  1511 0000023F 660F38DEE0          <4>  aesOPERATION xmmblock, xmm0
  1512                              <4>  %else
  1513                              <4>  aesOPERATIONlast xmmblock, xmm0
  1514                              <4>  %endif
  1515                              <4>  %endif
  1516                              <4> 
  1517                              <4>  %assign block block+1
  1518                              <4> 
  1519                              <4>  %if round = 0
  1520                              <4>  pxor xmmblock, xmm0
  1521                              <4>  %else
  1522                              <4>  %if round < 14
  1523 00000244 660F38DEE8          <4>  aesOPERATION xmmblock, xmm0
  1524                              <4>  %else
  1525                              <4>  aesOPERATIONlast xmmblock, xmm0
  1526                              <4>  %endif
  1527                              <4>  %endif
  1528                              <4> 
  1529                              <4>  %assign block block+1
  1530                              <4> 
  1531                              <4>  %if round = 0
  1532                              <4>  pxor xmmblock, xmm0
  1533                              <4>  %else
  1534                              <4>  %if round < 14
  1535 00000249 660F38DEF0          <4>  aesOPERATION xmmblock, xmm0
  1536                              <4>  %else
  1537                              <4>  aesOPERATIONlast xmmblock, xmm0
  1538                              <4>  %endif
  1539                              <4>  %endif
  1540                              <4> 
  1541                              <4>  %assign block block+1
  1542                              <4> 
  1543                              <4>  %if round = 0
  1544                              <4>  pxor xmmblock, xmm0
  1545                              <4>  %else
  1546                              <4>  %if round < 14
  1547 0000024E 660F38DEF8          <4>  aesOPERATION xmmblock, xmm0
  1548                              <4>  %else
  1549                              <4>  aesOPERATIONlast xmmblock, xmm0
  1550                              <4>  %endif
  1551                              <4>  %endif
  1552                              <4> 
  1553                              <4>  %assign block block+1
  1554                              <4> 
  1555                              <4>  %if round = 0
  1556                              <4>  pxor xmmblock, xmm0
  1557                              <4>  %else
  1558                              <4>  %if round < 14
  1559 00000253 66440F38DEC0        <4>  aesOPERATION xmmblock, xmm0
  1560                              <4>  %else
  1561                              <4>  aesOPERATIONlast xmmblock, xmm0
  1562                              <4>  %endif
  1563                              <4>  %endif
  1564                              <4> 
  1565                              <4>  %assign block block+1
  1566                              <4> 
  1567                              <4>  %if round = 0
  1568                              <4>  pxor xmmblock, xmm0
  1569                              <4>  %else
  1570                              <4>  %if round < 14
  1571 00000259 66440F38DEC8        <4>  aesOPERATION xmmblock, xmm0
  1572                              <4>  %else
  1573                              <4>  aesOPERATIONlast xmmblock, xmm0
  1574                              <4>  %endif
  1575                              <4>  %endif
  1576                              <4> 
  1577                              <4>  %assign block block+1
  1578                              <4> 
  1579                              <4>  %if round = 0
  1580                              <4>  pxor xmmblock, xmm0
  1581                              <4>  %else
  1582                              <4>  %if round < 14
  1583 0000025F 66440F38DED0        <4>  aesOPERATION xmmblock, xmm0
  1584                              <4>  %else
  1585                              <4>  aesOPERATIONlast xmmblock, xmm0
  1586                              <4>  %endif
  1587                              <4>  %endif
  1588                              <4> 
  1589                              <4>  %assign block block+1
  1590                              <4> 
  1591                              <4>  %if round = 0
  1592                              <4>  pxor xmmblock, xmm0
  1593                              <4>  %else
  1594                              <4>  %if round < 14
  1595 00000265 66440F38DED8        <4>  aesOPERATION xmmblock, xmm0
  1596                              <4>  %else
  1597                              <4>  aesOPERATIONlast xmmblock, xmm0
  1598                              <4>  %endif
  1599                              <4>  %endif
  1600                              <4> 
  1601                              <4>  %assign block block+1
  1602                              <4> 
  1603                              <4>  %if round = 0
  1604                              <4>  pxor xmmblock, xmm0
  1605                              <4>  %else
  1606                              <4>  %if round < 14
  1607 0000026B 66440F38DEE0        <4>  aesOPERATION xmmblock, xmm0
  1608                              <4>  %else
  1609                              <4>  aesOPERATIONlast xmmblock, xmm0
  1610                              <4>  %endif
  1611                              <4>  %endif
  1612                              <4> 
  1613                              <4>  %assign block block+1
  1614                              <4> 
  1615                              <4>  %if round = 0
  1616                              <4>  pxor xmmblock, xmm0
  1617                              <4>  %else
  1618                              <4>  %if round < 14
  1619 00000271 66440F38DEE8        <4>  aesOPERATION xmmblock, xmm0
  1620                              <4>  %else
  1621                              <4>  aesOPERATIONlast xmmblock, xmm0
  1622                              <4>  %endif
  1623                              <4>  %endif
  1624                              <4> 
  1625                              <4>  %assign block block+1
  1626                              <4> 
  1627                              <4>  %if round = 0
  1628                              <4>  pxor xmmblock, xmm0
  1629                              <4>  %else
  1630                              <4>  %if round < 14
  1631 00000277 66440F38DEF0        <4>  aesOPERATION xmmblock, xmm0
  1632                              <4>  %else
  1633                              <4>  aesOPERATIONlast xmmblock, xmm0
  1634                              <4>  %endif
  1635                              <4>  %endif
  1636                              <4> 
  1637                              <4>  %assign block block+1
  1638                              <4> 
  1639                              <4>  %if round = 0
  1640                              <4>  pxor xmmblock, xmm0
  1641                              <4>  %else
  1642                              <4>  %if round < 14
  1643 0000027D 66440F38DEF8        <4>  aesOPERATION xmmblock, xmm0
  1644                              <4>  %else
  1645                              <4>  aesOPERATIONlast xmmblock, xmm0
  1646                              <4>  %endif
  1647                              <4>  %endif
  1648                              <4> 
  1649                              <4>  %assign block block+1
  1650                              <3> 
  1651                              <3>  %assign round round+1
  1652 00000283 F30F6F4130          <3>  movdqu xmm0, [Rcx + 16 * round]
  1653                              <3> 
  1654                              <3>  %assign block 1
  1655                              <3>  %rep BLOCK_COUNT
  1656                              <3> 
  1657                              <3>  %if round = 0
  1658                              <3>  pxor xmmblock, xmm0
  1659                              <3>  %else
  1660                              <3>  %if round < 14
  1661                              <3>  aesOPERATION xmmblock, xmm0
  1662                              <3>  %else
  1663                              <3>  aesOPERATIONlast xmmblock, xmm0
  1664                              <3>  %endif
  1665                              <3>  %endif
  1666                              <3> 
  1667                              <3>  %assign block block+1
  1668                              <3>  %endrep
  1669                              <4> 
  1670                              <4>  %if round = 0
  1671                              <4>  pxor xmmblock, xmm0
  1672                              <4>  %else
  1673                              <4>  %if round < 14
  1674 00000288 660F38DEC8          <4>  aesOPERATION xmmblock, xmm0
  1675                              <4>  %else
  1676                              <4>  aesOPERATIONlast xmmblock, xmm0
  1677                              <4>  %endif
  1678                              <4>  %endif
  1679                              <4> 
  1680                              <4>  %assign block block+1
  1681                              <4> 
  1682                              <4>  %if round = 0
  1683                              <4>  pxor xmmblock, xmm0
  1684                              <4>  %else
  1685                              <4>  %if round < 14
  1686 0000028D 660F38DED0          <4>  aesOPERATION xmmblock, xmm0
  1687                              <4>  %else
  1688                              <4>  aesOPERATIONlast xmmblock, xmm0
  1689                              <4>  %endif
  1690                              <4>  %endif
  1691                              <4> 
  1692                              <4>  %assign block block+1
  1693                              <4> 
  1694                              <4>  %if round = 0
  1695                              <4>  pxor xmmblock, xmm0
  1696                              <4>  %else
  1697                              <4>  %if round < 14
  1698 00000292 660F38DED8          <4>  aesOPERATION xmmblock, xmm0
  1699                              <4>  %else
  1700                              <4>  aesOPERATIONlast xmmblock, xmm0
  1701                              <4>  %endif
  1702                              <4>  %endif
  1703                              <4> 
  1704                              <4>  %assign block block+1
  1705                              <4> 
  1706                              <4>  %if round = 0
  1707                              <4>  pxor xmmblock, xmm0
  1708                              <4>  %else
  1709                              <4>  %if round < 14
  1710 00000297 660F38DEE0          <4>  aesOPERATION xmmblock, xmm0
  1711                              <4>  %else
  1712                              <4>  aesOPERATIONlast xmmblock, xmm0
  1713                              <4>  %endif
  1714                              <4>  %endif
  1715                              <4> 
  1716                              <4>  %assign block block+1
  1717                              <4> 
  1718                              <4>  %if round = 0
  1719                              <4>  pxor xmmblock, xmm0
  1720                              <4>  %else
  1721                              <4>  %if round < 14
  1722 0000029C 660F38DEE8          <4>  aesOPERATION xmmblock, xmm0
  1723                              <4>  %else
  1724                              <4>  aesOPERATIONlast xmmblock, xmm0
  1725                              <4>  %endif
  1726                              <4>  %endif
  1727                              <4> 
  1728                              <4>  %assign block block+1
  1729                              <4> 
  1730                              <4>  %if round = 0
  1731                              <4>  pxor xmmblock, xmm0
  1732                              <4>  %else
  1733                              <4>  %if round < 14
  1734 000002A1 660F38DEF0          <4>  aesOPERATION xmmblock, xmm0
  1735                              <4>  %else
  1736                              <4>  aesOPERATIONlast xmmblock, xmm0
  1737                              <4>  %endif
  1738                              <4>  %endif
  1739                              <4> 
  1740                              <4>  %assign block block+1
  1741                              <4> 
  1742                              <4>  %if round = 0
  1743                              <4>  pxor xmmblock, xmm0
  1744                              <4>  %else
  1745                              <4>  %if round < 14
  1746 000002A6 660F38DEF8          <4>  aesOPERATION xmmblock, xmm0
  1747                              <4>  %else
  1748                              <4>  aesOPERATIONlast xmmblock, xmm0
  1749                              <4>  %endif
  1750                              <4>  %endif
  1751                              <4> 
  1752                              <4>  %assign block block+1
  1753                              <4> 
  1754                              <4>  %if round = 0
  1755                              <4>  pxor xmmblock, xmm0
  1756                              <4>  %else
  1757                              <4>  %if round < 14
  1758 000002AB 66440F38DEC0        <4>  aesOPERATION xmmblock, xmm0
  1759                              <4>  %else
  1760                              <4>  aesOPERATIONlast xmmblock, xmm0
  1761                              <4>  %endif
  1762                              <4>  %endif
  1763                              <4> 
  1764                              <4>  %assign block block+1
  1765                              <4> 
  1766                              <4>  %if round = 0
  1767                              <4>  pxor xmmblock, xmm0
  1768                              <4>  %else
  1769                              <4>  %if round < 14
  1770 000002B1 66440F38DEC8        <4>  aesOPERATION xmmblock, xmm0
  1771                              <4>  %else
  1772                              <4>  aesOPERATIONlast xmmblock, xmm0
  1773                              <4>  %endif
  1774                              <4>  %endif
  1775                              <4> 
  1776                              <4>  %assign block block+1
  1777                              <4> 
  1778                              <4>  %if round = 0
  1779                              <4>  pxor xmmblock, xmm0
  1780                              <4>  %else
  1781                              <4>  %if round < 14
  1782 000002B7 66440F38DED0        <4>  aesOPERATION xmmblock, xmm0
  1783                              <4>  %else
  1784                              <4>  aesOPERATIONlast xmmblock, xmm0
  1785                              <4>  %endif
  1786                              <4>  %endif
  1787                              <4> 
  1788                              <4>  %assign block block+1
  1789                              <4> 
  1790                              <4>  %if round = 0
  1791                              <4>  pxor xmmblock, xmm0
  1792                              <4>  %else
  1793                              <4>  %if round < 14
  1794 000002BD 66440F38DED8        <4>  aesOPERATION xmmblock, xmm0
  1795                              <4>  %else
  1796                              <4>  aesOPERATIONlast xmmblock, xmm0
  1797                              <4>  %endif
  1798                              <4>  %endif
  1799                              <4> 
  1800                              <4>  %assign block block+1
  1801                              <4> 
  1802                              <4>  %if round = 0
  1803                              <4>  pxor xmmblock, xmm0
  1804                              <4>  %else
  1805                              <4>  %if round < 14
  1806 000002C3 66440F38DEE0        <4>  aesOPERATION xmmblock, xmm0
  1807                              <4>  %else
  1808                              <4>  aesOPERATIONlast xmmblock, xmm0
  1809                              <4>  %endif
  1810                              <4>  %endif
  1811                              <4> 
  1812                              <4>  %assign block block+1
  1813                              <4> 
  1814                              <4>  %if round = 0
  1815                              <4>  pxor xmmblock, xmm0
  1816                              <4>  %else
  1817                              <4>  %if round < 14
  1818 000002C9 66440F38DEE8        <4>  aesOPERATION xmmblock, xmm0
  1819                              <4>  %else
  1820                              <4>  aesOPERATIONlast xmmblock, xmm0
  1821                              <4>  %endif
  1822                              <4>  %endif
  1823                              <4> 
  1824                              <4>  %assign block block+1
  1825                              <4> 
  1826                              <4>  %if round = 0
  1827                              <4>  pxor xmmblock, xmm0
  1828                              <4>  %else
  1829                              <4>  %if round < 14
  1830 000002CF 66440F38DEF0        <4>  aesOPERATION xmmblock, xmm0
  1831                              <4>  %else
  1832                              <4>  aesOPERATIONlast xmmblock, xmm0
  1833                              <4>  %endif
  1834                              <4>  %endif
  1835                              <4> 
  1836                              <4>  %assign block block+1
  1837                              <4> 
  1838                              <4>  %if round = 0
  1839                              <4>  pxor xmmblock, xmm0
  1840                              <4>  %else
  1841                              <4>  %if round < 14
  1842 000002D5 66440F38DEF8        <4>  aesOPERATION xmmblock, xmm0
  1843                              <4>  %else
  1844                              <4>  aesOPERATIONlast xmmblock, xmm0
  1845                              <4>  %endif
  1846                              <4>  %endif
  1847                              <4> 
  1848                              <4>  %assign block block+1
  1849                              <3> 
  1850                              <3>  %assign round round+1
  1851 000002DB F30F6F4140          <3>  movdqu xmm0, [Rcx + 16 * round]
  1852                              <3> 
  1853                              <3>  %assign block 1
  1854                              <3>  %rep BLOCK_COUNT
  1855                              <3> 
  1856                              <3>  %if round = 0
  1857                              <3>  pxor xmmblock, xmm0
  1858                              <3>  %else
  1859                              <3>  %if round < 14
  1860                              <3>  aesOPERATION xmmblock, xmm0
  1861                              <3>  %else
  1862                              <3>  aesOPERATIONlast xmmblock, xmm0
  1863                              <3>  %endif
  1864                              <3>  %endif
  1865                              <3> 
  1866                              <3>  %assign block block+1
  1867                              <3>  %endrep
  1868                              <4> 
  1869                              <4>  %if round = 0
  1870                              <4>  pxor xmmblock, xmm0
  1871                              <4>  %else
  1872                              <4>  %if round < 14
  1873 000002E0 660F38DEC8          <4>  aesOPERATION xmmblock, xmm0
  1874                              <4>  %else
  1875                              <4>  aesOPERATIONlast xmmblock, xmm0
  1876                              <4>  %endif
  1877                              <4>  %endif
  1878                              <4> 
  1879                              <4>  %assign block block+1
  1880                              <4> 
  1881                              <4>  %if round = 0
  1882                              <4>  pxor xmmblock, xmm0
  1883                              <4>  %else
  1884                              <4>  %if round < 14
  1885 000002E5 660F38DED0          <4>  aesOPERATION xmmblock, xmm0
  1886                              <4>  %else
  1887                              <4>  aesOPERATIONlast xmmblock, xmm0
  1888                              <4>  %endif
  1889                              <4>  %endif
  1890                              <4> 
  1891                              <4>  %assign block block+1
  1892                              <4> 
  1893                              <4>  %if round = 0
  1894                              <4>  pxor xmmblock, xmm0
  1895                              <4>  %else
  1896                              <4>  %if round < 14
  1897 000002EA 660F38DED8          <4>  aesOPERATION xmmblock, xmm0
  1898                              <4>  %else
  1899                              <4>  aesOPERATIONlast xmmblock, xmm0
  1900                              <4>  %endif
  1901                              <4>  %endif
  1902                              <4> 
  1903                              <4>  %assign block block+1
  1904                              <4> 
  1905                              <4>  %if round = 0
  1906                              <4>  pxor xmmblock, xmm0
  1907                              <4>  %else
  1908                              <4>  %if round < 14
  1909 000002EF 660F38DEE0          <4>  aesOPERATION xmmblock, xmm0
  1910                              <4>  %else
  1911                              <4>  aesOPERATIONlast xmmblock, xmm0
  1912                              <4>  %endif
  1913                              <4>  %endif
  1914                              <4> 
  1915                              <4>  %assign block block+1
  1916                              <4> 
  1917                              <4>  %if round = 0
  1918                              <4>  pxor xmmblock, xmm0
  1919                              <4>  %else
  1920                              <4>  %if round < 14
  1921 000002F4 660F38DEE8          <4>  aesOPERATION xmmblock, xmm0
  1922                              <4>  %else
  1923                              <4>  aesOPERATIONlast xmmblock, xmm0
  1924                              <4>  %endif
  1925                              <4>  %endif
  1926                              <4> 
  1927                              <4>  %assign block block+1
  1928                              <4> 
  1929                              <4>  %if round = 0
  1930                              <4>  pxor xmmblock, xmm0
  1931                              <4>  %else
  1932                              <4>  %if round < 14
  1933 000002F9 660F38DEF0          <4>  aesOPERATION xmmblock, xmm0
  1934                              <4>  %else
  1935                              <4>  aesOPERATIONlast xmmblock, xmm0
  1936                              <4>  %endif
  1937                              <4>  %endif
  1938                              <4> 
  1939                              <4>  %assign block block+1
  1940                              <4> 
  1941                              <4>  %if round = 0
  1942                              <4>  pxor xmmblock, xmm0
  1943                              <4>  %else
  1944                              <4>  %if round < 14
  1945 000002FE 660F38DEF8          <4>  aesOPERATION xmmblock, xmm0
  1946                              <4>  %else
  1947                              <4>  aesOPERATIONlast xmmblock, xmm0
  1948                              <4>  %endif
  1949                              <4>  %endif
  1950                              <4> 
  1951                              <4>  %assign block block+1
  1952                              <4> 
  1953                              <4>  %if round = 0
  1954                              <4>  pxor xmmblock, xmm0
  1955                              <4>  %else
  1956                              <4>  %if round < 14
  1957 00000303 66440F38DEC0        <4>  aesOPERATION xmmblock, xmm0
  1958                              <4>  %else
  1959                              <4>  aesOPERATIONlast xmmblock, xmm0
  1960                              <4>  %endif
  1961                              <4>  %endif
  1962                              <4> 
  1963                              <4>  %assign block block+1
  1964                              <4> 
  1965                              <4>  %if round = 0
  1966                              <4>  pxor xmmblock, xmm0
  1967                              <4>  %else
  1968                              <4>  %if round < 14
  1969 00000309 66440F38DEC8        <4>  aesOPERATION xmmblock, xmm0
  1970                              <4>  %else
  1971                              <4>  aesOPERATIONlast xmmblock, xmm0
  1972                              <4>  %endif
  1973                              <4>  %endif
  1974                              <4> 
  1975                              <4>  %assign block block+1
  1976                              <4> 
  1977                              <4>  %if round = 0
  1978                              <4>  pxor xmmblock, xmm0
  1979                              <4>  %else
  1980                              <4>  %if round < 14
  1981 0000030F 66440F38DED0        <4>  aesOPERATION xmmblock, xmm0
  1982                              <4>  %else
  1983                              <4>  aesOPERATIONlast xmmblock, xmm0
  1984                              <4>  %endif
  1985                              <4>  %endif
  1986                              <4> 
  1987                              <4>  %assign block block+1
  1988                              <4> 
  1989                              <4>  %if round = 0
  1990                              <4>  pxor xmmblock, xmm0
  1991                              <4>  %else
  1992                              <4>  %if round < 14
  1993 00000315 66440F38DED8        <4>  aesOPERATION xmmblock, xmm0
  1994                              <4>  %else
  1995                              <4>  aesOPERATIONlast xmmblock, xmm0
  1996                              <4>  %endif
  1997                              <4>  %endif
  1998                              <4> 
  1999                              <4>  %assign block block+1
  2000                              <4> 
  2001                              <4>  %if round = 0
  2002                              <4>  pxor xmmblock, xmm0
  2003                              <4>  %else
  2004                              <4>  %if round < 14
  2005 0000031B 66440F38DEE0        <4>  aesOPERATION xmmblock, xmm0
  2006                              <4>  %else
  2007                              <4>  aesOPERATIONlast xmmblock, xmm0
  2008                              <4>  %endif
  2009                              <4>  %endif
  2010                              <4> 
  2011                              <4>  %assign block block+1
  2012                              <4> 
  2013                              <4>  %if round = 0
  2014                              <4>  pxor xmmblock, xmm0
  2015                              <4>  %else
  2016                              <4>  %if round < 14
  2017 00000321 66440F38DEE8        <4>  aesOPERATION xmmblock, xmm0
  2018                              <4>  %else
  2019                              <4>  aesOPERATIONlast xmmblock, xmm0
  2020                              <4>  %endif
  2021                              <4>  %endif
  2022                              <4> 
  2023                              <4>  %assign block block+1
  2024                              <4> 
  2025                              <4>  %if round = 0
  2026                              <4>  pxor xmmblock, xmm0
  2027                              <4>  %else
  2028                              <4>  %if round < 14
  2029 00000327 66440F38DEF0        <4>  aesOPERATION xmmblock, xmm0
  2030                              <4>  %else
  2031                              <4>  aesOPERATIONlast xmmblock, xmm0
  2032                              <4>  %endif
  2033                              <4>  %endif
  2034                              <4> 
  2035                              <4>  %assign block block+1
  2036                              <4> 
  2037                              <4>  %if round = 0
  2038                              <4>  pxor xmmblock, xmm0
  2039                              <4>  %else
  2040                              <4>  %if round < 14
  2041 0000032D 66440F38DEF8        <4>  aesOPERATION xmmblock, xmm0
  2042                              <4>  %else
  2043                              <4>  aesOPERATIONlast xmmblock, xmm0
  2044                              <4>  %endif
  2045                              <4>  %endif
  2046                              <4> 
  2047                              <4>  %assign block block+1
  2048                              <3> 
  2049                              <3>  %assign round round+1
  2050 00000333 F30F6F4150          <3>  movdqu xmm0, [Rcx + 16 * round]
  2051                              <3> 
  2052                              <3>  %assign block 1
  2053                              <3>  %rep BLOCK_COUNT
  2054                              <3> 
  2055                              <3>  %if round = 0
  2056                              <3>  pxor xmmblock, xmm0
  2057                              <3>  %else
  2058                              <3>  %if round < 14
  2059                              <3>  aesOPERATION xmmblock, xmm0
  2060                              <3>  %else
  2061                              <3>  aesOPERATIONlast xmmblock, xmm0
  2062                              <3>  %endif
  2063                              <3>  %endif
  2064                              <3> 
  2065                              <3>  %assign block block+1
  2066                              <3>  %endrep
  2067                              <4> 
  2068                              <4>  %if round = 0
  2069                              <4>  pxor xmmblock, xmm0
  2070                              <4>  %else
  2071                              <4>  %if round < 14
  2072 00000338 660F38DEC8          <4>  aesOPERATION xmmblock, xmm0
  2073                              <4>  %else
  2074                              <4>  aesOPERATIONlast xmmblock, xmm0
  2075                              <4>  %endif
  2076                              <4>  %endif
  2077                              <4> 
  2078                              <4>  %assign block block+1
  2079                              <4> 
  2080                              <4>  %if round = 0
  2081                              <4>  pxor xmmblock, xmm0
  2082                              <4>  %else
  2083                              <4>  %if round < 14
  2084 0000033D 660F38DED0          <4>  aesOPERATION xmmblock, xmm0
  2085                              <4>  %else
  2086                              <4>  aesOPERATIONlast xmmblock, xmm0
  2087                              <4>  %endif
  2088                              <4>  %endif
  2089                              <4> 
  2090                              <4>  %assign block block+1
  2091                              <4> 
  2092                              <4>  %if round = 0
  2093                              <4>  pxor xmmblock, xmm0
  2094                              <4>  %else
  2095                              <4>  %if round < 14
  2096 00000342 660F38DED8          <4>  aesOPERATION xmmblock, xmm0
  2097                              <4>  %else
  2098                              <4>  aesOPERATIONlast xmmblock, xmm0
  2099                              <4>  %endif
  2100                              <4>  %endif
  2101                              <4> 
  2102                              <4>  %assign block block+1
  2103                              <4> 
  2104                              <4>  %if round = 0
  2105                              <4>  pxor xmmblock, xmm0
  2106                              <4>  %else
  2107                              <4>  %if round < 14
  2108 00000347 660F38DEE0          <4>  aesOPERATION xmmblock, xmm0
  2109                              <4>  %else
  2110                              <4>  aesOPERATIONlast xmmblock, xmm0
  2111                              <4>  %endif
  2112                              <4>  %endif
  2113                              <4> 
  2114                              <4>  %assign block block+1
  2115                              <4> 
  2116                              <4>  %if round = 0
  2117                              <4>  pxor xmmblock, xmm0
  2118                              <4>  %else
  2119                              <4>  %if round < 14
  2120 0000034C 660F38DEE8          <4>  aesOPERATION xmmblock, xmm0
  2121                              <4>  %else
  2122                              <4>  aesOPERATIONlast xmmblock, xmm0
  2123                              <4>  %endif
  2124                              <4>  %endif
  2125                              <4> 
  2126                              <4>  %assign block block+1
  2127                              <4> 
  2128                              <4>  %if round = 0
  2129                              <4>  pxor xmmblock, xmm0
  2130                              <4>  %else
  2131                              <4>  %if round < 14
  2132 00000351 660F38DEF0          <4>  aesOPERATION xmmblock, xmm0
  2133                              <4>  %else
  2134                              <4>  aesOPERATIONlast xmmblock, xmm0
  2135                              <4>  %endif
  2136                              <4>  %endif
  2137                              <4> 
  2138                              <4>  %assign block block+1
  2139                              <4> 
  2140                              <4>  %if round = 0
  2141                              <4>  pxor xmmblock, xmm0
  2142                              <4>  %else
  2143                              <4>  %if round < 14
  2144 00000356 660F38DEF8          <4>  aesOPERATION xmmblock, xmm0
  2145                              <4>  %else
  2146                              <4>  aesOPERATIONlast xmmblock, xmm0
  2147                              <4>  %endif
  2148                              <4>  %endif
  2149                              <4> 
  2150                              <4>  %assign block block+1
  2151                              <4> 
  2152                              <4>  %if round = 0
  2153                              <4>  pxor xmmblock, xmm0
  2154                              <4>  %else
  2155                              <4>  %if round < 14
  2156 0000035B 66440F38DEC0        <4>  aesOPERATION xmmblock, xmm0
  2157                              <4>  %else
  2158                              <4>  aesOPERATIONlast xmmblock, xmm0
  2159                              <4>  %endif
  2160                              <4>  %endif
  2161                              <4> 
  2162                              <4>  %assign block block+1
  2163                              <4> 
  2164                              <4>  %if round = 0
  2165                              <4>  pxor xmmblock, xmm0
  2166                              <4>  %else
  2167                              <4>  %if round < 14
  2168 00000361 66440F38DEC8        <4>  aesOPERATION xmmblock, xmm0
  2169                              <4>  %else
  2170                              <4>  aesOPERATIONlast xmmblock, xmm0
  2171                              <4>  %endif
  2172                              <4>  %endif
  2173                              <4> 
  2174                              <4>  %assign block block+1
  2175                              <4> 
  2176                              <4>  %if round = 0
  2177                              <4>  pxor xmmblock, xmm0
  2178                              <4>  %else
  2179                              <4>  %if round < 14
  2180 00000367 66440F38DED0        <4>  aesOPERATION xmmblock, xmm0
  2181                              <4>  %else
  2182                              <4>  aesOPERATIONlast xmmblock, xmm0
  2183                              <4>  %endif
  2184                              <4>  %endif
  2185                              <4> 
  2186                              <4>  %assign block block+1
  2187                              <4> 
  2188                              <4>  %if round = 0
  2189                              <4>  pxor xmmblock, xmm0
  2190                              <4>  %else
  2191                              <4>  %if round < 14
  2192 0000036D 66440F38DED8        <4>  aesOPERATION xmmblock, xmm0
  2193                              <4>  %else
  2194                              <4>  aesOPERATIONlast xmmblock, xmm0
  2195                              <4>  %endif
  2196                              <4>  %endif
  2197                              <4> 
  2198                              <4>  %assign block block+1
  2199                              <4> 
  2200                              <4>  %if round = 0
  2201                              <4>  pxor xmmblock, xmm0
  2202                              <4>  %else
  2203                              <4>  %if round < 14
  2204 00000373 66440F38DEE0        <4>  aesOPERATION xmmblock, xmm0
  2205                              <4>  %else
  2206                              <4>  aesOPERATIONlast xmmblock, xmm0
  2207                              <4>  %endif
  2208                              <4>  %endif
  2209                              <4> 
  2210                              <4>  %assign block block+1
  2211                              <4> 
  2212                              <4>  %if round = 0
  2213                              <4>  pxor xmmblock, xmm0
  2214                              <4>  %else
  2215                              <4>  %if round < 14
  2216 00000379 66440F38DEE8        <4>  aesOPERATION xmmblock, xmm0
  2217                              <4>  %else
  2218                              <4>  aesOPERATIONlast xmmblock, xmm0
  2219                              <4>  %endif
  2220                              <4>  %endif
  2221                              <4> 
  2222                              <4>  %assign block block+1
  2223                              <4> 
  2224                              <4>  %if round = 0
  2225                              <4>  pxor xmmblock, xmm0
  2226                              <4>  %else
  2227                              <4>  %if round < 14
  2228 0000037F 66440F38DEF0        <4>  aesOPERATION xmmblock, xmm0
  2229                              <4>  %else
  2230                              <4>  aesOPERATIONlast xmmblock, xmm0
  2231                              <4>  %endif
  2232                              <4>  %endif
  2233                              <4> 
  2234                              <4>  %assign block block+1
  2235                              <4> 
  2236                              <4>  %if round = 0
  2237                              <4>  pxor xmmblock, xmm0
  2238                              <4>  %else
  2239                              <4>  %if round < 14
  2240 00000385 66440F38DEF8        <4>  aesOPERATION xmmblock, xmm0
  2241                              <4>  %else
  2242                              <4>  aesOPERATIONlast xmmblock, xmm0
  2243                              <4>  %endif
  2244                              <4>  %endif
  2245                              <4> 
  2246                              <4>  %assign block block+1
  2247                              <3> 
  2248                              <3>  %assign round round+1
  2249 0000038B F30F6F4160          <3>  movdqu xmm0, [Rcx + 16 * round]
  2250                              <3> 
  2251                              <3>  %assign block 1
  2252                              <3>  %rep BLOCK_COUNT
  2253                              <3> 
  2254                              <3>  %if round = 0
  2255                              <3>  pxor xmmblock, xmm0
  2256                              <3>  %else
  2257                              <3>  %if round < 14
  2258                              <3>  aesOPERATION xmmblock, xmm0
  2259                              <3>  %else
  2260                              <3>  aesOPERATIONlast xmmblock, xmm0
  2261                              <3>  %endif
  2262                              <3>  %endif
  2263                              <3> 
  2264                              <3>  %assign block block+1
  2265                              <3>  %endrep
  2266                              <4> 
  2267                              <4>  %if round = 0
  2268                              <4>  pxor xmmblock, xmm0
  2269                              <4>  %else
  2270                              <4>  %if round < 14
  2271 00000390 660F38DEC8          <4>  aesOPERATION xmmblock, xmm0
  2272                              <4>  %else
  2273                              <4>  aesOPERATIONlast xmmblock, xmm0
  2274                              <4>  %endif
  2275                              <4>  %endif
  2276                              <4> 
  2277                              <4>  %assign block block+1
  2278                              <4> 
  2279                              <4>  %if round = 0
  2280                              <4>  pxor xmmblock, xmm0
  2281                              <4>  %else
  2282                              <4>  %if round < 14
  2283 00000395 660F38DED0          <4>  aesOPERATION xmmblock, xmm0
  2284                              <4>  %else
  2285                              <4>  aesOPERATIONlast xmmblock, xmm0
  2286                              <4>  %endif
  2287                              <4>  %endif
  2288                              <4> 
  2289                              <4>  %assign block block+1
  2290                              <4> 
  2291                              <4>  %if round = 0
  2292                              <4>  pxor xmmblock, xmm0
  2293                              <4>  %else
  2294                              <4>  %if round < 14
  2295 0000039A 660F38DED8          <4>  aesOPERATION xmmblock, xmm0
  2296                              <4>  %else
  2297                              <4>  aesOPERATIONlast xmmblock, xmm0
  2298                              <4>  %endif
  2299                              <4>  %endif
  2300                              <4> 
  2301                              <4>  %assign block block+1
  2302                              <4> 
  2303                              <4>  %if round = 0
  2304                              <4>  pxor xmmblock, xmm0
  2305                              <4>  %else
  2306                              <4>  %if round < 14
  2307 0000039F 660F38DEE0          <4>  aesOPERATION xmmblock, xmm0
  2308                              <4>  %else
  2309                              <4>  aesOPERATIONlast xmmblock, xmm0
  2310                              <4>  %endif
  2311                              <4>  %endif
  2312                              <4> 
  2313                              <4>  %assign block block+1
  2314                              <4> 
  2315                              <4>  %if round = 0
  2316                              <4>  pxor xmmblock, xmm0
  2317                              <4>  %else
  2318                              <4>  %if round < 14
  2319 000003A4 660F38DEE8          <4>  aesOPERATION xmmblock, xmm0
  2320                              <4>  %else
  2321                              <4>  aesOPERATIONlast xmmblock, xmm0
  2322                              <4>  %endif
  2323                              <4>  %endif
  2324                              <4> 
  2325                              <4>  %assign block block+1
  2326                              <4> 
  2327                              <4>  %if round = 0
  2328                              <4>  pxor xmmblock, xmm0
  2329                              <4>  %else
  2330                              <4>  %if round < 14
  2331 000003A9 660F38DEF0          <4>  aesOPERATION xmmblock, xmm0
  2332                              <4>  %else
  2333                              <4>  aesOPERATIONlast xmmblock, xmm0
  2334                              <4>  %endif
  2335                              <4>  %endif
  2336                              <4> 
  2337                              <4>  %assign block block+1
  2338                              <4> 
  2339                              <4>  %if round = 0
  2340                              <4>  pxor xmmblock, xmm0
  2341                              <4>  %else
  2342                              <4>  %if round < 14
  2343 000003AE 660F38DEF8          <4>  aesOPERATION xmmblock, xmm0
  2344                              <4>  %else
  2345                              <4>  aesOPERATIONlast xmmblock, xmm0
  2346                              <4>  %endif
  2347                              <4>  %endif
  2348                              <4> 
  2349                              <4>  %assign block block+1
  2350                              <4> 
  2351                              <4>  %if round = 0
  2352                              <4>  pxor xmmblock, xmm0
  2353                              <4>  %else
  2354                              <4>  %if round < 14
  2355 000003B3 66440F38DEC0        <4>  aesOPERATION xmmblock, xmm0
  2356                              <4>  %else
  2357                              <4>  aesOPERATIONlast xmmblock, xmm0
  2358                              <4>  %endif
  2359                              <4>  %endif
  2360                              <4> 
  2361                              <4>  %assign block block+1
  2362                              <4> 
  2363                              <4>  %if round = 0
  2364                              <4>  pxor xmmblock, xmm0
  2365                              <4>  %else
  2366                              <4>  %if round < 14
  2367 000003B9 66440F38DEC8        <4>  aesOPERATION xmmblock, xmm0
  2368                              <4>  %else
  2369                              <4>  aesOPERATIONlast xmmblock, xmm0
  2370                              <4>  %endif
  2371                              <4>  %endif
  2372                              <4> 
  2373                              <4>  %assign block block+1
  2374                              <4> 
  2375                              <4>  %if round = 0
  2376                              <4>  pxor xmmblock, xmm0
  2377                              <4>  %else
  2378                              <4>  %if round < 14
  2379 000003BF 66440F38DED0        <4>  aesOPERATION xmmblock, xmm0
  2380                              <4>  %else
  2381                              <4>  aesOPERATIONlast xmmblock, xmm0
  2382                              <4>  %endif
  2383                              <4>  %endif
  2384                              <4> 
  2385                              <4>  %assign block block+1
  2386                              <4> 
  2387                              <4>  %if round = 0
  2388                              <4>  pxor xmmblock, xmm0
  2389                              <4>  %else
  2390                              <4>  %if round < 14
  2391 000003C5 66440F38DED8        <4>  aesOPERATION xmmblock, xmm0
  2392                              <4>  %else
  2393                              <4>  aesOPERATIONlast xmmblock, xmm0
  2394                              <4>  %endif
  2395                              <4>  %endif
  2396                              <4> 
  2397                              <4>  %assign block block+1
  2398                              <4> 
  2399                              <4>  %if round = 0
  2400                              <4>  pxor xmmblock, xmm0
  2401                              <4>  %else
  2402                              <4>  %if round < 14
  2403 000003CB 66440F38DEE0        <4>  aesOPERATION xmmblock, xmm0
  2404                              <4>  %else
  2405                              <4>  aesOPERATIONlast xmmblock, xmm0
  2406                              <4>  %endif
  2407                              <4>  %endif
  2408                              <4> 
  2409                              <4>  %assign block block+1
  2410                              <4> 
  2411                              <4>  %if round = 0
  2412                              <4>  pxor xmmblock, xmm0
  2413                              <4>  %else
  2414                              <4>  %if round < 14
  2415 000003D1 66440F38DEE8        <4>  aesOPERATION xmmblock, xmm0
  2416                              <4>  %else
  2417                              <4>  aesOPERATIONlast xmmblock, xmm0
  2418                              <4>  %endif
  2419                              <4>  %endif
  2420                              <4> 
  2421                              <4>  %assign block block+1
  2422                              <4> 
  2423                              <4>  %if round = 0
  2424                              <4>  pxor xmmblock, xmm0
  2425                              <4>  %else
  2426                              <4>  %if round < 14
  2427 000003D7 66440F38DEF0        <4>  aesOPERATION xmmblock, xmm0
  2428                              <4>  %else
  2429                              <4>  aesOPERATIONlast xmmblock, xmm0
  2430                              <4>  %endif
  2431                              <4>  %endif
  2432                              <4> 
  2433                              <4>  %assign block block+1
  2434                              <4> 
  2435                              <4>  %if round = 0
  2436                              <4>  pxor xmmblock, xmm0
  2437                              <4>  %else
  2438                              <4>  %if round < 14
  2439 000003DD 66440F38DEF8        <4>  aesOPERATION xmmblock, xmm0
  2440                              <4>  %else
  2441                              <4>  aesOPERATIONlast xmmblock, xmm0
  2442                              <4>  %endif
  2443                              <4>  %endif
  2444                              <4> 
  2445                              <4>  %assign block block+1
  2446                              <3> 
  2447                              <3>  %assign round round+1
  2448 000003E3 F30F6F4170          <3>  movdqu xmm0, [Rcx + 16 * round]
  2449                              <3> 
  2450                              <3>  %assign block 1
  2451                              <3>  %rep BLOCK_COUNT
  2452                              <3> 
  2453                              <3>  %if round = 0
  2454                              <3>  pxor xmmblock, xmm0
  2455                              <3>  %else
  2456                              <3>  %if round < 14
  2457                              <3>  aesOPERATION xmmblock, xmm0
  2458                              <3>  %else
  2459                              <3>  aesOPERATIONlast xmmblock, xmm0
  2460                              <3>  %endif
  2461                              <3>  %endif
  2462                              <3> 
  2463                              <3>  %assign block block+1
  2464                              <3>  %endrep
  2465                              <4> 
  2466                              <4>  %if round = 0
  2467                              <4>  pxor xmmblock, xmm0
  2468                              <4>  %else
  2469                              <4>  %if round < 14
  2470 000003E8 660F38DEC8          <4>  aesOPERATION xmmblock, xmm0
  2471                              <4>  %else
  2472                              <4>  aesOPERATIONlast xmmblock, xmm0
  2473                              <4>  %endif
  2474                              <4>  %endif
  2475                              <4> 
  2476                              <4>  %assign block block+1
  2477                              <4> 
  2478                              <4>  %if round = 0
  2479                              <4>  pxor xmmblock, xmm0
  2480                              <4>  %else
  2481                              <4>  %if round < 14
  2482 000003ED 660F38DED0          <4>  aesOPERATION xmmblock, xmm0
  2483                              <4>  %else
  2484                              <4>  aesOPERATIONlast xmmblock, xmm0
  2485                              <4>  %endif
  2486                              <4>  %endif
  2487                              <4> 
  2488                              <4>  %assign block block+1
  2489                              <4> 
  2490                              <4>  %if round = 0
  2491                              <4>  pxor xmmblock, xmm0
  2492                              <4>  %else
  2493                              <4>  %if round < 14
  2494 000003F2 660F38DED8          <4>  aesOPERATION xmmblock, xmm0
  2495                              <4>  %else
  2496                              <4>  aesOPERATIONlast xmmblock, xmm0
  2497                              <4>  %endif
  2498                              <4>  %endif
  2499                              <4> 
  2500                              <4>  %assign block block+1
  2501                              <4> 
  2502                              <4>  %if round = 0
  2503                              <4>  pxor xmmblock, xmm0
  2504                              <4>  %else
  2505                              <4>  %if round < 14
  2506 000003F7 660F38DEE0          <4>  aesOPERATION xmmblock, xmm0
  2507                              <4>  %else
  2508                              <4>  aesOPERATIONlast xmmblock, xmm0
  2509                              <4>  %endif
  2510                              <4>  %endif
  2511                              <4> 
  2512                              <4>  %assign block block+1
  2513                              <4> 
  2514                              <4>  %if round = 0
  2515                              <4>  pxor xmmblock, xmm0
  2516                              <4>  %else
  2517                              <4>  %if round < 14
  2518 000003FC 660F38DEE8          <4>  aesOPERATION xmmblock, xmm0
  2519                              <4>  %else
  2520                              <4>  aesOPERATIONlast xmmblock, xmm0
  2521                              <4>  %endif
  2522                              <4>  %endif
  2523                              <4> 
  2524                              <4>  %assign block block+1
  2525                              <4> 
  2526                              <4>  %if round = 0
  2527                              <4>  pxor xmmblock, xmm0
  2528                              <4>  %else
  2529                              <4>  %if round < 14
  2530 00000401 660F38DEF0          <4>  aesOPERATION xmmblock, xmm0
  2531                              <4>  %else
  2532                              <4>  aesOPERATIONlast xmmblock, xmm0
  2533                              <4>  %endif
  2534                              <4>  %endif
  2535                              <4> 
  2536                              <4>  %assign block block+1
  2537                              <4> 
  2538                              <4>  %if round = 0
  2539                              <4>  pxor xmmblock, xmm0
  2540                              <4>  %else
  2541                              <4>  %if round < 14
  2542 00000406 660F38DEF8          <4>  aesOPERATION xmmblock, xmm0
  2543                              <4>  %else
  2544                              <4>  aesOPERATIONlast xmmblock, xmm0
  2545                              <4>  %endif
  2546                              <4>  %endif
  2547                              <4> 
  2548                              <4>  %assign block block+1
  2549                              <4> 
  2550                              <4>  %if round = 0
  2551                              <4>  pxor xmmblock, xmm0
  2552                              <4>  %else
  2553                              <4>  %if round < 14
  2554 0000040B 66440F38DEC0        <4>  aesOPERATION xmmblock, xmm0
  2555                              <4>  %else
  2556                              <4>  aesOPERATIONlast xmmblock, xmm0
  2557                              <4>  %endif
  2558                              <4>  %endif
  2559                              <4> 
  2560                              <4>  %assign block block+1
  2561                              <4> 
  2562                              <4>  %if round = 0
  2563                              <4>  pxor xmmblock, xmm0
  2564                              <4>  %else
  2565                              <4>  %if round < 14
  2566 00000411 66440F38DEC8        <4>  aesOPERATION xmmblock, xmm0
  2567                              <4>  %else
  2568                              <4>  aesOPERATIONlast xmmblock, xmm0
  2569                              <4>  %endif
  2570                              <4>  %endif
  2571                              <4> 
  2572                              <4>  %assign block block+1
  2573                              <4> 
  2574                              <4>  %if round = 0
  2575                              <4>  pxor xmmblock, xmm0
  2576                              <4>  %else
  2577                              <4>  %if round < 14
  2578 00000417 66440F38DED0        <4>  aesOPERATION xmmblock, xmm0
  2579                              <4>  %else
  2580                              <4>  aesOPERATIONlast xmmblock, xmm0
  2581                              <4>  %endif
  2582                              <4>  %endif
  2583                              <4> 
  2584                              <4>  %assign block block+1
  2585                              <4> 
  2586                              <4>  %if round = 0
  2587                              <4>  pxor xmmblock, xmm0
  2588                              <4>  %else
  2589                              <4>  %if round < 14
  2590 0000041D 66440F38DED8        <4>  aesOPERATION xmmblock, xmm0
  2591                              <4>  %else
  2592                              <4>  aesOPERATIONlast xmmblock, xmm0
  2593                              <4>  %endif
  2594                              <4>  %endif
  2595                              <4> 
  2596                              <4>  %assign block block+1
  2597                              <4> 
  2598                              <4>  %if round = 0
  2599                              <4>  pxor xmmblock, xmm0
  2600                              <4>  %else
  2601                              <4>  %if round < 14
  2602 00000423 66440F38DEE0        <4>  aesOPERATION xmmblock, xmm0
  2603                              <4>  %else
  2604                              <4>  aesOPERATIONlast xmmblock, xmm0
  2605                              <4>  %endif
  2606                              <4>  %endif
  2607                              <4> 
  2608                              <4>  %assign block block+1
  2609                              <4> 
  2610                              <4>  %if round = 0
  2611                              <4>  pxor xmmblock, xmm0
  2612                              <4>  %else
  2613                              <4>  %if round < 14
  2614 00000429 66440F38DEE8        <4>  aesOPERATION xmmblock, xmm0
  2615                              <4>  %else
  2616                              <4>  aesOPERATIONlast xmmblock, xmm0
  2617                              <4>  %endif
  2618                              <4>  %endif
  2619                              <4> 
  2620                              <4>  %assign block block+1
  2621                              <4> 
  2622                              <4>  %if round = 0
  2623                              <4>  pxor xmmblock, xmm0
  2624                              <4>  %else
  2625                              <4>  %if round < 14
  2626 0000042F 66440F38DEF0        <4>  aesOPERATION xmmblock, xmm0
  2627                              <4>  %else
  2628                              <4>  aesOPERATIONlast xmmblock, xmm0
  2629                              <4>  %endif
  2630                              <4>  %endif
  2631                              <4> 
  2632                              <4>  %assign block block+1
  2633                              <4> 
  2634                              <4>  %if round = 0
  2635                              <4>  pxor xmmblock, xmm0
  2636                              <4>  %else
  2637                              <4>  %if round < 14
  2638 00000435 66440F38DEF8        <4>  aesOPERATION xmmblock, xmm0
  2639                              <4>  %else
  2640                              <4>  aesOPERATIONlast xmmblock, xmm0
  2641                              <4>  %endif
  2642                              <4>  %endif
  2643                              <4> 
  2644                              <4>  %assign block block+1
  2645                              <3> 
  2646                              <3>  %assign round round+1
  2647 0000043B F30F6F8180000000    <3>  movdqu xmm0, [Rcx + 16 * round]
  2648                              <3> 
  2649                              <3>  %assign block 1
  2650                              <3>  %rep BLOCK_COUNT
  2651                              <3> 
  2652                              <3>  %if round = 0
  2653                              <3>  pxor xmmblock, xmm0
  2654                              <3>  %else
  2655                              <3>  %if round < 14
  2656                              <3>  aesOPERATION xmmblock, xmm0
  2657                              <3>  %else
  2658                              <3>  aesOPERATIONlast xmmblock, xmm0
  2659                              <3>  %endif
  2660                              <3>  %endif
  2661                              <3> 
  2662                              <3>  %assign block block+1
  2663                              <3>  %endrep
  2664                              <4> 
  2665                              <4>  %if round = 0
  2666                              <4>  pxor xmmblock, xmm0
  2667                              <4>  %else
  2668                              <4>  %if round < 14
  2669 00000443 660F38DEC8          <4>  aesOPERATION xmmblock, xmm0
  2670                              <4>  %else
  2671                              <4>  aesOPERATIONlast xmmblock, xmm0
  2672                              <4>  %endif
  2673                              <4>  %endif
  2674                              <4> 
  2675                              <4>  %assign block block+1
  2676                              <4> 
  2677                              <4>  %if round = 0
  2678                              <4>  pxor xmmblock, xmm0
  2679                              <4>  %else
  2680                              <4>  %if round < 14
  2681 00000448 660F38DED0          <4>  aesOPERATION xmmblock, xmm0
  2682                              <4>  %else
  2683                              <4>  aesOPERATIONlast xmmblock, xmm0
  2684                              <4>  %endif
  2685                              <4>  %endif
  2686                              <4> 
  2687                              <4>  %assign block block+1
  2688                              <4> 
  2689                              <4>  %if round = 0
  2690                              <4>  pxor xmmblock, xmm0
  2691                              <4>  %else
  2692                              <4>  %if round < 14
  2693 0000044D 660F38DED8          <4>  aesOPERATION xmmblock, xmm0
  2694                              <4>  %else
  2695                              <4>  aesOPERATIONlast xmmblock, xmm0
  2696                              <4>  %endif
  2697                              <4>  %endif
  2698                              <4> 
  2699                              <4>  %assign block block+1
  2700                              <4> 
  2701                              <4>  %if round = 0
  2702                              <4>  pxor xmmblock, xmm0
  2703                              <4>  %else
  2704                              <4>  %if round < 14
  2705 00000452 660F38DEE0          <4>  aesOPERATION xmmblock, xmm0
  2706                              <4>  %else
  2707                              <4>  aesOPERATIONlast xmmblock, xmm0
  2708                              <4>  %endif
  2709                              <4>  %endif
  2710                              <4> 
  2711                              <4>  %assign block block+1
  2712                              <4> 
  2713                              <4>  %if round = 0
  2714                              <4>  pxor xmmblock, xmm0
  2715                              <4>  %else
  2716                              <4>  %if round < 14
  2717 00000457 660F38DEE8          <4>  aesOPERATION xmmblock, xmm0
  2718                              <4>  %else
  2719                              <4>  aesOPERATIONlast xmmblock, xmm0
  2720                              <4>  %endif
  2721                              <4>  %endif
  2722                              <4> 
  2723                              <4>  %assign block block+1
  2724                              <4> 
  2725                              <4>  %if round = 0
  2726                              <4>  pxor xmmblock, xmm0
  2727                              <4>  %else
  2728                              <4>  %if round < 14
  2729 0000045C 660F38DEF0          <4>  aesOPERATION xmmblock, xmm0
  2730                              <4>  %else
  2731                              <4>  aesOPERATIONlast xmmblock, xmm0
  2732                              <4>  %endif
  2733                              <4>  %endif
  2734                              <4> 
  2735                              <4>  %assign block block+1
  2736                              <4> 
  2737                              <4>  %if round = 0
  2738                              <4>  pxor xmmblock, xmm0
  2739                              <4>  %else
  2740                              <4>  %if round < 14
  2741 00000461 660F38DEF8          <4>  aesOPERATION xmmblock, xmm0
  2742                              <4>  %else
  2743                              <4>  aesOPERATIONlast xmmblock, xmm0
  2744                              <4>  %endif
  2745                              <4>  %endif
  2746                              <4> 
  2747                              <4>  %assign block block+1
  2748                              <4> 
  2749                              <4>  %if round = 0
  2750                              <4>  pxor xmmblock, xmm0
  2751                              <4>  %else
  2752                              <4>  %if round < 14
  2753 00000466 66440F38DEC0        <4>  aesOPERATION xmmblock, xmm0
  2754                              <4>  %else
  2755                              <4>  aesOPERATIONlast xmmblock, xmm0
  2756                              <4>  %endif
  2757                              <4>  %endif
  2758                              <4> 
  2759                              <4>  %assign block block+1
  2760                              <4> 
  2761                              <4>  %if round = 0
  2762                              <4>  pxor xmmblock, xmm0
  2763                              <4>  %else
  2764                              <4>  %if round < 14
  2765 0000046C 66440F38DEC8        <4>  aesOPERATION xmmblock, xmm0
  2766                              <4>  %else
  2767                              <4>  aesOPERATIONlast xmmblock, xmm0
  2768                              <4>  %endif
  2769                              <4>  %endif
  2770                              <4> 
  2771                              <4>  %assign block block+1
  2772                              <4> 
  2773                              <4>  %if round = 0
  2774                              <4>  pxor xmmblock, xmm0
  2775                              <4>  %else
  2776                              <4>  %if round < 14
  2777 00000472 66440F38DED0        <4>  aesOPERATION xmmblock, xmm0
  2778                              <4>  %else
  2779                              <4>  aesOPERATIONlast xmmblock, xmm0
  2780                              <4>  %endif
  2781                              <4>  %endif
  2782                              <4> 
  2783                              <4>  %assign block block+1
  2784                              <4> 
  2785                              <4>  %if round = 0
  2786                              <4>  pxor xmmblock, xmm0
  2787                              <4>  %else
  2788                              <4>  %if round < 14
  2789 00000478 66440F38DED8        <4>  aesOPERATION xmmblock, xmm0
  2790                              <4>  %else
  2791                              <4>  aesOPERATIONlast xmmblock, xmm0
  2792                              <4>  %endif
  2793                              <4>  %endif
  2794                              <4> 
  2795                              <4>  %assign block block+1
  2796                              <4> 
  2797                              <4>  %if round = 0
  2798                              <4>  pxor xmmblock, xmm0
  2799                              <4>  %else
  2800                              <4>  %if round < 14
  2801 0000047E 66440F38DEE0        <4>  aesOPERATION xmmblock, xmm0
  2802                              <4>  %else
  2803                              <4>  aesOPERATIONlast xmmblock, xmm0
  2804                              <4>  %endif
  2805                              <4>  %endif
  2806                              <4> 
  2807                              <4>  %assign block block+1
  2808                              <4> 
  2809                              <4>  %if round = 0
  2810                              <4>  pxor xmmblock, xmm0
  2811                              <4>  %else
  2812                              <4>  %if round < 14
  2813 00000484 66440F38DEE8        <4>  aesOPERATION xmmblock, xmm0
  2814                              <4>  %else
  2815                              <4>  aesOPERATIONlast xmmblock, xmm0
  2816                              <4>  %endif
  2817                              <4>  %endif
  2818                              <4> 
  2819                              <4>  %assign block block+1
  2820                              <4> 
  2821                              <4>  %if round = 0
  2822                              <4>  pxor xmmblock, xmm0
  2823                              <4>  %else
  2824                              <4>  %if round < 14
  2825 0000048A 66440F38DEF0        <4>  aesOPERATION xmmblock, xmm0
  2826                              <4>  %else
  2827                              <4>  aesOPERATIONlast xmmblock, xmm0
  2828                              <4>  %endif
  2829                              <4>  %endif
  2830                              <4> 
  2831                              <4>  %assign block block+1
  2832                              <4> 
  2833                              <4>  %if round = 0
  2834                              <4>  pxor xmmblock, xmm0
  2835                              <4>  %else
  2836                              <4>  %if round < 14
  2837 00000490 66440F38DEF8        <4>  aesOPERATION xmmblock, xmm0
  2838                              <4>  %else
  2839                              <4>  aesOPERATIONlast xmmblock, xmm0
  2840                              <4>  %endif
  2841                              <4>  %endif
  2842                              <4> 
  2843                              <4>  %assign block block+1
  2844                              <3> 
  2845                              <3>  %assign round round+1
  2846 00000496 F30F6F8190000000    <3>  movdqu xmm0, [Rcx + 16 * round]
  2847                              <3> 
  2848                              <3>  %assign block 1
  2849                              <3>  %rep BLOCK_COUNT
  2850                              <3> 
  2851                              <3>  %if round = 0
  2852                              <3>  pxor xmmblock, xmm0
  2853                              <3>  %else
  2854                              <3>  %if round < 14
  2855                              <3>  aesOPERATION xmmblock, xmm0
  2856                              <3>  %else
  2857                              <3>  aesOPERATIONlast xmmblock, xmm0
  2858                              <3>  %endif
  2859                              <3>  %endif
  2860                              <3> 
  2861                              <3>  %assign block block+1
  2862                              <3>  %endrep
  2863                              <4> 
  2864                              <4>  %if round = 0
  2865                              <4>  pxor xmmblock, xmm0
  2866                              <4>  %else
  2867                              <4>  %if round < 14
  2868 0000049E 660F38DEC8          <4>  aesOPERATION xmmblock, xmm0
  2869                              <4>  %else
  2870                              <4>  aesOPERATIONlast xmmblock, xmm0
  2871                              <4>  %endif
  2872                              <4>  %endif
  2873                              <4> 
  2874                              <4>  %assign block block+1
  2875                              <4> 
  2876                              <4>  %if round = 0
  2877                              <4>  pxor xmmblock, xmm0
  2878                              <4>  %else
  2879                              <4>  %if round < 14
  2880 000004A3 660F38DED0          <4>  aesOPERATION xmmblock, xmm0
  2881                              <4>  %else
  2882                              <4>  aesOPERATIONlast xmmblock, xmm0
  2883                              <4>  %endif
  2884                              <4>  %endif
  2885                              <4> 
  2886                              <4>  %assign block block+1
  2887                              <4> 
  2888                              <4>  %if round = 0
  2889                              <4>  pxor xmmblock, xmm0
  2890                              <4>  %else
  2891                              <4>  %if round < 14
  2892 000004A8 660F38DED8          <4>  aesOPERATION xmmblock, xmm0
  2893                              <4>  %else
  2894                              <4>  aesOPERATIONlast xmmblock, xmm0
  2895                              <4>  %endif
  2896                              <4>  %endif
  2897                              <4> 
  2898                              <4>  %assign block block+1
  2899                              <4> 
  2900                              <4>  %if round = 0
  2901                              <4>  pxor xmmblock, xmm0
  2902                              <4>  %else
  2903                              <4>  %if round < 14
  2904 000004AD 660F38DEE0          <4>  aesOPERATION xmmblock, xmm0
  2905                              <4>  %else
  2906                              <4>  aesOPERATIONlast xmmblock, xmm0
  2907                              <4>  %endif
  2908                              <4>  %endif
  2909                              <4> 
  2910                              <4>  %assign block block+1
  2911                              <4> 
  2912                              <4>  %if round = 0
  2913                              <4>  pxor xmmblock, xmm0
  2914                              <4>  %else
  2915                              <4>  %if round < 14
  2916 000004B2 660F38DEE8          <4>  aesOPERATION xmmblock, xmm0
  2917                              <4>  %else
  2918                              <4>  aesOPERATIONlast xmmblock, xmm0
  2919                              <4>  %endif
  2920                              <4>  %endif
  2921                              <4> 
  2922                              <4>  %assign block block+1
  2923                              <4> 
  2924                              <4>  %if round = 0
  2925                              <4>  pxor xmmblock, xmm0
  2926                              <4>  %else
  2927                              <4>  %if round < 14
  2928 000004B7 660F38DEF0          <4>  aesOPERATION xmmblock, xmm0
  2929                              <4>  %else
  2930                              <4>  aesOPERATIONlast xmmblock, xmm0
  2931                              <4>  %endif
  2932                              <4>  %endif
  2933                              <4> 
  2934                              <4>  %assign block block+1
  2935                              <4> 
  2936                              <4>  %if round = 0
  2937                              <4>  pxor xmmblock, xmm0
  2938                              <4>  %else
  2939                              <4>  %if round < 14
  2940 000004BC 660F38DEF8          <4>  aesOPERATION xmmblock, xmm0
  2941                              <4>  %else
  2942                              <4>  aesOPERATIONlast xmmblock, xmm0
  2943                              <4>  %endif
  2944                              <4>  %endif
  2945                              <4> 
  2946                              <4>  %assign block block+1
  2947                              <4> 
  2948                              <4>  %if round = 0
  2949                              <4>  pxor xmmblock, xmm0
  2950                              <4>  %else
  2951                              <4>  %if round < 14
  2952 000004C1 66440F38DEC0        <4>  aesOPERATION xmmblock, xmm0
  2953                              <4>  %else
  2954                              <4>  aesOPERATIONlast xmmblock, xmm0
  2955                              <4>  %endif
  2956                              <4>  %endif
  2957                              <4> 
  2958                              <4>  %assign block block+1
  2959                              <4> 
  2960                              <4>  %if round = 0
  2961                              <4>  pxor xmmblock, xmm0
  2962                              <4>  %else
  2963                              <4>  %if round < 14
  2964 000004C7 66440F38DEC8        <4>  aesOPERATION xmmblock, xmm0
  2965                              <4>  %else
  2966                              <4>  aesOPERATIONlast xmmblock, xmm0
  2967                              <4>  %endif
  2968                              <4>  %endif
  2969                              <4> 
  2970                              <4>  %assign block block+1
  2971                              <4> 
  2972                              <4>  %if round = 0
  2973                              <4>  pxor xmmblock, xmm0
  2974                              <4>  %else
  2975                              <4>  %if round < 14
  2976 000004CD 66440F38DED0        <4>  aesOPERATION xmmblock, xmm0
  2977                              <4>  %else
  2978                              <4>  aesOPERATIONlast xmmblock, xmm0
  2979                              <4>  %endif
  2980                              <4>  %endif
  2981                              <4> 
  2982                              <4>  %assign block block+1
  2983                              <4> 
  2984                              <4>  %if round = 0
  2985                              <4>  pxor xmmblock, xmm0
  2986                              <4>  %else
  2987                              <4>  %if round < 14
  2988 000004D3 66440F38DED8        <4>  aesOPERATION xmmblock, xmm0
  2989                              <4>  %else
  2990                              <4>  aesOPERATIONlast xmmblock, xmm0
  2991                              <4>  %endif
  2992                              <4>  %endif
  2993                              <4> 
  2994                              <4>  %assign block block+1
  2995                              <4> 
  2996                              <4>  %if round = 0
  2997                              <4>  pxor xmmblock, xmm0
  2998                              <4>  %else
  2999                              <4>  %if round < 14
  3000 000004D9 66440F38DEE0        <4>  aesOPERATION xmmblock, xmm0
  3001                              <4>  %else
  3002                              <4>  aesOPERATIONlast xmmblock, xmm0
  3003                              <4>  %endif
  3004                              <4>  %endif
  3005                              <4> 
  3006                              <4>  %assign block block+1
  3007                              <4> 
  3008                              <4>  %if round = 0
  3009                              <4>  pxor xmmblock, xmm0
  3010                              <4>  %else
  3011                              <4>  %if round < 14
  3012 000004DF 66440F38DEE8        <4>  aesOPERATION xmmblock, xmm0
  3013                              <4>  %else
  3014                              <4>  aesOPERATIONlast xmmblock, xmm0
  3015                              <4>  %endif
  3016                              <4>  %endif
  3017                              <4> 
  3018                              <4>  %assign block block+1
  3019                              <4> 
  3020                              <4>  %if round = 0
  3021                              <4>  pxor xmmblock, xmm0
  3022                              <4>  %else
  3023                              <4>  %if round < 14
  3024 000004E5 66440F38DEF0        <4>  aesOPERATION xmmblock, xmm0
  3025                              <4>  %else
  3026                              <4>  aesOPERATIONlast xmmblock, xmm0
  3027                              <4>  %endif
  3028                              <4>  %endif
  3029                              <4> 
  3030                              <4>  %assign block block+1
  3031                              <4> 
  3032                              <4>  %if round = 0
  3033                              <4>  pxor xmmblock, xmm0
  3034                              <4>  %else
  3035                              <4>  %if round < 14
  3036 000004EB 66440F38DEF8        <4>  aesOPERATION xmmblock, xmm0
  3037                              <4>  %else
  3038                              <4>  aesOPERATIONlast xmmblock, xmm0
  3039                              <4>  %endif
  3040                              <4>  %endif
  3041                              <4> 
  3042                              <4>  %assign block block+1
  3043                              <3> 
  3044                              <3>  %assign round round+1
  3045 000004F1 F30F6F81A0000000    <3>  movdqu xmm0, [Rcx + 16 * round]
  3046                              <3> 
  3047                              <3>  %assign block 1
  3048                              <3>  %rep BLOCK_COUNT
  3049                              <3> 
  3050                              <3>  %if round = 0
  3051                              <3>  pxor xmmblock, xmm0
  3052                              <3>  %else
  3053                              <3>  %if round < 14
  3054                              <3>  aesOPERATION xmmblock, xmm0
  3055                              <3>  %else
  3056                              <3>  aesOPERATIONlast xmmblock, xmm0
  3057                              <3>  %endif
  3058                              <3>  %endif
  3059                              <3> 
  3060                              <3>  %assign block block+1
  3061                              <3>  %endrep
  3062                              <4> 
  3063                              <4>  %if round = 0
  3064                              <4>  pxor xmmblock, xmm0
  3065                              <4>  %else
  3066                              <4>  %if round < 14
  3067 000004F9 660F38DEC8          <4>  aesOPERATION xmmblock, xmm0
  3068                              <4>  %else
  3069                              <4>  aesOPERATIONlast xmmblock, xmm0
  3070                              <4>  %endif
  3071                              <4>  %endif
  3072                              <4> 
  3073                              <4>  %assign block block+1
  3074                              <4> 
  3075                              <4>  %if round = 0
  3076                              <4>  pxor xmmblock, xmm0
  3077                              <4>  %else
  3078                              <4>  %if round < 14
  3079 000004FE 660F38DED0          <4>  aesOPERATION xmmblock, xmm0
  3080                              <4>  %else
  3081                              <4>  aesOPERATIONlast xmmblock, xmm0
  3082                              <4>  %endif
  3083                              <4>  %endif
  3084                              <4> 
  3085                              <4>  %assign block block+1
  3086                              <4> 
  3087                              <4>  %if round = 0
  3088                              <4>  pxor xmmblock, xmm0
  3089                              <4>  %else
  3090                              <4>  %if round < 14
  3091 00000503 660F38DED8          <4>  aesOPERATION xmmblock, xmm0
  3092                              <4>  %else
  3093                              <4>  aesOPERATIONlast xmmblock, xmm0
  3094                              <4>  %endif
  3095                              <4>  %endif
  3096                              <4> 
  3097                              <4>  %assign block block+1
  3098                              <4> 
  3099                              <4>  %if round = 0
  3100                              <4>  pxor xmmblock, xmm0
  3101                              <4>  %else
  3102                              <4>  %if round < 14
  3103 00000508 660F38DEE0          <4>  aesOPERATION xmmblock, xmm0
  3104                              <4>  %else
  3105                              <4>  aesOPERATIONlast xmmblock, xmm0
  3106                              <4>  %endif
  3107                              <4>  %endif
  3108                              <4> 
  3109                              <4>  %assign block block+1
  3110                              <4> 
  3111                              <4>  %if round = 0
  3112                              <4>  pxor xmmblock, xmm0
  3113                              <4>  %else
  3114                              <4>  %if round < 14
  3115 0000050D 660F38DEE8          <4>  aesOPERATION xmmblock, xmm0
  3116                              <4>  %else
  3117                              <4>  aesOPERATIONlast xmmblock, xmm0
  3118                              <4>  %endif
  3119                              <4>  %endif
  3120                              <4> 
  3121                              <4>  %assign block block+1
  3122                              <4> 
  3123                              <4>  %if round = 0
  3124                              <4>  pxor xmmblock, xmm0
  3125                              <4>  %else
  3126                              <4>  %if round < 14
  3127 00000512 660F38DEF0          <4>  aesOPERATION xmmblock, xmm0
  3128                              <4>  %else
  3129                              <4>  aesOPERATIONlast xmmblock, xmm0
  3130                              <4>  %endif
  3131                              <4>  %endif
  3132                              <4> 
  3133                              <4>  %assign block block+1
  3134                              <4> 
  3135                              <4>  %if round = 0
  3136                              <4>  pxor xmmblock, xmm0
  3137                              <4>  %else
  3138                              <4>  %if round < 14
  3139 00000517 660F38DEF8          <4>  aesOPERATION xmmblock, xmm0
  3140                              <4>  %else
  3141                              <4>  aesOPERATIONlast xmmblock, xmm0
  3142                              <4>  %endif
  3143                              <4>  %endif
  3144                              <4> 
  3145                              <4>  %assign block block+1
  3146                              <4> 
  3147                              <4>  %if round = 0
  3148                              <4>  pxor xmmblock, xmm0
  3149                              <4>  %else
  3150                              <4>  %if round < 14
  3151 0000051C 66440F38DEC0        <4>  aesOPERATION xmmblock, xmm0
  3152                              <4>  %else
  3153                              <4>  aesOPERATIONlast xmmblock, xmm0
  3154                              <4>  %endif
  3155                              <4>  %endif
  3156                              <4> 
  3157                              <4>  %assign block block+1
  3158                              <4> 
  3159                              <4>  %if round = 0
  3160                              <4>  pxor xmmblock, xmm0
  3161                              <4>  %else
  3162                              <4>  %if round < 14
  3163 00000522 66440F38DEC8        <4>  aesOPERATION xmmblock, xmm0
  3164                              <4>  %else
  3165                              <4>  aesOPERATIONlast xmmblock, xmm0
  3166                              <4>  %endif
  3167                              <4>  %endif
  3168                              <4> 
  3169                              <4>  %assign block block+1
  3170                              <4> 
  3171                              <4>  %if round = 0
  3172                              <4>  pxor xmmblock, xmm0
  3173                              <4>  %else
  3174                              <4>  %if round < 14
  3175 00000528 66440F38DED0        <4>  aesOPERATION xmmblock, xmm0
  3176                              <4>  %else
  3177                              <4>  aesOPERATIONlast xmmblock, xmm0
  3178                              <4>  %endif
  3179                              <4>  %endif
  3180                              <4> 
  3181                              <4>  %assign block block+1
  3182                              <4> 
  3183                              <4>  %if round = 0
  3184                              <4>  pxor xmmblock, xmm0
  3185                              <4>  %else
  3186                              <4>  %if round < 14
  3187 0000052E 66440F38DED8        <4>  aesOPERATION xmmblock, xmm0
  3188                              <4>  %else
  3189                              <4>  aesOPERATIONlast xmmblock, xmm0
  3190                              <4>  %endif
  3191                              <4>  %endif
  3192                              <4> 
  3193                              <4>  %assign block block+1
  3194                              <4> 
  3195                              <4>  %if round = 0
  3196                              <4>  pxor xmmblock, xmm0
  3197                              <4>  %else
  3198                              <4>  %if round < 14
  3199 00000534 66440F38DEE0        <4>  aesOPERATION xmmblock, xmm0
  3200                              <4>  %else
  3201                              <4>  aesOPERATIONlast xmmblock, xmm0
  3202                              <4>  %endif
  3203                              <4>  %endif
  3204                              <4> 
  3205                              <4>  %assign block block+1
  3206                              <4> 
  3207                              <4>  %if round = 0
  3208                              <4>  pxor xmmblock, xmm0
  3209                              <4>  %else
  3210                              <4>  %if round < 14
  3211 0000053A 66440F38DEE8        <4>  aesOPERATION xmmblock, xmm0
  3212                              <4>  %else
  3213                              <4>  aesOPERATIONlast xmmblock, xmm0
  3214                              <4>  %endif
  3215                              <4>  %endif
  3216                              <4> 
  3217                              <4>  %assign block block+1
  3218                              <4> 
  3219                              <4>  %if round = 0
  3220                              <4>  pxor xmmblock, xmm0
  3221                              <4>  %else
  3222                              <4>  %if round < 14
  3223 00000540 66440F38DEF0        <4>  aesOPERATION xmmblock, xmm0
  3224                              <4>  %else
  3225                              <4>  aesOPERATIONlast xmmblock, xmm0
  3226                              <4>  %endif
  3227                              <4>  %endif
  3228                              <4> 
  3229                              <4>  %assign block block+1
  3230                              <4> 
  3231                              <4>  %if round = 0
  3232                              <4>  pxor xmmblock, xmm0
  3233                              <4>  %else
  3234                              <4>  %if round < 14
  3235 00000546 66440F38DEF8        <4>  aesOPERATION xmmblock, xmm0
  3236                              <4>  %else
  3237                              <4>  aesOPERATIONlast xmmblock, xmm0
  3238                              <4>  %endif
  3239                              <4>  %endif
  3240                              <4> 
  3241                              <4>  %assign block block+1
  3242                              <3> 
  3243                              <3>  %assign round round+1
  3244 0000054C F30F6F81B0000000    <3>  movdqu xmm0, [Rcx + 16 * round]
  3245                              <3> 
  3246                              <3>  %assign block 1
  3247                              <3>  %rep BLOCK_COUNT
  3248                              <3> 
  3249                              <3>  %if round = 0
  3250                              <3>  pxor xmmblock, xmm0
  3251                              <3>  %else
  3252                              <3>  %if round < 14
  3253                              <3>  aesOPERATION xmmblock, xmm0
  3254                              <3>  %else
  3255                              <3>  aesOPERATIONlast xmmblock, xmm0
  3256                              <3>  %endif
  3257                              <3>  %endif
  3258                              <3> 
  3259                              <3>  %assign block block+1
  3260                              <3>  %endrep
  3261                              <4> 
  3262                              <4>  %if round = 0
  3263                              <4>  pxor xmmblock, xmm0
  3264                              <4>  %else
  3265                              <4>  %if round < 14
  3266 00000554 660F38DEC8          <4>  aesOPERATION xmmblock, xmm0
  3267                              <4>  %else
  3268                              <4>  aesOPERATIONlast xmmblock, xmm0
  3269                              <4>  %endif
  3270                              <4>  %endif
  3271                              <4> 
  3272                              <4>  %assign block block+1
  3273                              <4> 
  3274                              <4>  %if round = 0
  3275                              <4>  pxor xmmblock, xmm0
  3276                              <4>  %else
  3277                              <4>  %if round < 14
  3278 00000559 660F38DED0          <4>  aesOPERATION xmmblock, xmm0
  3279                              <4>  %else
  3280                              <4>  aesOPERATIONlast xmmblock, xmm0
  3281                              <4>  %endif
  3282                              <4>  %endif
  3283                              <4> 
  3284                              <4>  %assign block block+1
  3285                              <4> 
  3286                              <4>  %if round = 0
  3287                              <4>  pxor xmmblock, xmm0
  3288                              <4>  %else
  3289                              <4>  %if round < 14
  3290 0000055E 660F38DED8          <4>  aesOPERATION xmmblock, xmm0
  3291                              <4>  %else
  3292                              <4>  aesOPERATIONlast xmmblock, xmm0
  3293                              <4>  %endif
  3294                              <4>  %endif
  3295                              <4> 
  3296                              <4>  %assign block block+1
  3297                              <4> 
  3298                              <4>  %if round = 0
  3299                              <4>  pxor xmmblock, xmm0
  3300                              <4>  %else
  3301                              <4>  %if round < 14
  3302 00000563 660F38DEE0          <4>  aesOPERATION xmmblock, xmm0
  3303                              <4>  %else
  3304                              <4>  aesOPERATIONlast xmmblock, xmm0
  3305                              <4>  %endif
  3306                              <4>  %endif
  3307                              <4> 
  3308                              <4>  %assign block block+1
  3309                              <4> 
  3310                              <4>  %if round = 0
  3311                              <4>  pxor xmmblock, xmm0
  3312                              <4>  %else
  3313                              <4>  %if round < 14
  3314 00000568 660F38DEE8          <4>  aesOPERATION xmmblock, xmm0
  3315                              <4>  %else
  3316                              <4>  aesOPERATIONlast xmmblock, xmm0
  3317                              <4>  %endif
  3318                              <4>  %endif
  3319                              <4> 
  3320                              <4>  %assign block block+1
  3321                              <4> 
  3322                              <4>  %if round = 0
  3323                              <4>  pxor xmmblock, xmm0
  3324                              <4>  %else
  3325                              <4>  %if round < 14
  3326 0000056D 660F38DEF0          <4>  aesOPERATION xmmblock, xmm0
  3327                              <4>  %else
  3328                              <4>  aesOPERATIONlast xmmblock, xmm0
  3329                              <4>  %endif
  3330                              <4>  %endif
  3331                              <4> 
  3332                              <4>  %assign block block+1
  3333                              <4> 
  3334                              <4>  %if round = 0
  3335                              <4>  pxor xmmblock, xmm0
  3336                              <4>  %else
  3337                              <4>  %if round < 14
  3338 00000572 660F38DEF8          <4>  aesOPERATION xmmblock, xmm0
  3339                              <4>  %else
  3340                              <4>  aesOPERATIONlast xmmblock, xmm0
  3341                              <4>  %endif
  3342                              <4>  %endif
  3343                              <4> 
  3344                              <4>  %assign block block+1
  3345                              <4> 
  3346                              <4>  %if round = 0
  3347                              <4>  pxor xmmblock, xmm0
  3348                              <4>  %else
  3349                              <4>  %if round < 14
  3350 00000577 66440F38DEC0        <4>  aesOPERATION xmmblock, xmm0
  3351                              <4>  %else
  3352                              <4>  aesOPERATIONlast xmmblock, xmm0
  3353                              <4>  %endif
  3354                              <4>  %endif
  3355                              <4> 
  3356                              <4>  %assign block block+1
  3357                              <4> 
  3358                              <4>  %if round = 0
  3359                              <4>  pxor xmmblock, xmm0
  3360                              <4>  %else
  3361                              <4>  %if round < 14
  3362 0000057D 66440F38DEC8        <4>  aesOPERATION xmmblock, xmm0
  3363                              <4>  %else
  3364                              <4>  aesOPERATIONlast xmmblock, xmm0
  3365                              <4>  %endif
  3366                              <4>  %endif
  3367                              <4> 
  3368                              <4>  %assign block block+1
  3369                              <4> 
  3370                              <4>  %if round = 0
  3371                              <4>  pxor xmmblock, xmm0
  3372                              <4>  %else
  3373                              <4>  %if round < 14
  3374 00000583 66440F38DED0        <4>  aesOPERATION xmmblock, xmm0
  3375                              <4>  %else
  3376                              <4>  aesOPERATIONlast xmmblock, xmm0
  3377                              <4>  %endif
  3378                              <4>  %endif
  3379                              <4> 
  3380                              <4>  %assign block block+1
  3381                              <4> 
  3382                              <4>  %if round = 0
  3383                              <4>  pxor xmmblock, xmm0
  3384                              <4>  %else
  3385                              <4>  %if round < 14
  3386 00000589 66440F38DED8        <4>  aesOPERATION xmmblock, xmm0
  3387                              <4>  %else
  3388                              <4>  aesOPERATIONlast xmmblock, xmm0
  3389                              <4>  %endif
  3390                              <4>  %endif
  3391                              <4> 
  3392                              <4>  %assign block block+1
  3393                              <4> 
  3394                              <4>  %if round = 0
  3395                              <4>  pxor xmmblock, xmm0
  3396                              <4>  %else
  3397                              <4>  %if round < 14
  3398 0000058F 66440F38DEE0        <4>  aesOPERATION xmmblock, xmm0
  3399                              <4>  %else
  3400                              <4>  aesOPERATIONlast xmmblock, xmm0
  3401                              <4>  %endif
  3402                              <4>  %endif
  3403                              <4> 
  3404                              <4>  %assign block block+1
  3405                              <4> 
  3406                              <4>  %if round = 0
  3407                              <4>  pxor xmmblock, xmm0
  3408                              <4>  %else
  3409                              <4>  %if round < 14
  3410 00000595 66440F38DEE8        <4>  aesOPERATION xmmblock, xmm0
  3411                              <4>  %else
  3412                              <4>  aesOPERATIONlast xmmblock, xmm0
  3413                              <4>  %endif
  3414                              <4>  %endif
  3415                              <4> 
  3416                              <4>  %assign block block+1
  3417                              <4> 
  3418                              <4>  %if round = 0
  3419                              <4>  pxor xmmblock, xmm0
  3420                              <4>  %else
  3421                              <4>  %if round < 14
  3422 0000059B 66440F38DEF0        <4>  aesOPERATION xmmblock, xmm0
  3423                              <4>  %else
  3424                              <4>  aesOPERATIONlast xmmblock, xmm0
  3425                              <4>  %endif
  3426                              <4>  %endif
  3427                              <4> 
  3428                              <4>  %assign block block+1
  3429                              <4> 
  3430                              <4>  %if round = 0
  3431                              <4>  pxor xmmblock, xmm0
  3432                              <4>  %else
  3433                              <4>  %if round < 14
  3434 000005A1 66440F38DEF8        <4>  aesOPERATION xmmblock, xmm0
  3435                              <4>  %else
  3436                              <4>  aesOPERATIONlast xmmblock, xmm0
  3437                              <4>  %endif
  3438                              <4>  %endif
  3439                              <4> 
  3440                              <4>  %assign block block+1
  3441                              <3> 
  3442                              <3>  %assign round round+1
  3443 000005A7 F30F6F81C0000000    <3>  movdqu xmm0, [Rcx + 16 * round]
  3444                              <3> 
  3445                              <3>  %assign block 1
  3446                              <3>  %rep BLOCK_COUNT
  3447                              <3> 
  3448                              <3>  %if round = 0
  3449                              <3>  pxor xmmblock, xmm0
  3450                              <3>  %else
  3451                              <3>  %if round < 14
  3452                              <3>  aesOPERATION xmmblock, xmm0
  3453                              <3>  %else
  3454                              <3>  aesOPERATIONlast xmmblock, xmm0
  3455                              <3>  %endif
  3456                              <3>  %endif
  3457                              <3> 
  3458                              <3>  %assign block block+1
  3459                              <3>  %endrep
  3460                              <4> 
  3461                              <4>  %if round = 0
  3462                              <4>  pxor xmmblock, xmm0
  3463                              <4>  %else
  3464                              <4>  %if round < 14
  3465 000005AF 660F38DEC8          <4>  aesOPERATION xmmblock, xmm0
  3466                              <4>  %else
  3467                              <4>  aesOPERATIONlast xmmblock, xmm0
  3468                              <4>  %endif
  3469                              <4>  %endif
  3470                              <4> 
  3471                              <4>  %assign block block+1
  3472                              <4> 
  3473                              <4>  %if round = 0
  3474                              <4>  pxor xmmblock, xmm0
  3475                              <4>  %else
  3476                              <4>  %if round < 14
  3477 000005B4 660F38DED0          <4>  aesOPERATION xmmblock, xmm0
  3478                              <4>  %else
  3479                              <4>  aesOPERATIONlast xmmblock, xmm0
  3480                              <4>  %endif
  3481                              <4>  %endif
  3482                              <4> 
  3483                              <4>  %assign block block+1
  3484                              <4> 
  3485                              <4>  %if round = 0
  3486                              <4>  pxor xmmblock, xmm0
  3487                              <4>  %else
  3488                              <4>  %if round < 14
  3489 000005B9 660F38DED8          <4>  aesOPERATION xmmblock, xmm0
  3490                              <4>  %else
  3491                              <4>  aesOPERATIONlast xmmblock, xmm0
  3492                              <4>  %endif
  3493                              <4>  %endif
  3494                              <4> 
  3495                              <4>  %assign block block+1
  3496                              <4> 
  3497                              <4>  %if round = 0
  3498                              <4>  pxor xmmblock, xmm0
  3499                              <4>  %else
  3500                              <4>  %if round < 14
  3501 000005BE 660F38DEE0          <4>  aesOPERATION xmmblock, xmm0
  3502                              <4>  %else
  3503                              <4>  aesOPERATIONlast xmmblock, xmm0
  3504                              <4>  %endif
  3505                              <4>  %endif
  3506                              <4> 
  3507                              <4>  %assign block block+1
  3508                              <4> 
  3509                              <4>  %if round = 0
  3510                              <4>  pxor xmmblock, xmm0
  3511                              <4>  %else
  3512                              <4>  %if round < 14
  3513 000005C3 660F38DEE8          <4>  aesOPERATION xmmblock, xmm0
  3514                              <4>  %else
  3515                              <4>  aesOPERATIONlast xmmblock, xmm0
  3516                              <4>  %endif
  3517                              <4>  %endif
  3518                              <4> 
  3519                              <4>  %assign block block+1
  3520                              <4> 
  3521                              <4>  %if round = 0
  3522                              <4>  pxor xmmblock, xmm0
  3523                              <4>  %else
  3524                              <4>  %if round < 14
  3525 000005C8 660F38DEF0          <4>  aesOPERATION xmmblock, xmm0
  3526                              <4>  %else
  3527                              <4>  aesOPERATIONlast xmmblock, xmm0
  3528                              <4>  %endif
  3529                              <4>  %endif
  3530                              <4> 
  3531                              <4>  %assign block block+1
  3532                              <4> 
  3533                              <4>  %if round = 0
  3534                              <4>  pxor xmmblock, xmm0
  3535                              <4>  %else
  3536                              <4>  %if round < 14
  3537 000005CD 660F38DEF8          <4>  aesOPERATION xmmblock, xmm0
  3538                              <4>  %else
  3539                              <4>  aesOPERATIONlast xmmblock, xmm0
  3540                              <4>  %endif
  3541                              <4>  %endif
  3542                              <4> 
  3543                              <4>  %assign block block+1
  3544                              <4> 
  3545                              <4>  %if round = 0
  3546                              <4>  pxor xmmblock, xmm0
  3547                              <4>  %else
  3548                              <4>  %if round < 14
  3549 000005D2 66440F38DEC0        <4>  aesOPERATION xmmblock, xmm0
  3550                              <4>  %else
  3551                              <4>  aesOPERATIONlast xmmblock, xmm0
  3552                              <4>  %endif
  3553                              <4>  %endif
  3554                              <4> 
  3555                              <4>  %assign block block+1
  3556                              <4> 
  3557                              <4>  %if round = 0
  3558                              <4>  pxor xmmblock, xmm0
  3559                              <4>  %else
  3560                              <4>  %if round < 14
  3561 000005D8 66440F38DEC8        <4>  aesOPERATION xmmblock, xmm0
  3562                              <4>  %else
  3563                              <4>  aesOPERATIONlast xmmblock, xmm0
  3564                              <4>  %endif
  3565                              <4>  %endif
  3566                              <4> 
  3567                              <4>  %assign block block+1
  3568                              <4> 
  3569                              <4>  %if round = 0
  3570                              <4>  pxor xmmblock, xmm0
  3571                              <4>  %else
  3572                              <4>  %if round < 14
  3573 000005DE 66440F38DED0        <4>  aesOPERATION xmmblock, xmm0
  3574                              <4>  %else
  3575                              <4>  aesOPERATIONlast xmmblock, xmm0
  3576                              <4>  %endif
  3577                              <4>  %endif
  3578                              <4> 
  3579                              <4>  %assign block block+1
  3580                              <4> 
  3581                              <4>  %if round = 0
  3582                              <4>  pxor xmmblock, xmm0
  3583                              <4>  %else
  3584                              <4>  %if round < 14
  3585 000005E4 66440F38DED8        <4>  aesOPERATION xmmblock, xmm0
  3586                              <4>  %else
  3587                              <4>  aesOPERATIONlast xmmblock, xmm0
  3588                              <4>  %endif
  3589                              <4>  %endif
  3590                              <4> 
  3591                              <4>  %assign block block+1
  3592                              <4> 
  3593                              <4>  %if round = 0
  3594                              <4>  pxor xmmblock, xmm0
  3595                              <4>  %else
  3596                              <4>  %if round < 14
  3597 000005EA 66440F38DEE0        <4>  aesOPERATION xmmblock, xmm0
  3598                              <4>  %else
  3599                              <4>  aesOPERATIONlast xmmblock, xmm0
  3600                              <4>  %endif
  3601                              <4>  %endif
  3602                              <4> 
  3603                              <4>  %assign block block+1
  3604                              <4> 
  3605                              <4>  %if round = 0
  3606                              <4>  pxor xmmblock, xmm0
  3607                              <4>  %else
  3608                              <4>  %if round < 14
  3609 000005F0 66440F38DEE8        <4>  aesOPERATION xmmblock, xmm0
  3610                              <4>  %else
  3611                              <4>  aesOPERATIONlast xmmblock, xmm0
  3612                              <4>  %endif
  3613                              <4>  %endif
  3614                              <4> 
  3615                              <4>  %assign block block+1
  3616                              <4> 
  3617                              <4>  %if round = 0
  3618                              <4>  pxor xmmblock, xmm0
  3619                              <4>  %else
  3620                              <4>  %if round < 14
  3621 000005F6 66440F38DEF0        <4>  aesOPERATION xmmblock, xmm0
  3622                              <4>  %else
  3623                              <4>  aesOPERATIONlast xmmblock, xmm0
  3624                              <4>  %endif
  3625                              <4>  %endif
  3626                              <4> 
  3627                              <4>  %assign block block+1
  3628                              <4> 
  3629                              <4>  %if round = 0
  3630                              <4>  pxor xmmblock, xmm0
  3631                              <4>  %else
  3632                              <4>  %if round < 14
  3633 000005FC 66440F38DEF8        <4>  aesOPERATION xmmblock, xmm0
  3634                              <4>  %else
  3635                              <4>  aesOPERATIONlast xmmblock, xmm0
  3636                              <4>  %endif
  3637                              <4>  %endif
  3638                              <4> 
  3639                              <4>  %assign block block+1
  3640                              <3> 
  3641                              <3>  %assign round round+1
  3642 00000602 F30F6F81D0000000    <3>  movdqu xmm0, [Rcx + 16 * round]
  3643                              <3> 
  3644                              <3>  %assign block 1
  3645                              <3>  %rep BLOCK_COUNT
  3646                              <3> 
  3647                              <3>  %if round = 0
  3648                              <3>  pxor xmmblock, xmm0
  3649                              <3>  %else
  3650                              <3>  %if round < 14
  3651                              <3>  aesOPERATION xmmblock, xmm0
  3652                              <3>  %else
  3653                              <3>  aesOPERATIONlast xmmblock, xmm0
  3654                              <3>  %endif
  3655                              <3>  %endif
  3656                              <3> 
  3657                              <3>  %assign block block+1
  3658                              <3>  %endrep
  3659                              <4> 
  3660                              <4>  %if round = 0
  3661                              <4>  pxor xmmblock, xmm0
  3662                              <4>  %else
  3663                              <4>  %if round < 14
  3664 0000060A 660F38DEC8          <4>  aesOPERATION xmmblock, xmm0
  3665                              <4>  %else
  3666                              <4>  aesOPERATIONlast xmmblock, xmm0
  3667                              <4>  %endif
  3668                              <4>  %endif
  3669                              <4> 
  3670                              <4>  %assign block block+1
  3671                              <4> 
  3672                              <4>  %if round = 0
  3673                              <4>  pxor xmmblock, xmm0
  3674                              <4>  %else
  3675                              <4>  %if round < 14
  3676 0000060F 660F38DED0          <4>  aesOPERATION xmmblock, xmm0
  3677                              <4>  %else
  3678                              <4>  aesOPERATIONlast xmmblock, xmm0
  3679                              <4>  %endif
  3680                              <4>  %endif
  3681                              <4> 
  3682                              <4>  %assign block block+1
  3683                              <4> 
  3684                              <4>  %if round = 0
  3685                              <4>  pxor xmmblock, xmm0
  3686                              <4>  %else
  3687                              <4>  %if round < 14
  3688 00000614 660F38DED8          <4>  aesOPERATION xmmblock, xmm0
  3689                              <4>  %else
  3690                              <4>  aesOPERATIONlast xmmblock, xmm0
  3691                              <4>  %endif
  3692                              <4>  %endif
  3693                              <4> 
  3694                              <4>  %assign block block+1
  3695                              <4> 
  3696                              <4>  %if round = 0
  3697                              <4>  pxor xmmblock, xmm0
  3698                              <4>  %else
  3699                              <4>  %if round < 14
  3700 00000619 660F38DEE0          <4>  aesOPERATION xmmblock, xmm0
  3701                              <4>  %else
  3702                              <4>  aesOPERATIONlast xmmblock, xmm0
  3703                              <4>  %endif
  3704                              <4>  %endif
  3705                              <4> 
  3706                              <4>  %assign block block+1
  3707                              <4> 
  3708                              <4>  %if round = 0
  3709                              <4>  pxor xmmblock, xmm0
  3710                              <4>  %else
  3711                              <4>  %if round < 14
  3712 0000061E 660F38DEE8          <4>  aesOPERATION xmmblock, xmm0
  3713                              <4>  %else
  3714                              <4>  aesOPERATIONlast xmmblock, xmm0
  3715                              <4>  %endif
  3716                              <4>  %endif
  3717                              <4> 
  3718                              <4>  %assign block block+1
  3719                              <4> 
  3720                              <4>  %if round = 0
  3721                              <4>  pxor xmmblock, xmm0
  3722                              <4>  %else
  3723                              <4>  %if round < 14
  3724 00000623 660F38DEF0          <4>  aesOPERATION xmmblock, xmm0
  3725                              <4>  %else
  3726                              <4>  aesOPERATIONlast xmmblock, xmm0
  3727                              <4>  %endif
  3728                              <4>  %endif
  3729                              <4> 
  3730                              <4>  %assign block block+1
  3731                              <4> 
  3732                              <4>  %if round = 0
  3733                              <4>  pxor xmmblock, xmm0
  3734                              <4>  %else
  3735                              <4>  %if round < 14
  3736 00000628 660F38DEF8          <4>  aesOPERATION xmmblock, xmm0
  3737                              <4>  %else
  3738                              <4>  aesOPERATIONlast xmmblock, xmm0
  3739                              <4>  %endif
  3740                              <4>  %endif
  3741                              <4> 
  3742                              <4>  %assign block block+1
  3743                              <4> 
  3744                              <4>  %if round = 0
  3745                              <4>  pxor xmmblock, xmm0
  3746                              <4>  %else
  3747                              <4>  %if round < 14
  3748 0000062D 66440F38DEC0        <4>  aesOPERATION xmmblock, xmm0
  3749                              <4>  %else
  3750                              <4>  aesOPERATIONlast xmmblock, xmm0
  3751                              <4>  %endif
  3752                              <4>  %endif
  3753                              <4> 
  3754                              <4>  %assign block block+1
  3755                              <4> 
  3756                              <4>  %if round = 0
  3757                              <4>  pxor xmmblock, xmm0
  3758                              <4>  %else
  3759                              <4>  %if round < 14
  3760 00000633 66440F38DEC8        <4>  aesOPERATION xmmblock, xmm0
  3761                              <4>  %else
  3762                              <4>  aesOPERATIONlast xmmblock, xmm0
  3763                              <4>  %endif
  3764                              <4>  %endif
  3765                              <4> 
  3766                              <4>  %assign block block+1
  3767                              <4> 
  3768                              <4>  %if round = 0
  3769                              <4>  pxor xmmblock, xmm0
  3770                              <4>  %else
  3771                              <4>  %if round < 14
  3772 00000639 66440F38DED0        <4>  aesOPERATION xmmblock, xmm0
  3773                              <4>  %else
  3774                              <4>  aesOPERATIONlast xmmblock, xmm0
  3775                              <4>  %endif
  3776                              <4>  %endif
  3777                              <4> 
  3778                              <4>  %assign block block+1
  3779                              <4> 
  3780                              <4>  %if round = 0
  3781                              <4>  pxor xmmblock, xmm0
  3782                              <4>  %else
  3783                              <4>  %if round < 14
  3784 0000063F 66440F38DED8        <4>  aesOPERATION xmmblock, xmm0
  3785                              <4>  %else
  3786                              <4>  aesOPERATIONlast xmmblock, xmm0
  3787                              <4>  %endif
  3788                              <4>  %endif
  3789                              <4> 
  3790                              <4>  %assign block block+1
  3791                              <4> 
  3792                              <4>  %if round = 0
  3793                              <4>  pxor xmmblock, xmm0
  3794                              <4>  %else
  3795                              <4>  %if round < 14
  3796 00000645 66440F38DEE0        <4>  aesOPERATION xmmblock, xmm0
  3797                              <4>  %else
  3798                              <4>  aesOPERATIONlast xmmblock, xmm0
  3799                              <4>  %endif
  3800                              <4>  %endif
  3801                              <4> 
  3802                              <4>  %assign block block+1
  3803                              <4> 
  3804                              <4>  %if round = 0
  3805                              <4>  pxor xmmblock, xmm0
  3806                              <4>  %else
  3807                              <4>  %if round < 14
  3808 0000064B 66440F38DEE8        <4>  aesOPERATION xmmblock, xmm0
  3809                              <4>  %else
  3810                              <4>  aesOPERATIONlast xmmblock, xmm0
  3811                              <4>  %endif
  3812                              <4>  %endif
  3813                              <4> 
  3814                              <4>  %assign block block+1
  3815                              <4> 
  3816                              <4>  %if round = 0
  3817                              <4>  pxor xmmblock, xmm0
  3818                              <4>  %else
  3819                              <4>  %if round < 14
  3820 00000651 66440F38DEF0        <4>  aesOPERATION xmmblock, xmm0
  3821                              <4>  %else
  3822                              <4>  aesOPERATIONlast xmmblock, xmm0
  3823                              <4>  %endif
  3824                              <4>  %endif
  3825                              <4> 
  3826                              <4>  %assign block block+1
  3827                              <4> 
  3828                              <4>  %if round = 0
  3829                              <4>  pxor xmmblock, xmm0
  3830                              <4>  %else
  3831                              <4>  %if round < 14
  3832 00000657 66440F38DEF8        <4>  aesOPERATION xmmblock, xmm0
  3833                              <4>  %else
  3834                              <4>  aesOPERATIONlast xmmblock, xmm0
  3835                              <4>  %endif
  3836                              <4>  %endif
  3837                              <4> 
  3838                              <4>  %assign block block+1
  3839                              <3> 
  3840                              <3>  %assign round round+1
  3841 0000065D F30F6F81E0000000    <3>  movdqu xmm0, [Rcx + 16 * round]
  3842                              <3> 
  3843                              <3>  %assign block 1
  3844                              <3>  %rep BLOCK_COUNT
  3845                              <3> 
  3846                              <3>  %if round = 0
  3847                              <3>  pxor xmmblock, xmm0
  3848                              <3>  %else
  3849                              <3>  %if round < 14
  3850                              <3>  aesOPERATION xmmblock, xmm0
  3851                              <3>  %else
  3852                              <3>  aesOPERATIONlast xmmblock, xmm0
  3853                              <3>  %endif
  3854                              <3>  %endif
  3855                              <3> 
  3856                              <3>  %assign block block+1
  3857                              <3>  %endrep
  3858                              <4> 
  3859                              <4>  %if round = 0
  3860                              <4>  pxor xmmblock, xmm0
  3861                              <4>  %else
  3862                              <4>  %if round < 14
  3863                              <4>  aesOPERATION xmmblock, xmm0
  3864                              <4>  %else
  3865 00000665 660F38DFC8          <4>  aesOPERATIONlast xmmblock, xmm0
  3866                              <4>  %endif
  3867                              <4>  %endif
  3868                              <4> 
  3869                              <4>  %assign block block+1
  3870                              <4> 
  3871                              <4>  %if round = 0
  3872                              <4>  pxor xmmblock, xmm0
  3873                              <4>  %else
  3874                              <4>  %if round < 14
  3875                              <4>  aesOPERATION xmmblock, xmm0
  3876                              <4>  %else
  3877 0000066A 660F38DFD0          <4>  aesOPERATIONlast xmmblock, xmm0
  3878                              <4>  %endif
  3879                              <4>  %endif
  3880                              <4> 
  3881                              <4>  %assign block block+1
  3882                              <4> 
  3883                              <4>  %if round = 0
  3884                              <4>  pxor xmmblock, xmm0
  3885                              <4>  %else
  3886                              <4>  %if round < 14
  3887                              <4>  aesOPERATION xmmblock, xmm0
  3888                              <4>  %else
  3889 0000066F 660F38DFD8          <4>  aesOPERATIONlast xmmblock, xmm0
  3890                              <4>  %endif
  3891                              <4>  %endif
  3892                              <4> 
  3893                              <4>  %assign block block+1
  3894                              <4> 
  3895                              <4>  %if round = 0
  3896                              <4>  pxor xmmblock, xmm0
  3897                              <4>  %else
  3898                              <4>  %if round < 14
  3899                              <4>  aesOPERATION xmmblock, xmm0
  3900                              <4>  %else
  3901 00000674 660F38DFE0          <4>  aesOPERATIONlast xmmblock, xmm0
  3902                              <4>  %endif
  3903                              <4>  %endif
  3904                              <4> 
  3905                              <4>  %assign block block+1
  3906                              <4> 
  3907                              <4>  %if round = 0
  3908                              <4>  pxor xmmblock, xmm0
  3909                              <4>  %else
  3910                              <4>  %if round < 14
  3911                              <4>  aesOPERATION xmmblock, xmm0
  3912                              <4>  %else
  3913 00000679 660F38DFE8          <4>  aesOPERATIONlast xmmblock, xmm0
  3914                              <4>  %endif
  3915                              <4>  %endif
  3916                              <4> 
  3917                              <4>  %assign block block+1
  3918                              <4> 
  3919                              <4>  %if round = 0
  3920                              <4>  pxor xmmblock, xmm0
  3921                              <4>  %else
  3922                              <4>  %if round < 14
  3923                              <4>  aesOPERATION xmmblock, xmm0
  3924                              <4>  %else
  3925 0000067E 660F38DFF0          <4>  aesOPERATIONlast xmmblock, xmm0
  3926                              <4>  %endif
  3927                              <4>  %endif
  3928                              <4> 
  3929                              <4>  %assign block block+1
  3930                              <4> 
  3931                              <4>  %if round = 0
  3932                              <4>  pxor xmmblock, xmm0
  3933                              <4>  %else
  3934                              <4>  %if round < 14
  3935                              <4>  aesOPERATION xmmblock, xmm0
  3936                              <4>  %else
  3937 00000683 660F38DFF8          <4>  aesOPERATIONlast xmmblock, xmm0
  3938                              <4>  %endif
  3939                              <4>  %endif
  3940                              <4> 
  3941                              <4>  %assign block block+1
  3942                              <4> 
  3943                              <4>  %if round = 0
  3944                              <4>  pxor xmmblock, xmm0
  3945                              <4>  %else
  3946                              <4>  %if round < 14
  3947                              <4>  aesOPERATION xmmblock, xmm0
  3948                              <4>  %else
  3949 00000688 66440F38DFC0        <4>  aesOPERATIONlast xmmblock, xmm0
  3950                              <4>  %endif
  3951                              <4>  %endif
  3952                              <4> 
  3953                              <4>  %assign block block+1
  3954                              <4> 
  3955                              <4>  %if round = 0
  3956                              <4>  pxor xmmblock, xmm0
  3957                              <4>  %else
  3958                              <4>  %if round < 14
  3959                              <4>  aesOPERATION xmmblock, xmm0
  3960                              <4>  %else
  3961 0000068E 66440F38DFC8        <4>  aesOPERATIONlast xmmblock, xmm0
  3962                              <4>  %endif
  3963                              <4>  %endif
  3964                              <4> 
  3965                              <4>  %assign block block+1
  3966                              <4> 
  3967                              <4>  %if round = 0
  3968                              <4>  pxor xmmblock, xmm0
  3969                              <4>  %else
  3970                              <4>  %if round < 14
  3971                              <4>  aesOPERATION xmmblock, xmm0
  3972                              <4>  %else
  3973 00000694 66440F38DFD0        <4>  aesOPERATIONlast xmmblock, xmm0
  3974                              <4>  %endif
  3975                              <4>  %endif
  3976                              <4> 
  3977                              <4>  %assign block block+1
  3978                              <4> 
  3979                              <4>  %if round = 0
  3980                              <4>  pxor xmmblock, xmm0
  3981                              <4>  %else
  3982                              <4>  %if round < 14
  3983                              <4>  aesOPERATION xmmblock, xmm0
  3984                              <4>  %else
  3985 0000069A 66440F38DFD8        <4>  aesOPERATIONlast xmmblock, xmm0
  3986                              <4>  %endif
  3987                              <4>  %endif
  3988                              <4> 
  3989                              <4>  %assign block block+1
  3990                              <4> 
  3991                              <4>  %if round = 0
  3992                              <4>  pxor xmmblock, xmm0
  3993                              <4>  %else
  3994                              <4>  %if round < 14
  3995                              <4>  aesOPERATION xmmblock, xmm0
  3996                              <4>  %else
  3997 000006A0 66440F38DFE0        <4>  aesOPERATIONlast xmmblock, xmm0
  3998                              <4>  %endif
  3999                              <4>  %endif
  4000                              <4> 
  4001                              <4>  %assign block block+1
  4002                              <4> 
  4003                              <4>  %if round = 0
  4004                              <4>  pxor xmmblock, xmm0
  4005                              <4>  %else
  4006                              <4>  %if round < 14
  4007                              <4>  aesOPERATION xmmblock, xmm0
  4008                              <4>  %else
  4009 000006A6 66440F38DFE8        <4>  aesOPERATIONlast xmmblock, xmm0
  4010                              <4>  %endif
  4011                              <4>  %endif
  4012                              <4> 
  4013                              <4>  %assign block block+1
  4014                              <4> 
  4015                              <4>  %if round = 0
  4016                              <4>  pxor xmmblock, xmm0
  4017                              <4>  %else
  4018                              <4>  %if round < 14
  4019                              <4>  aesOPERATION xmmblock, xmm0
  4020                              <4>  %else
  4021 000006AC 66440F38DFF0        <4>  aesOPERATIONlast xmmblock, xmm0
  4022                              <4>  %endif
  4023                              <4>  %endif
  4024                              <4> 
  4025                              <4>  %assign block block+1
  4026                              <4> 
  4027                              <4>  %if round = 0
  4028                              <4>  pxor xmmblock, xmm0
  4029                              <4>  %else
  4030                              <4>  %if round < 14
  4031                              <4>  aesOPERATION xmmblock, xmm0
  4032                              <4>  %else
  4033 000006B2 66440F38DFF8        <4>  aesOPERATIONlast xmmblock, xmm0
  4034                              <4>  %endif
  4035                              <4>  %endif
  4036                              <4> 
  4037                              <4>  %assign block block+1
  4038                              <3> 
  4039                              <3>  %assign round round+1
  4040                              <2> 
  4041                              <2> 
  4042                              <2>  %assign block 1
  4043                              <2>  %rep BLOCK_COUNT
  4044                              <2>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  4045                              <2>  %assign block block+1
  4046                              <2>  %endrep
  4047 000006B8 F30F7F0A            <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  4048                              <3>  %assign block block+1
  4049 000006BC F30F7F5210          <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  4050                              <3>  %assign block block+1
  4051 000006C1 F30F7F5A20          <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  4052                              <3>  %assign block block+1
  4053 000006C6 F30F7F6230          <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  4054                              <3>  %assign block block+1
  4055 000006CB F30F7F6A40          <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  4056                              <3>  %assign block block+1
  4057 000006D0 F30F7F7250          <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  4058                              <3>  %assign block block+1
  4059 000006D5 F30F7F7A60          <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  4060                              <3>  %assign block block+1
  4061 000006DA F3440F7F4270        <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  4062                              <3>  %assign block block+1
  4063 000006E0 F3440F7F8A80000000  <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  4064                              <3>  %assign block block+1
  4065 000006E9 F3440F7F9290000000  <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  4066                              <3>  %assign block block+1
  4067 000006F2 F3440F7F9AA0000000  <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  4068                              <3>  %assign block block+1
  4069 000006FB F3440F7FA2B0000000  <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  4070                              <3>  %assign block block+1
  4071 00000704 F3440F7FAAC0000000  <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  4072                              <3>  %assign block block+1
  4073 0000070D F3440F7FB2D0000000  <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  4074                              <3>  %assign block block+1
  4075 00000716 F3440F7FBAE0000000  <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  4076                              <3>  %assign block block+1
  4077                              <2> 
  4078                              <2>  %undef OPERATION
  4079                              <2>  %undef BLOCK_COUNT
  4080                              <1> 
  4081 0000071F 4881C2F0000000      <1>  add Rdx, 16 * MAX_REG_BLOCK_COUNT
  4082 00000726 FFC8                <1>  dec eax
  4083 00000728 0F85F6F9FFFF        <1>  jnz .1
  4084                              <1> 
  4085                              <1>  %if (32 % MAX_REG_BLOCK_COUNT) != 0
  4086                              <1>  aes_hw_cpu OPERATION_32_BLOCKS, (32 % MAX_REG_BLOCK_COUNT)
  4087                              <2>  %define OPERATION %1
  4088                              <2>  %define BLOCK_COUNT %2
  4089                              <2> 
  4090                              <2> 
  4091                              <2>  %assign block 1
  4092                              <2>  %rep BLOCK_COUNT
  4093                              <2>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  4094                              <2>  %assign block block+1
  4095                              <2>  %endrep
  4096 0000072E F30F6F0A            <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  4097                              <3>  %assign block block+1
  4098 00000732 F30F6F5210          <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  4099                              <3>  %assign block block+1
  4100                              <2> 
  4101                              <2> 
  4102                              <2>  %assign round 0
  4103                              <2>  %rep 15
  4104                              <2>  movdqu xmm0, [Rcx + 16 * round]
  4105                              <2> 
  4106                              <2>  %assign block 1
  4107                              <2>  %rep BLOCK_COUNT
  4108                              <2> 
  4109                              <2>  %if round = 0
  4110                              <2>  pxor xmmblock, xmm0
  4111                              <2>  %else
  4112                              <2>  %if round < 14
  4113                              <2>  aesOPERATION xmmblock, xmm0
  4114                              <2>  %else
  4115                              <2>  aesOPERATIONlast xmmblock, xmm0
  4116                              <2>  %endif
  4117                              <2>  %endif
  4118                              <2> 
  4119                              <2>  %assign block block+1
  4120                              <2>  %endrep
  4121                              <2> 
  4122                              <2>  %assign round round+1
  4123                              <2>  %endrep
  4124 00000737 F30F6F01            <3>  movdqu xmm0, [Rcx + 16 * round]
  4125                              <3> 
  4126                              <3>  %assign block 1
  4127                              <3>  %rep BLOCK_COUNT
  4128                              <3> 
  4129                              <3>  %if round = 0
  4130                              <3>  pxor xmmblock, xmm0
  4131                              <3>  %else
  4132                              <3>  %if round < 14
  4133                              <3>  aesOPERATION xmmblock, xmm0
  4134                              <3>  %else
  4135                              <3>  aesOPERATIONlast xmmblock, xmm0
  4136                              <3>  %endif
  4137                              <3>  %endif
  4138                              <3> 
  4139                              <3>  %assign block block+1
  4140                              <3>  %endrep
  4141                              <4> 
  4142                              <4>  %if round = 0
  4143 0000073B 660FEFC8            <4>  pxor xmmblock, xmm0
  4144                              <4>  %else
  4145                              <4>  %if round < 14
  4146                              <4>  aesOPERATION xmmblock, xmm0
  4147                              <4>  %else
  4148                              <4>  aesOPERATIONlast xmmblock, xmm0
  4149                              <4>  %endif
  4150                              <4>  %endif
  4151                              <4> 
  4152                              <4>  %assign block block+1
  4153                              <4> 
  4154                              <4>  %if round = 0
  4155 0000073F 660FEFD0            <4>  pxor xmmblock, xmm0
  4156                              <4>  %else
  4157                              <4>  %if round < 14
  4158                              <4>  aesOPERATION xmmblock, xmm0
  4159                              <4>  %else
  4160                              <4>  aesOPERATIONlast xmmblock, xmm0
  4161                              <4>  %endif
  4162                              <4>  %endif
  4163                              <4> 
  4164                              <4>  %assign block block+1
  4165                              <3> 
  4166                              <3>  %assign round round+1
  4167 00000743 F30F6F4110          <3>  movdqu xmm0, [Rcx + 16 * round]
  4168                              <3> 
  4169                              <3>  %assign block 1
  4170                              <3>  %rep BLOCK_COUNT
  4171                              <3> 
  4172                              <3>  %if round = 0
  4173                              <3>  pxor xmmblock, xmm0
  4174                              <3>  %else
  4175                              <3>  %if round < 14
  4176                              <3>  aesOPERATION xmmblock, xmm0
  4177                              <3>  %else
  4178                              <3>  aesOPERATIONlast xmmblock, xmm0
  4179                              <3>  %endif
  4180                              <3>  %endif
  4181                              <3> 
  4182                              <3>  %assign block block+1
  4183                              <3>  %endrep
  4184                              <4> 
  4185                              <4>  %if round = 0
  4186                              <4>  pxor xmmblock, xmm0
  4187                              <4>  %else
  4188                              <4>  %if round < 14
  4189 00000748 660F38DEC8          <4>  aesOPERATION xmmblock, xmm0
  4190                              <4>  %else
  4191                              <4>  aesOPERATIONlast xmmblock, xmm0
  4192                              <4>  %endif
  4193                              <4>  %endif
  4194                              <4> 
  4195                              <4>  %assign block block+1
  4196                              <4> 
  4197                              <4>  %if round = 0
  4198                              <4>  pxor xmmblock, xmm0
  4199                              <4>  %else
  4200                              <4>  %if round < 14
  4201 0000074D 660F38DED0          <4>  aesOPERATION xmmblock, xmm0
  4202                              <4>  %else
  4203                              <4>  aesOPERATIONlast xmmblock, xmm0
  4204                              <4>  %endif
  4205                              <4>  %endif
  4206                              <4> 
  4207                              <4>  %assign block block+1
  4208                              <3> 
  4209                              <3>  %assign round round+1
  4210 00000752 F30F6F4120          <3>  movdqu xmm0, [Rcx + 16 * round]
  4211                              <3> 
  4212                              <3>  %assign block 1
  4213                              <3>  %rep BLOCK_COUNT
  4214                              <3> 
  4215                              <3>  %if round = 0
  4216                              <3>  pxor xmmblock, xmm0
  4217                              <3>  %else
  4218                              <3>  %if round < 14
  4219                              <3>  aesOPERATION xmmblock, xmm0
  4220                              <3>  %else
  4221                              <3>  aesOPERATIONlast xmmblock, xmm0
  4222                              <3>  %endif
  4223                              <3>  %endif
  4224                              <3> 
  4225                              <3>  %assign block block+1
  4226                              <3>  %endrep
  4227                              <4> 
  4228                              <4>  %if round = 0
  4229                              <4>  pxor xmmblock, xmm0
  4230                              <4>  %else
  4231                              <4>  %if round < 14
  4232 00000757 660F38DEC8          <4>  aesOPERATION xmmblock, xmm0
  4233                              <4>  %else
  4234                              <4>  aesOPERATIONlast xmmblock, xmm0
  4235                              <4>  %endif
  4236                              <4>  %endif
  4237                              <4> 
  4238                              <4>  %assign block block+1
  4239                              <4> 
  4240                              <4>  %if round = 0
  4241                              <4>  pxor xmmblock, xmm0
  4242                              <4>  %else
  4243                              <4>  %if round < 14
  4244 0000075C 660F38DED0          <4>  aesOPERATION xmmblock, xmm0
  4245                              <4>  %else
  4246                              <4>  aesOPERATIONlast xmmblock, xmm0
  4247                              <4>  %endif
  4248                              <4>  %endif
  4249                              <4> 
  4250                              <4>  %assign block block+1
  4251                              <3> 
  4252                              <3>  %assign round round+1
  4253 00000761 F30F6F4130          <3>  movdqu xmm0, [Rcx + 16 * round]
  4254                              <3> 
  4255                              <3>  %assign block 1
  4256                              <3>  %rep BLOCK_COUNT
  4257                              <3> 
  4258                              <3>  %if round = 0
  4259                              <3>  pxor xmmblock, xmm0
  4260                              <3>  %else
  4261                              <3>  %if round < 14
  4262                              <3>  aesOPERATION xmmblock, xmm0
  4263                              <3>  %else
  4264                              <3>  aesOPERATIONlast xmmblock, xmm0
  4265                              <3>  %endif
  4266                              <3>  %endif
  4267                              <3> 
  4268                              <3>  %assign block block+1
  4269                              <3>  %endrep
  4270                              <4> 
  4271                              <4>  %if round = 0
  4272                              <4>  pxor xmmblock, xmm0
  4273                              <4>  %else
  4274                              <4>  %if round < 14
  4275 00000766 660F38DEC8          <4>  aesOPERATION xmmblock, xmm0
  4276                              <4>  %else
  4277                              <4>  aesOPERATIONlast xmmblock, xmm0
  4278                              <4>  %endif
  4279                              <4>  %endif
  4280                              <4> 
  4281                              <4>  %assign block block+1
  4282                              <4> 
  4283                              <4>  %if round = 0
  4284                              <4>  pxor xmmblock, xmm0
  4285                              <4>  %else
  4286                              <4>  %if round < 14
  4287 0000076B 660F38DED0          <4>  aesOPERATION xmmblock, xmm0
  4288                              <4>  %else
  4289                              <4>  aesOPERATIONlast xmmblock, xmm0
  4290                              <4>  %endif
  4291                              <4>  %endif
  4292                              <4> 
  4293                              <4>  %assign block block+1
  4294                              <3> 
  4295                              <3>  %assign round round+1
  4296 00000770 F30F6F4140          <3>  movdqu xmm0, [Rcx + 16 * round]
  4297                              <3> 
  4298                              <3>  %assign block 1
  4299                              <3>  %rep BLOCK_COUNT
  4300                              <3> 
  4301                              <3>  %if round = 0
  4302                              <3>  pxor xmmblock, xmm0
  4303                              <3>  %else
  4304                              <3>  %if round < 14
  4305                              <3>  aesOPERATION xmmblock, xmm0
  4306                              <3>  %else
  4307                              <3>  aesOPERATIONlast xmmblock, xmm0
  4308                              <3>  %endif
  4309                              <3>  %endif
  4310                              <3> 
  4311                              <3>  %assign block block+1
  4312                              <3>  %endrep
  4313                              <4> 
  4314                              <4>  %if round = 0
  4315                              <4>  pxor xmmblock, xmm0
  4316                              <4>  %else
  4317                              <4>  %if round < 14
  4318 00000775 660F38DEC8          <4>  aesOPERATION xmmblock, xmm0
  4319                              <4>  %else
  4320                              <4>  aesOPERATIONlast xmmblock, xmm0
  4321                              <4>  %endif
  4322                              <4>  %endif
  4323                              <4> 
  4324                              <4>  %assign block block+1
  4325                              <4> 
  4326                              <4>  %if round = 0
  4327                              <4>  pxor xmmblock, xmm0
  4328                              <4>  %else
  4329                              <4>  %if round < 14
  4330 0000077A 660F38DED0          <4>  aesOPERATION xmmblock, xmm0
  4331                              <4>  %else
  4332                              <4>  aesOPERATIONlast xmmblock, xmm0
  4333                              <4>  %endif
  4334                              <4>  %endif
  4335                              <4> 
  4336                              <4>  %assign block block+1
  4337                              <3> 
  4338                              <3>  %assign round round+1
  4339 0000077F F30F6F4150          <3>  movdqu xmm0, [Rcx + 16 * round]
  4340                              <3> 
  4341                              <3>  %assign block 1
  4342                              <3>  %rep BLOCK_COUNT
  4343                              <3> 
  4344                              <3>  %if round = 0
  4345                              <3>  pxor xmmblock, xmm0
  4346                              <3>  %else
  4347                              <3>  %if round < 14
  4348                              <3>  aesOPERATION xmmblock, xmm0
  4349                              <3>  %else
  4350                              <3>  aesOPERATIONlast xmmblock, xmm0
  4351                              <3>  %endif
  4352                              <3>  %endif
  4353                              <3> 
  4354                              <3>  %assign block block+1
  4355                              <3>  %endrep
  4356                              <4> 
  4357                              <4>  %if round = 0
  4358                              <4>  pxor xmmblock, xmm0
  4359                              <4>  %else
  4360                              <4>  %if round < 14
  4361 00000784 660F38DEC8          <4>  aesOPERATION xmmblock, xmm0
  4362                              <4>  %else
  4363                              <4>  aesOPERATIONlast xmmblock, xmm0
  4364                              <4>  %endif
  4365                              <4>  %endif
  4366                              <4> 
  4367                              <4>  %assign block block+1
  4368                              <4> 
  4369                              <4>  %if round = 0
  4370                              <4>  pxor xmmblock, xmm0
  4371                              <4>  %else
  4372                              <4>  %if round < 14
  4373 00000789 660F38DED0          <4>  aesOPERATION xmmblock, xmm0
  4374                              <4>  %else
  4375                              <4>  aesOPERATIONlast xmmblock, xmm0
  4376                              <4>  %endif
  4377                              <4>  %endif
  4378                              <4> 
  4379                              <4>  %assign block block+1
  4380                              <3> 
  4381                              <3>  %assign round round+1
  4382 0000078E F30F6F4160          <3>  movdqu xmm0, [Rcx + 16 * round]
  4383                              <3> 
  4384                              <3>  %assign block 1
  4385                              <3>  %rep BLOCK_COUNT
  4386                              <3> 
  4387                              <3>  %if round = 0
  4388                              <3>  pxor xmmblock, xmm0
  4389                              <3>  %else
  4390                              <3>  %if round < 14
  4391                              <3>  aesOPERATION xmmblock, xmm0
  4392                              <3>  %else
  4393                              <3>  aesOPERATIONlast xmmblock, xmm0
  4394                              <3>  %endif
  4395                              <3>  %endif
  4396                              <3> 
  4397                              <3>  %assign block block+1
  4398                              <3>  %endrep
  4399                              <4> 
  4400                              <4>  %if round = 0
  4401                              <4>  pxor xmmblock, xmm0
  4402                              <4>  %else
  4403                              <4>  %if round < 14
  4404 00000793 660F38DEC8          <4>  aesOPERATION xmmblock, xmm0
  4405                              <4>  %else
  4406                              <4>  aesOPERATIONlast xmmblock, xmm0
  4407                              <4>  %endif
  4408                              <4>  %endif
  4409                              <4> 
  4410                              <4>  %assign block block+1
  4411                              <4> 
  4412                              <4>  %if round = 0
  4413                              <4>  pxor xmmblock, xmm0
  4414                              <4>  %else
  4415                              <4>  %if round < 14
  4416 00000798 660F38DED0          <4>  aesOPERATION xmmblock, xmm0
  4417                              <4>  %else
  4418                              <4>  aesOPERATIONlast xmmblock, xmm0
  4419                              <4>  %endif
  4420                              <4>  %endif
  4421                              <4> 
  4422                              <4>  %assign block block+1
  4423                              <3> 
  4424                              <3>  %assign round round+1
  4425 0000079D F30F6F4170          <3>  movdqu xmm0, [Rcx + 16 * round]
  4426                              <3> 
  4427                              <3>  %assign block 1
  4428                              <3>  %rep BLOCK_COUNT
  4429                              <3> 
  4430                              <3>  %if round = 0
  4431                              <3>  pxor xmmblock, xmm0
  4432                              <3>  %else
  4433                              <3>  %if round < 14
  4434                              <3>  aesOPERATION xmmblock, xmm0
  4435                              <3>  %else
  4436                              <3>  aesOPERATIONlast xmmblock, xmm0
  4437                              <3>  %endif
  4438                              <3>  %endif
  4439                              <3> 
  4440                              <3>  %assign block block+1
  4441                              <3>  %endrep
  4442                              <4> 
  4443                              <4>  %if round = 0
  4444                              <4>  pxor xmmblock, xmm0
  4445                              <4>  %else
  4446                              <4>  %if round < 14
  4447 000007A2 660F38DEC8          <4>  aesOPERATION xmmblock, xmm0
  4448                              <4>  %else
  4449                              <4>  aesOPERATIONlast xmmblock, xmm0
  4450                              <4>  %endif
  4451                              <4>  %endif
  4452                              <4> 
  4453                              <4>  %assign block block+1
  4454                              <4> 
  4455                              <4>  %if round = 0
  4456                              <4>  pxor xmmblock, xmm0
  4457                              <4>  %else
  4458                              <4>  %if round < 14
  4459 000007A7 660F38DED0          <4>  aesOPERATION xmmblock, xmm0
  4460                              <4>  %else
  4461                              <4>  aesOPERATIONlast xmmblock, xmm0
  4462                              <4>  %endif
  4463                              <4>  %endif
  4464                              <4> 
  4465                              <4>  %assign block block+1
  4466                              <3> 
  4467                              <3>  %assign round round+1
  4468 000007AC F30F6F8180000000    <3>  movdqu xmm0, [Rcx + 16 * round]
  4469                              <3> 
  4470                              <3>  %assign block 1
  4471                              <3>  %rep BLOCK_COUNT
  4472                              <3> 
  4473                              <3>  %if round = 0
  4474                              <3>  pxor xmmblock, xmm0
  4475                              <3>  %else
  4476                              <3>  %if round < 14
  4477                              <3>  aesOPERATION xmmblock, xmm0
  4478                              <3>  %else
  4479                              <3>  aesOPERATIONlast xmmblock, xmm0
  4480                              <3>  %endif
  4481                              <3>  %endif
  4482                              <3> 
  4483                              <3>  %assign block block+1
  4484                              <3>  %endrep
  4485                              <4> 
  4486                              <4>  %if round = 0
  4487                              <4>  pxor xmmblock, xmm0
  4488                              <4>  %else
  4489                              <4>  %if round < 14
  4490 000007B4 660F38DEC8          <4>  aesOPERATION xmmblock, xmm0
  4491                              <4>  %else
  4492                              <4>  aesOPERATIONlast xmmblock, xmm0
  4493                              <4>  %endif
  4494                              <4>  %endif
  4495                              <4> 
  4496                              <4>  %assign block block+1
  4497                              <4> 
  4498                              <4>  %if round = 0
  4499                              <4>  pxor xmmblock, xmm0
  4500                              <4>  %else
  4501                              <4>  %if round < 14
  4502 000007B9 660F38DED0          <4>  aesOPERATION xmmblock, xmm0
  4503                              <4>  %else
  4504                              <4>  aesOPERATIONlast xmmblock, xmm0
  4505                              <4>  %endif
  4506                              <4>  %endif
  4507                              <4> 
  4508                              <4>  %assign block block+1
  4509                              <3> 
  4510                              <3>  %assign round round+1
  4511 000007BE F30F6F8190000000    <3>  movdqu xmm0, [Rcx + 16 * round]
  4512                              <3> 
  4513                              <3>  %assign block 1
  4514                              <3>  %rep BLOCK_COUNT
  4515                              <3> 
  4516                              <3>  %if round = 0
  4517                              <3>  pxor xmmblock, xmm0
  4518                              <3>  %else
  4519                              <3>  %if round < 14
  4520                              <3>  aesOPERATION xmmblock, xmm0
  4521                              <3>  %else
  4522                              <3>  aesOPERATIONlast xmmblock, xmm0
  4523                              <3>  %endif
  4524                              <3>  %endif
  4525                              <3> 
  4526                              <3>  %assign block block+1
  4527                              <3>  %endrep
  4528                              <4> 
  4529                              <4>  %if round = 0
  4530                              <4>  pxor xmmblock, xmm0
  4531                              <4>  %else
  4532                              <4>  %if round < 14
  4533 000007C6 660F38DEC8          <4>  aesOPERATION xmmblock, xmm0
  4534                              <4>  %else
  4535                              <4>  aesOPERATIONlast xmmblock, xmm0
  4536                              <4>  %endif
  4537                              <4>  %endif
  4538                              <4> 
  4539                              <4>  %assign block block+1
  4540                              <4> 
  4541                              <4>  %if round = 0
  4542                              <4>  pxor xmmblock, xmm0
  4543                              <4>  %else
  4544                              <4>  %if round < 14
  4545 000007CB 660F38DED0          <4>  aesOPERATION xmmblock, xmm0
  4546                              <4>  %else
  4547                              <4>  aesOPERATIONlast xmmblock, xmm0
  4548                              <4>  %endif
  4549                              <4>  %endif
  4550                              <4> 
  4551                              <4>  %assign block block+1
  4552                              <3> 
  4553                              <3>  %assign round round+1
  4554 000007D0 F30F6F81A0000000    <3>  movdqu xmm0, [Rcx + 16 * round]
  4555                              <3> 
  4556                              <3>  %assign block 1
  4557                              <3>  %rep BLOCK_COUNT
  4558                              <3> 
  4559                              <3>  %if round = 0
  4560                              <3>  pxor xmmblock, xmm0
  4561                              <3>  %else
  4562                              <3>  %if round < 14
  4563                              <3>  aesOPERATION xmmblock, xmm0
  4564                              <3>  %else
  4565                              <3>  aesOPERATIONlast xmmblock, xmm0
  4566                              <3>  %endif
  4567                              <3>  %endif
  4568                              <3> 
  4569                              <3>  %assign block block+1
  4570                              <3>  %endrep
  4571                              <4> 
  4572                              <4>  %if round = 0
  4573                              <4>  pxor xmmblock, xmm0
  4574                              <4>  %else
  4575                              <4>  %if round < 14
  4576 000007D8 660F38DEC8          <4>  aesOPERATION xmmblock, xmm0
  4577                              <4>  %else
  4578                              <4>  aesOPERATIONlast xmmblock, xmm0
  4579                              <4>  %endif
  4580                              <4>  %endif
  4581                              <4> 
  4582                              <4>  %assign block block+1
  4583                              <4> 
  4584                              <4>  %if round = 0
  4585                              <4>  pxor xmmblock, xmm0
  4586                              <4>  %else
  4587                              <4>  %if round < 14
  4588 000007DD 660F38DED0          <4>  aesOPERATION xmmblock, xmm0
  4589                              <4>  %else
  4590                              <4>  aesOPERATIONlast xmmblock, xmm0
  4591                              <4>  %endif
  4592                              <4>  %endif
  4593                              <4> 
  4594                              <4>  %assign block block+1
  4595                              <3> 
  4596                              <3>  %assign round round+1
  4597 000007E2 F30F6F81B0000000    <3>  movdqu xmm0, [Rcx + 16 * round]
  4598                              <3> 
  4599                              <3>  %assign block 1
  4600                              <3>  %rep BLOCK_COUNT
  4601                              <3> 
  4602                              <3>  %if round = 0
  4603                              <3>  pxor xmmblock, xmm0
  4604                              <3>  %else
  4605                              <3>  %if round < 14
  4606                              <3>  aesOPERATION xmmblock, xmm0
  4607                              <3>  %else
  4608                              <3>  aesOPERATIONlast xmmblock, xmm0
  4609                              <3>  %endif
  4610                              <3>  %endif
  4611                              <3> 
  4612                              <3>  %assign block block+1
  4613                              <3>  %endrep
  4614                              <4> 
  4615                              <4>  %if round = 0
  4616                              <4>  pxor xmmblock, xmm0
  4617                              <4>  %else
  4618                              <4>  %if round < 14
  4619 000007EA 660F38DEC8          <4>  aesOPERATION xmmblock, xmm0
  4620                              <4>  %else
  4621                              <4>  aesOPERATIONlast xmmblock, xmm0
  4622                              <4>  %endif
  4623                              <4>  %endif
  4624                              <4> 
  4625                              <4>  %assign block block+1
  4626                              <4> 
  4627                              <4>  %if round = 0
  4628                              <4>  pxor xmmblock, xmm0
  4629                              <4>  %else
  4630                              <4>  %if round < 14
  4631 000007EF 660F38DED0          <4>  aesOPERATION xmmblock, xmm0
  4632                              <4>  %else
  4633                              <4>  aesOPERATIONlast xmmblock, xmm0
  4634                              <4>  %endif
  4635                              <4>  %endif
  4636                              <4> 
  4637                              <4>  %assign block block+1
  4638                              <3> 
  4639                              <3>  %assign round round+1
  4640 000007F4 F30F6F81C0000000    <3>  movdqu xmm0, [Rcx + 16 * round]
  4641                              <3> 
  4642                              <3>  %assign block 1
  4643                              <3>  %rep BLOCK_COUNT
  4644                              <3> 
  4645                              <3>  %if round = 0
  4646                              <3>  pxor xmmblock, xmm0
  4647                              <3>  %else
  4648                              <3>  %if round < 14
  4649                              <3>  aesOPERATION xmmblock, xmm0
  4650                              <3>  %else
  4651                              <3>  aesOPERATIONlast xmmblock, xmm0
  4652                              <3>  %endif
  4653                              <3>  %endif
  4654                              <3> 
  4655                              <3>  %assign block block+1
  4656                              <3>  %endrep
  4657                              <4> 
  4658                              <4>  %if round = 0
  4659                              <4>  pxor xmmblock, xmm0
  4660                              <4>  %else
  4661                              <4>  %if round < 14
  4662 000007FC 660F38DEC8          <4>  aesOPERATION xmmblock, xmm0
  4663                              <4>  %else
  4664                              <4>  aesOPERATIONlast xmmblock, xmm0
  4665                              <4>  %endif
  4666                              <4>  %endif
  4667                              <4> 
  4668                              <4>  %assign block block+1
  4669                              <4> 
  4670                              <4>  %if round = 0
  4671                              <4>  pxor xmmblock, xmm0
  4672                              <4>  %else
  4673                              <4>  %if round < 14
  4674 00000801 660F38DED0          <4>  aesOPERATION xmmblock, xmm0
  4675                              <4>  %else
  4676                              <4>  aesOPERATIONlast xmmblock, xmm0
  4677                              <4>  %endif
  4678                              <4>  %endif
  4679                              <4> 
  4680                              <4>  %assign block block+1
  4681                              <3> 
  4682                              <3>  %assign round round+1
  4683 00000806 F30F6F81D0000000    <3>  movdqu xmm0, [Rcx + 16 * round]
  4684                              <3> 
  4685                              <3>  %assign block 1
  4686                              <3>  %rep BLOCK_COUNT
  4687                              <3> 
  4688                              <3>  %if round = 0
  4689                              <3>  pxor xmmblock, xmm0
  4690                              <3>  %else
  4691                              <3>  %if round < 14
  4692                              <3>  aesOPERATION xmmblock, xmm0
  4693                              <3>  %else
  4694                              <3>  aesOPERATIONlast xmmblock, xmm0
  4695                              <3>  %endif
  4696                              <3>  %endif
  4697                              <3> 
  4698                              <3>  %assign block block+1
  4699                              <3>  %endrep
  4700                              <4> 
  4701                              <4>  %if round = 0
  4702                              <4>  pxor xmmblock, xmm0
  4703                              <4>  %else
  4704                              <4>  %if round < 14
  4705 0000080E 660F38DEC8          <4>  aesOPERATION xmmblock, xmm0
  4706                              <4>  %else
  4707                              <4>  aesOPERATIONlast xmmblock, xmm0
  4708                              <4>  %endif
  4709                              <4>  %endif
  4710                              <4> 
  4711                              <4>  %assign block block+1
  4712                              <4> 
  4713                              <4>  %if round = 0
  4714                              <4>  pxor xmmblock, xmm0
  4715                              <4>  %else
  4716                              <4>  %if round < 14
  4717 00000813 660F38DED0          <4>  aesOPERATION xmmblock, xmm0
  4718                              <4>  %else
  4719                              <4>  aesOPERATIONlast xmmblock, xmm0
  4720                              <4>  %endif
  4721                              <4>  %endif
  4722                              <4> 
  4723                              <4>  %assign block block+1
  4724                              <3> 
  4725                              <3>  %assign round round+1
  4726 00000818 F30F6F81E0000000    <3>  movdqu xmm0, [Rcx + 16 * round]
  4727                              <3> 
  4728                              <3>  %assign block 1
  4729                              <3>  %rep BLOCK_COUNT
  4730                              <3> 
  4731                              <3>  %if round = 0
  4732                              <3>  pxor xmmblock, xmm0
  4733                              <3>  %else
  4734                              <3>  %if round < 14
  4735                              <3>  aesOPERATION xmmblock, xmm0
  4736                              <3>  %else
  4737                              <3>  aesOPERATIONlast xmmblock, xmm0
  4738                              <3>  %endif
  4739                              <3>  %endif
  4740                              <3> 
  4741                              <3>  %assign block block+1
  4742                              <3>  %endrep
  4743                              <4> 
  4744                              <4>  %if round = 0
  4745                              <4>  pxor xmmblock, xmm0
  4746                              <4>  %else
  4747                              <4>  %if round < 14
  4748                              <4>  aesOPERATION xmmblock, xmm0
  4749                              <4>  %else
  4750 00000820 660F38DFC8          <4>  aesOPERATIONlast xmmblock, xmm0
  4751                              <4>  %endif
  4752                              <4>  %endif
  4753                              <4> 
  4754                              <4>  %assign block block+1
  4755                              <4> 
  4756                              <4>  %if round = 0
  4757                              <4>  pxor xmmblock, xmm0
  4758                              <4>  %else
  4759                              <4>  %if round < 14
  4760                              <4>  aesOPERATION xmmblock, xmm0
  4761                              <4>  %else
  4762 00000825 660F38DFD0          <4>  aesOPERATIONlast xmmblock, xmm0
  4763                              <4>  %endif
  4764                              <4>  %endif
  4765                              <4> 
  4766                              <4>  %assign block block+1
  4767                              <3> 
  4768                              <3>  %assign round round+1
  4769                              <2> 
  4770                              <2> 
  4771                              <2>  %assign block 1
  4772                              <2>  %rep BLOCK_COUNT
  4773                              <2>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  4774                              <2>  %assign block block+1
  4775                              <2>  %endrep
  4776 0000082A F30F7F0A            <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  4777                              <3>  %assign block block+1
  4778 0000082E F30F7F5210          <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  4779                              <3>  %assign block block+1
  4780                              <2> 
  4781                              <2>  %undef OPERATION
  4782                              <2>  %undef BLOCK_COUNT
  4783                              <1>  %endif
  4784                              <1> 
  4785                              <1>  %ifidn __OUTPUT_FORMAT__, win64
  4786                              <1>  %if MAX_REG_BLOCK_COUNT > 5
  4787                              <1>  pop_xmm 6, MAX_REG_BLOCK_COUNT
  4788                              <2>  %assign stackoffset 0
  4789                              <2>  %assign regnumber %1
  4790                              <2> 
  4791                              <2>  %rep (%2 - %1 + 1)
  4792                              <2>  movdqu xmmregnumber, [rsp + 16 * stackoffset]
  4793                              <2> 
  4794                              <2>  %assign stackoffset stackoffset+1
  4795                              <2>  %assign regnumber regnumber+1
  4796                              <2>  %endrep
  4797 00000833 F30F6F3424          <3>  movdqu xmmregnumber, [rsp + 16 * stackoffset]
  4798                              <3> 
  4799                              <3>  %assign stackoffset stackoffset+1
  4800                              <3>  %assign regnumber regnumber+1
  4801 00000838 F30F6F7C2410        <3>  movdqu xmmregnumber, [rsp + 16 * stackoffset]
  4802                              <3> 
  4803                              <3>  %assign stackoffset stackoffset+1
  4804                              <3>  %assign regnumber regnumber+1
  4805 0000083E F3440F6F442420      <3>  movdqu xmmregnumber, [rsp + 16 * stackoffset]
  4806                              <3> 
  4807                              <3>  %assign stackoffset stackoffset+1
  4808                              <3>  %assign regnumber regnumber+1
  4809 00000845 F3440F6F4C2430      <3>  movdqu xmmregnumber, [rsp + 16 * stackoffset]
  4810                              <3> 
  4811                              <3>  %assign stackoffset stackoffset+1
  4812                              <3>  %assign regnumber regnumber+1
  4813 0000084C F3440F6F542440      <3>  movdqu xmmregnumber, [rsp + 16 * stackoffset]
  4814                              <3> 
  4815                              <3>  %assign stackoffset stackoffset+1
  4816                              <3>  %assign regnumber regnumber+1
  4817 00000853 F3440F6F5C2450      <3>  movdqu xmmregnumber, [rsp + 16 * stackoffset]
  4818                              <3> 
  4819                              <3>  %assign stackoffset stackoffset+1
  4820                              <3>  %assign regnumber regnumber+1
  4821 0000085A F3440F6F642460      <3>  movdqu xmmregnumber, [rsp + 16 * stackoffset]
  4822                              <3> 
  4823                              <3>  %assign stackoffset stackoffset+1
  4824                              <3>  %assign regnumber regnumber+1
  4825 00000861 F3440F6F6C2470      <3>  movdqu xmmregnumber, [rsp + 16 * stackoffset]
  4826                              <3> 
  4827                              <3>  %assign stackoffset stackoffset+1
  4828                              <3>  %assign regnumber regnumber+1
  4829 00000868 F3440F6FB424800000- <3>  movdqu xmmregnumber, [rsp + 16 * stackoffset]
  4830 00000871 00                  <3>
  4831                              <3> 
  4832                              <3>  %assign stackoffset stackoffset+1
  4833                              <3>  %assign regnumber regnumber+1
  4834 00000872 F3440F6FBC24900000- <3>  movdqu xmmregnumber, [rsp + 16 * stackoffset]
  4835 0000087B 00                  <3>
  4836                              <3> 
  4837                              <3>  %assign stackoffset stackoffset+1
  4838                              <3>  %assign regnumber regnumber+1
  4839                              <2> 
  4840 0000087C 4881C4A0000000      <2>  add rsp, 16 * (%2 - %1 + 1)
  4841                              <1>  %endif
  4842                              <1>  %endif
  4843                              <1> 
  4844                              <1>  %undef OPERATION_32_BLOCKS
  4845                              <1>  %undef MAX_REG_BLOCK_COUNT
  4846                                  	aes_function_exit
  4847                              <1> 
  4848                              <1> 
  4849                              <1> 
  4850                              <1>  %ifdef MS_STDCALL
  4851                              <1>  ret 8
  4852                              <1>  %else
  4853 00000883 C3                  <1>  ret
  4854                              <1>  %endif
  4855                              <1> 
  4856                                  
  4857                                  
  4858                                  ; void aes_hw_cpu_encrypt (const byte *ks, byte *data);
  4859                                  
  4860                                  	aes_function_entry aes_hw_cpu_encrypt
  4861                              <1> 
  4862                              <1> 
  4863                              <1> 
  4864                              <1>  export_function %1, 8
  4865                              <2> 
  4866                              <2>  %ifdef MS_STDCALL
  4867                              <2>  global %1@%2
  4868                              <2>  export _%1@%2
  4869                              <2>  %1@%2:
  4870                              <2>  %elifidn __BITS__, 16
  4871                              <2>  global _%1
  4872                              <2>  _%1:
  4873                              <2>  %else
  4874                              <2>  global %1
  4875                              <2>  %1:
  4876                              <2>  %endif
  4877                              <2> 
  4878                              <1> 
  4879                              <1>  %ifidn __BITS__, 32
  4880                              <1>  mov ecx, [esp + 4 + 4 * 0]
  4881                              <1>  mov edx, [esp + 4 + 4 * 1]
  4882                              <1>  %elifidn __BITS__, 64
  4883                              <1>  %ifnidn __OUTPUT_FORMAT__, win64
  4884                              <1>  mov rcx, rdi
  4885                              <1>  mov rdx, rsi
  4886                              <1>  %endif
  4887                              <1>  %endif
  4888                              <1> 
  4889                              <1> 
  4890                              <1> 
  4891                              <1> 
  4892                                  		aes_hw_cpu enc, 1
  4893                              <1>  %define OPERATION %1
  4894                              <1>  %define BLOCK_COUNT %2
  4895                              <1> 
  4896                              <1> 
  4897                              <1>  %assign block 1
  4898                              <1>  %rep BLOCK_COUNT
  4899                              <1>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  4900                              <1>  %assign block block+1
  4901                              <1>  %endrep
  4902 00000884 F30F6F0A            <2>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  4903                              <2>  %assign block block+1
  4904                              <1> 
  4905                              <1> 
  4906                              <1>  %assign round 0
  4907                              <1>  %rep 15
  4908                              <1>  movdqu xmm0, [Rcx + 16 * round]
  4909                              <1> 
  4910                              <1>  %assign block 1
  4911                              <1>  %rep BLOCK_COUNT
  4912                              <1> 
  4913                              <1>  %if round = 0
  4914                              <1>  pxor xmmblock, xmm0
  4915                              <1>  %else
  4916                              <1>  %if round < 14
  4917                              <1>  aesOPERATION xmmblock, xmm0
  4918                              <1>  %else
  4919                              <1>  aesOPERATIONlast xmmblock, xmm0
  4920                              <1>  %endif
  4921                              <1>  %endif
  4922                              <1> 
  4923                              <1>  %assign block block+1
  4924                              <1>  %endrep
  4925                              <1> 
  4926                              <1>  %assign round round+1
  4927                              <1>  %endrep
  4928 00000888 F30F6F01            <2>  movdqu xmm0, [Rcx + 16 * round]
  4929                              <2> 
  4930                              <2>  %assign block 1
  4931                              <2>  %rep BLOCK_COUNT
  4932                              <2> 
  4933                              <2>  %if round = 0
  4934                              <2>  pxor xmmblock, xmm0
  4935                              <2>  %else
  4936                              <2>  %if round < 14
  4937                              <2>  aesOPERATION xmmblock, xmm0
  4938                              <2>  %else
  4939                              <2>  aesOPERATIONlast xmmblock, xmm0
  4940                              <2>  %endif
  4941                              <2>  %endif
  4942                              <2> 
  4943                              <2>  %assign block block+1
  4944                              <2>  %endrep
  4945                              <3> 
  4946                              <3>  %if round = 0
  4947 0000088C 660FEFC8            <3>  pxor xmmblock, xmm0
  4948                              <3>  %else
  4949                              <3>  %if round < 14
  4950                              <3>  aesOPERATION xmmblock, xmm0
  4951                              <3>  %else
  4952                              <3>  aesOPERATIONlast xmmblock, xmm0
  4953                              <3>  %endif
  4954                              <3>  %endif
  4955                              <3> 
  4956                              <3>  %assign block block+1
  4957                              <2> 
  4958                              <2>  %assign round round+1
  4959 00000890 F30F6F4110          <2>  movdqu xmm0, [Rcx + 16 * round]
  4960                              <2> 
  4961                              <2>  %assign block 1
  4962                              <2>  %rep BLOCK_COUNT
  4963                              <2> 
  4964                              <2>  %if round = 0
  4965                              <2>  pxor xmmblock, xmm0
  4966                              <2>  %else
  4967                              <2>  %if round < 14
  4968                              <2>  aesOPERATION xmmblock, xmm0
  4969                              <2>  %else
  4970                              <2>  aesOPERATIONlast xmmblock, xmm0
  4971                              <2>  %endif
  4972                              <2>  %endif
  4973                              <2> 
  4974                              <2>  %assign block block+1
  4975                              <2>  %endrep
  4976                              <3> 
  4977                              <3>  %if round = 0
  4978                              <3>  pxor xmmblock, xmm0
  4979                              <3>  %else
  4980                              <3>  %if round < 14
  4981 00000895 660F38DCC8          <3>  aesOPERATION xmmblock, xmm0
  4982                              <3>  %else
  4983                              <3>  aesOPERATIONlast xmmblock, xmm0
  4984                              <3>  %endif
  4985                              <3>  %endif
  4986                              <3> 
  4987                              <3>  %assign block block+1
  4988                              <2> 
  4989                              <2>  %assign round round+1
  4990 0000089A F30F6F4120          <2>  movdqu xmm0, [Rcx + 16 * round]
  4991                              <2> 
  4992                              <2>  %assign block 1
  4993                              <2>  %rep BLOCK_COUNT
  4994                              <2> 
  4995                              <2>  %if round = 0
  4996                              <2>  pxor xmmblock, xmm0
  4997                              <2>  %else
  4998                              <2>  %if round < 14
  4999                              <2>  aesOPERATION xmmblock, xmm0
  5000                              <2>  %else
  5001                              <2>  aesOPERATIONlast xmmblock, xmm0
  5002                              <2>  %endif
  5003                              <2>  %endif
  5004                              <2> 
  5005                              <2>  %assign block block+1
  5006                              <2>  %endrep
  5007                              <3> 
  5008                              <3>  %if round = 0
  5009                              <3>  pxor xmmblock, xmm0
  5010                              <3>  %else
  5011                              <3>  %if round < 14
  5012 0000089F 660F38DCC8          <3>  aesOPERATION xmmblock, xmm0
  5013                              <3>  %else
  5014                              <3>  aesOPERATIONlast xmmblock, xmm0
  5015                              <3>  %endif
  5016                              <3>  %endif
  5017                              <3> 
  5018                              <3>  %assign block block+1
  5019                              <2> 
  5020                              <2>  %assign round round+1
  5021 000008A4 F30F6F4130          <2>  movdqu xmm0, [Rcx + 16 * round]
  5022                              <2> 
  5023                              <2>  %assign block 1
  5024                              <2>  %rep BLOCK_COUNT
  5025                              <2> 
  5026                              <2>  %if round = 0
  5027                              <2>  pxor xmmblock, xmm0
  5028                              <2>  %else
  5029                              <2>  %if round < 14
  5030                              <2>  aesOPERATION xmmblock, xmm0
  5031                              <2>  %else
  5032                              <2>  aesOPERATIONlast xmmblock, xmm0
  5033                              <2>  %endif
  5034                              <2>  %endif
  5035                              <2> 
  5036                              <2>  %assign block block+1
  5037                              <2>  %endrep
  5038                              <3> 
  5039                              <3>  %if round = 0
  5040                              <3>  pxor xmmblock, xmm0
  5041                              <3>  %else
  5042                              <3>  %if round < 14
  5043 000008A9 660F38DCC8          <3>  aesOPERATION xmmblock, xmm0
  5044                              <3>  %else
  5045                              <3>  aesOPERATIONlast xmmblock, xmm0
  5046                              <3>  %endif
  5047                              <3>  %endif
  5048                              <3> 
  5049                              <3>  %assign block block+1
  5050                              <2> 
  5051                              <2>  %assign round round+1
  5052 000008AE F30F6F4140          <2>  movdqu xmm0, [Rcx + 16 * round]
  5053                              <2> 
  5054                              <2>  %assign block 1
  5055                              <2>  %rep BLOCK_COUNT
  5056                              <2> 
  5057                              <2>  %if round = 0
  5058                              <2>  pxor xmmblock, xmm0
  5059                              <2>  %else
  5060                              <2>  %if round < 14
  5061                              <2>  aesOPERATION xmmblock, xmm0
  5062                              <2>  %else
  5063                              <2>  aesOPERATIONlast xmmblock, xmm0
  5064                              <2>  %endif
  5065                              <2>  %endif
  5066                              <2> 
  5067                              <2>  %assign block block+1
  5068                              <2>  %endrep
  5069                              <3> 
  5070                              <3>  %if round = 0
  5071                              <3>  pxor xmmblock, xmm0
  5072                              <3>  %else
  5073                              <3>  %if round < 14
  5074 000008B3 660F38DCC8          <3>  aesOPERATION xmmblock, xmm0
  5075                              <3>  %else
  5076                              <3>  aesOPERATIONlast xmmblock, xmm0
  5077                              <3>  %endif
  5078                              <3>  %endif
  5079                              <3> 
  5080                              <3>  %assign block block+1
  5081                              <2> 
  5082                              <2>  %assign round round+1
  5083 000008B8 F30F6F4150          <2>  movdqu xmm0, [Rcx + 16 * round]
  5084                              <2> 
  5085                              <2>  %assign block 1
  5086                              <2>  %rep BLOCK_COUNT
  5087                              <2> 
  5088                              <2>  %if round = 0
  5089                              <2>  pxor xmmblock, xmm0
  5090                              <2>  %else
  5091                              <2>  %if round < 14
  5092                              <2>  aesOPERATION xmmblock, xmm0
  5093                              <2>  %else
  5094                              <2>  aesOPERATIONlast xmmblock, xmm0
  5095                              <2>  %endif
  5096                              <2>  %endif
  5097                              <2> 
  5098                              <2>  %assign block block+1
  5099                              <2>  %endrep
  5100                              <3> 
  5101                              <3>  %if round = 0
  5102                              <3>  pxor xmmblock, xmm0
  5103                              <3>  %else
  5104                              <3>  %if round < 14
  5105 000008BD 660F38DCC8          <3>  aesOPERATION xmmblock, xmm0
  5106                              <3>  %else
  5107                              <3>  aesOPERATIONlast xmmblock, xmm0
  5108                              <3>  %endif
  5109                              <3>  %endif
  5110                              <3> 
  5111                              <3>  %assign block block+1
  5112                              <2> 
  5113                              <2>  %assign round round+1
  5114 000008C2 F30F6F4160          <2>  movdqu xmm0, [Rcx + 16 * round]
  5115                              <2> 
  5116                              <2>  %assign block 1
  5117                              <2>  %rep BLOCK_COUNT
  5118                              <2> 
  5119                              <2>  %if round = 0
  5120                              <2>  pxor xmmblock, xmm0
  5121                              <2>  %else
  5122                              <2>  %if round < 14
  5123                              <2>  aesOPERATION xmmblock, xmm0
  5124                              <2>  %else
  5125                              <2>  aesOPERATIONlast xmmblock, xmm0
  5126                              <2>  %endif
  5127                              <2>  %endif
  5128                              <2> 
  5129                              <2>  %assign block block+1
  5130                              <2>  %endrep
  5131                              <3> 
  5132                              <3>  %if round = 0
  5133                              <3>  pxor xmmblock, xmm0
  5134                              <3>  %else
  5135                              <3>  %if round < 14
  5136 000008C7 660F38DCC8          <3>  aesOPERATION xmmblock, xmm0
  5137                              <3>  %else
  5138                              <3>  aesOPERATIONlast xmmblock, xmm0
  5139                              <3>  %endif
  5140                              <3>  %endif
  5141                              <3> 
  5142                              <3>  %assign block block+1
  5143                              <2> 
  5144                              <2>  %assign round round+1
  5145 000008CC F30F6F4170          <2>  movdqu xmm0, [Rcx + 16 * round]
  5146                              <2> 
  5147                              <2>  %assign block 1
  5148                              <2>  %rep BLOCK_COUNT
  5149                              <2> 
  5150                              <2>  %if round = 0
  5151                              <2>  pxor xmmblock, xmm0
  5152                              <2>  %else
  5153                              <2>  %if round < 14
  5154                              <2>  aesOPERATION xmmblock, xmm0
  5155                              <2>  %else
  5156                              <2>  aesOPERATIONlast xmmblock, xmm0
  5157                              <2>  %endif
  5158                              <2>  %endif
  5159                              <2> 
  5160                              <2>  %assign block block+1
  5161                              <2>  %endrep
  5162                              <3> 
  5163                              <3>  %if round = 0
  5164                              <3>  pxor xmmblock, xmm0
  5165                              <3>  %else
  5166                              <3>  %if round < 14
  5167 000008D1 660F38DCC8          <3>  aesOPERATION xmmblock, xmm0
  5168                              <3>  %else
  5169                              <3>  aesOPERATIONlast xmmblock, xmm0
  5170                              <3>  %endif
  5171                              <3>  %endif
  5172                              <3> 
  5173                              <3>  %assign block block+1
  5174                              <2> 
  5175                              <2>  %assign round round+1
  5176 000008D6 F30F6F8180000000    <2>  movdqu xmm0, [Rcx + 16 * round]
  5177                              <2> 
  5178                              <2>  %assign block 1
  5179                              <2>  %rep BLOCK_COUNT
  5180                              <2> 
  5181                              <2>  %if round = 0
  5182                              <2>  pxor xmmblock, xmm0
  5183                              <2>  %else
  5184                              <2>  %if round < 14
  5185                              <2>  aesOPERATION xmmblock, xmm0
  5186                              <2>  %else
  5187                              <2>  aesOPERATIONlast xmmblock, xmm0
  5188                              <2>  %endif
  5189                              <2>  %endif
  5190                              <2> 
  5191                              <2>  %assign block block+1
  5192                              <2>  %endrep
  5193                              <3> 
  5194                              <3>  %if round = 0
  5195                              <3>  pxor xmmblock, xmm0
  5196                              <3>  %else
  5197                              <3>  %if round < 14
  5198 000008DE 660F38DCC8          <3>  aesOPERATION xmmblock, xmm0
  5199                              <3>  %else
  5200                              <3>  aesOPERATIONlast xmmblock, xmm0
  5201                              <3>  %endif
  5202                              <3>  %endif
  5203                              <3> 
  5204                              <3>  %assign block block+1
  5205                              <2> 
  5206                              <2>  %assign round round+1
  5207 000008E3 F30F6F8190000000    <2>  movdqu xmm0, [Rcx + 16 * round]
  5208                              <2> 
  5209                              <2>  %assign block 1
  5210                              <2>  %rep BLOCK_COUNT
  5211                              <2> 
  5212                              <2>  %if round = 0
  5213                              <2>  pxor xmmblock, xmm0
  5214                              <2>  %else
  5215                              <2>  %if round < 14
  5216                              <2>  aesOPERATION xmmblock, xmm0
  5217                              <2>  %else
  5218                              <2>  aesOPERATIONlast xmmblock, xmm0
  5219                              <2>  %endif
  5220                              <2>  %endif
  5221                              <2> 
  5222                              <2>  %assign block block+1
  5223                              <2>  %endrep
  5224                              <3> 
  5225                              <3>  %if round = 0
  5226                              <3>  pxor xmmblock, xmm0
  5227                              <3>  %else
  5228                              <3>  %if round < 14
  5229 000008EB 660F38DCC8          <3>  aesOPERATION xmmblock, xmm0
  5230                              <3>  %else
  5231                              <3>  aesOPERATIONlast xmmblock, xmm0
  5232                              <3>  %endif
  5233                              <3>  %endif
  5234                              <3> 
  5235                              <3>  %assign block block+1
  5236                              <2> 
  5237                              <2>  %assign round round+1
  5238 000008F0 F30F6F81A0000000    <2>  movdqu xmm0, [Rcx + 16 * round]
  5239                              <2> 
  5240                              <2>  %assign block 1
  5241                              <2>  %rep BLOCK_COUNT
  5242                              <2> 
  5243                              <2>  %if round = 0
  5244                              <2>  pxor xmmblock, xmm0
  5245                              <2>  %else
  5246                              <2>  %if round < 14
  5247                              <2>  aesOPERATION xmmblock, xmm0
  5248                              <2>  %else
  5249                              <2>  aesOPERATIONlast xmmblock, xmm0
  5250                              <2>  %endif
  5251                              <2>  %endif
  5252                              <2> 
  5253                              <2>  %assign block block+1
  5254                              <2>  %endrep
  5255                              <3> 
  5256                              <3>  %if round = 0
  5257                              <3>  pxor xmmblock, xmm0
  5258                              <3>  %else
  5259                              <3>  %if round < 14
  5260 000008F8 660F38DCC8          <3>  aesOPERATION xmmblock, xmm0
  5261                              <3>  %else
  5262                              <3>  aesOPERATIONlast xmmblock, xmm0
  5263                              <3>  %endif
  5264                              <3>  %endif
  5265                              <3> 
  5266                              <3>  %assign block block+1
  5267                              <2> 
  5268                              <2>  %assign round round+1
  5269 000008FD F30F6F81B0000000    <2>  movdqu xmm0, [Rcx + 16 * round]
  5270                              <2> 
  5271                              <2>  %assign block 1
  5272                              <2>  %rep BLOCK_COUNT
  5273                              <2> 
  5274                              <2>  %if round = 0
  5275                              <2>  pxor xmmblock, xmm0
  5276                              <2>  %else
  5277                              <2>  %if round < 14
  5278                              <2>  aesOPERATION xmmblock, xmm0
  5279                              <2>  %else
  5280                              <2>  aesOPERATIONlast xmmblock, xmm0
  5281                              <2>  %endif
  5282                              <2>  %endif
  5283                              <2> 
  5284                              <2>  %assign block block+1
  5285                              <2>  %endrep
  5286                              <3> 
  5287                              <3>  %if round = 0
  5288                              <3>  pxor xmmblock, xmm0
  5289                              <3>  %else
  5290                              <3>  %if round < 14
  5291 00000905 660F38DCC8          <3>  aesOPERATION xmmblock, xmm0
  5292                              <3>  %else
  5293                              <3>  aesOPERATIONlast xmmblock, xmm0
  5294                              <3>  %endif
  5295                              <3>  %endif
  5296                              <3> 
  5297                              <3>  %assign block block+1
  5298                              <2> 
  5299                              <2>  %assign round round+1
  5300 0000090A F30F6F81C0000000    <2>  movdqu xmm0, [Rcx + 16 * round]
  5301                              <2> 
  5302                              <2>  %assign block 1
  5303                              <2>  %rep BLOCK_COUNT
  5304                              <2> 
  5305                              <2>  %if round = 0
  5306                              <2>  pxor xmmblock, xmm0
  5307                              <2>  %else
  5308                              <2>  %if round < 14
  5309                              <2>  aesOPERATION xmmblock, xmm0
  5310                              <2>  %else
  5311                              <2>  aesOPERATIONlast xmmblock, xmm0
  5312                              <2>  %endif
  5313                              <2>  %endif
  5314                              <2> 
  5315                              <2>  %assign block block+1
  5316                              <2>  %endrep
  5317                              <3> 
  5318                              <3>  %if round = 0
  5319                              <3>  pxor xmmblock, xmm0
  5320                              <3>  %else
  5321                              <3>  %if round < 14
  5322 00000912 660F38DCC8          <3>  aesOPERATION xmmblock, xmm0
  5323                              <3>  %else
  5324                              <3>  aesOPERATIONlast xmmblock, xmm0
  5325                              <3>  %endif
  5326                              <3>  %endif
  5327                              <3> 
  5328                              <3>  %assign block block+1
  5329                              <2> 
  5330                              <2>  %assign round round+1
  5331 00000917 F30F6F81D0000000    <2>  movdqu xmm0, [Rcx + 16 * round]
  5332                              <2> 
  5333                              <2>  %assign block 1
  5334                              <2>  %rep BLOCK_COUNT
  5335                              <2> 
  5336                              <2>  %if round = 0
  5337                              <2>  pxor xmmblock, xmm0
  5338                              <2>  %else
  5339                              <2>  %if round < 14
  5340                              <2>  aesOPERATION xmmblock, xmm0
  5341                              <2>  %else
  5342                              <2>  aesOPERATIONlast xmmblock, xmm0
  5343                              <2>  %endif
  5344                              <2>  %endif
  5345                              <2> 
  5346                              <2>  %assign block block+1
  5347                              <2>  %endrep
  5348                              <3> 
  5349                              <3>  %if round = 0
  5350                              <3>  pxor xmmblock, xmm0
  5351                              <3>  %else
  5352                              <3>  %if round < 14
  5353 0000091F 660F38DCC8          <3>  aesOPERATION xmmblock, xmm0
  5354                              <3>  %else
  5355                              <3>  aesOPERATIONlast xmmblock, xmm0
  5356                              <3>  %endif
  5357                              <3>  %endif
  5358                              <3> 
  5359                              <3>  %assign block block+1
  5360                              <2> 
  5361                              <2>  %assign round round+1
  5362 00000924 F30F6F81E0000000    <2>  movdqu xmm0, [Rcx + 16 * round]
  5363                              <2> 
  5364                              <2>  %assign block 1
  5365                              <2>  %rep BLOCK_COUNT
  5366                              <2> 
  5367                              <2>  %if round = 0
  5368                              <2>  pxor xmmblock, xmm0
  5369                              <2>  %else
  5370                              <2>  %if round < 14
  5371                              <2>  aesOPERATION xmmblock, xmm0
  5372                              <2>  %else
  5373                              <2>  aesOPERATIONlast xmmblock, xmm0
  5374                              <2>  %endif
  5375                              <2>  %endif
  5376                              <2> 
  5377                              <2>  %assign block block+1
  5378                              <2>  %endrep
  5379                              <3> 
  5380                              <3>  %if round = 0
  5381                              <3>  pxor xmmblock, xmm0
  5382                              <3>  %else
  5383                              <3>  %if round < 14
  5384                              <3>  aesOPERATION xmmblock, xmm0
  5385                              <3>  %else
  5386 0000092C 660F38DDC8          <3>  aesOPERATIONlast xmmblock, xmm0
  5387                              <3>  %endif
  5388                              <3>  %endif
  5389                              <3> 
  5390                              <3>  %assign block block+1
  5391                              <2> 
  5392                              <2>  %assign round round+1
  5393                              <1> 
  5394                              <1> 
  5395                              <1>  %assign block 1
  5396                              <1>  %rep BLOCK_COUNT
  5397                              <1>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  5398                              <1>  %assign block block+1
  5399                              <1>  %endrep
  5400 00000931 F30F7F0A            <2>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  5401                              <2>  %assign block block+1
  5402                              <1> 
  5403                              <1>  %undef OPERATION
  5404                              <1>  %undef BLOCK_COUNT
  5405                                  	aes_function_exit
  5406                              <1> 
  5407                              <1> 
  5408                              <1> 
  5409                              <1>  %ifdef MS_STDCALL
  5410                              <1>  ret 8
  5411                              <1>  %else
  5412 00000935 C3                  <1>  ret
  5413                              <1>  %endif
  5414                              <1> 
  5415                                  
  5416                                  
  5417                                  ; void aes_hw_cpu_encrypt_32_blocks (const byte *ks, byte *data);
  5418                                  
  5419                                  	aes_function_entry aes_hw_cpu_encrypt_32_blocks
  5420                              <1> 
  5421                              <1> 
  5422                              <1> 
  5423                              <1>  export_function %1, 8
  5424                              <2> 
  5425                              <2>  %ifdef MS_STDCALL
  5426                              <2>  global %1@%2
  5427                              <2>  export _%1@%2
  5428                              <2>  %1@%2:
  5429                              <2>  %elifidn __BITS__, 16
  5430                              <2>  global _%1
  5431                              <2>  _%1:
  5432                              <2>  %else
  5433                              <2>  global %1
  5434                              <2>  %1:
  5435                              <2>  %endif
  5436                              <2> 
  5437                              <1> 
  5438                              <1>  %ifidn __BITS__, 32
  5439                              <1>  mov ecx, [esp + 4 + 4 * 0]
  5440                              <1>  mov edx, [esp + 4 + 4 * 1]
  5441                              <1>  %elifidn __BITS__, 64
  5442                              <1>  %ifnidn __OUTPUT_FORMAT__, win64
  5443                              <1>  mov rcx, rdi
  5444                              <1>  mov rdx, rsi
  5445                              <1>  %endif
  5446                              <1>  %endif
  5447                              <1> 
  5448                              <1> 
  5449                              <1> 
  5450                              <1> 
  5451                                  		aes_hw_cpu_32_blocks enc
  5452                              <1>  %define OPERATION_32_BLOCKS %1
  5453                              <1> 
  5454                              <1>  %ifidn __BITS__, 64
  5455                              <1>  %define MAX_REG_BLOCK_COUNT 15
  5456                              <1>  %else
  5457                              <1>  %define MAX_REG_BLOCK_COUNT 7
  5458                              <1>  %endif
  5459                              <1> 
  5460                              <1>  %ifidn __OUTPUT_FORMAT__, win64
  5461                              <1>  %if MAX_REG_BLOCK_COUNT > 5
  5462                              <1>  push_xmm 6, MAX_REG_BLOCK_COUNT
  5463 00000936 4881ECA0000000      <2>  sub rsp, 16 * (%2 - %1 + 1)
  5464                              <2> 
  5465                              <2>  %assign stackoffset 0
  5466                              <2>  %assign regnumber %1
  5467                              <2> 
  5468                              <2>  %rep (%2 - %1 + 1)
  5469                              <2>  movdqu [rsp + 16 * stackoffset], xmmregnumber
  5470                              <2> 
  5471                              <2>  %assign stackoffset stackoffset+1
  5472                              <2>  %assign regnumber regnumber+1
  5473                              <2>  %endrep
  5474 0000093D F30F7F3424          <3>  movdqu [rsp + 16 * stackoffset], xmmregnumber
  5475                              <3> 
  5476                              <3>  %assign stackoffset stackoffset+1
  5477                              <3>  %assign regnumber regnumber+1
  5478 00000942 F30F7F7C2410        <3>  movdqu [rsp + 16 * stackoffset], xmmregnumber
  5479                              <3> 
  5480                              <3>  %assign stackoffset stackoffset+1
  5481                              <3>  %assign regnumber regnumber+1
  5482 00000948 F3440F7F442420      <3>  movdqu [rsp + 16 * stackoffset], xmmregnumber
  5483                              <3> 
  5484                              <3>  %assign stackoffset stackoffset+1
  5485                              <3>  %assign regnumber regnumber+1
  5486 0000094F F3440F7F4C2430      <3>  movdqu [rsp + 16 * stackoffset], xmmregnumber
  5487                              <3> 
  5488                              <3>  %assign stackoffset stackoffset+1
  5489                              <3>  %assign regnumber regnumber+1
  5490 00000956 F3440F7F542440      <3>  movdqu [rsp + 16 * stackoffset], xmmregnumber
  5491                              <3> 
  5492                              <3>  %assign stackoffset stackoffset+1
  5493                              <3>  %assign regnumber regnumber+1
  5494 0000095D F3440F7F5C2450      <3>  movdqu [rsp + 16 * stackoffset], xmmregnumber
  5495                              <3> 
  5496                              <3>  %assign stackoffset stackoffset+1
  5497                              <3>  %assign regnumber regnumber+1
  5498 00000964 F3440F7F642460      <3>  movdqu [rsp + 16 * stackoffset], xmmregnumber
  5499                              <3> 
  5500                              <3>  %assign stackoffset stackoffset+1
  5501                              <3>  %assign regnumber regnumber+1
  5502 0000096B F3440F7F6C2470      <3>  movdqu [rsp + 16 * stackoffset], xmmregnumber
  5503                              <3> 
  5504                              <3>  %assign stackoffset stackoffset+1
  5505                              <3>  %assign regnumber regnumber+1
  5506 00000972 F3440F7FB424800000- <3>  movdqu [rsp + 16 * stackoffset], xmmregnumber
  5507 0000097B 00                  <3>
  5508                              <3> 
  5509                              <3>  %assign stackoffset stackoffset+1
  5510                              <3>  %assign regnumber regnumber+1
  5511 0000097C F3440F7FBC24900000- <3>  movdqu [rsp + 16 * stackoffset], xmmregnumber
  5512 00000985 00                  <3>
  5513                              <3> 
  5514                              <3>  %assign stackoffset stackoffset+1
  5515                              <3>  %assign regnumber regnumber+1
  5516                              <1>  %endif
  5517                              <1>  %endif
  5518                              <1> 
  5519 00000986 B802000000          <1>  mov eax, 32 / MAX_REG_BLOCK_COUNT
  5520                              <1>  .1:
  5521                              <1>  aes_hw_cpu OPERATION_32_BLOCKS, MAX_REG_BLOCK_COUNT
  5522                              <2>  %define OPERATION %1
  5523                              <2>  %define BLOCK_COUNT %2
  5524                              <2> 
  5525                              <2> 
  5526                              <2>  %assign block 1
  5527                              <2>  %rep BLOCK_COUNT
  5528                              <2>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  5529                              <2>  %assign block block+1
  5530                              <2>  %endrep
  5531 0000098B F30F6F0A            <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  5532                              <3>  %assign block block+1
  5533 0000098F F30F6F5210          <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  5534                              <3>  %assign block block+1
  5535 00000994 F30F6F5A20          <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  5536                              <3>  %assign block block+1
  5537 00000999 F30F6F6230          <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  5538                              <3>  %assign block block+1
  5539 0000099E F30F6F6A40          <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  5540                              <3>  %assign block block+1
  5541 000009A3 F30F6F7250          <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  5542                              <3>  %assign block block+1
  5543 000009A8 F30F6F7A60          <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  5544                              <3>  %assign block block+1
  5545 000009AD F3440F6F4270        <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  5546                              <3>  %assign block block+1
  5547 000009B3 F3440F6F8A80000000  <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  5548                              <3>  %assign block block+1
  5549 000009BC F3440F6F9290000000  <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  5550                              <3>  %assign block block+1
  5551 000009C5 F3440F6F9AA0000000  <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  5552                              <3>  %assign block block+1
  5553 000009CE F3440F6FA2B0000000  <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  5554                              <3>  %assign block block+1
  5555 000009D7 F3440F6FAAC0000000  <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  5556                              <3>  %assign block block+1
  5557 000009E0 F3440F6FB2D0000000  <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  5558                              <3>  %assign block block+1
  5559 000009E9 F3440F6FBAE0000000  <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  5560                              <3>  %assign block block+1
  5561                              <2> 
  5562                              <2> 
  5563                              <2>  %assign round 0
  5564                              <2>  %rep 15
  5565                              <2>  movdqu xmm0, [Rcx + 16 * round]
  5566                              <2> 
  5567                              <2>  %assign block 1
  5568                              <2>  %rep BLOCK_COUNT
  5569                              <2> 
  5570                              <2>  %if round = 0
  5571                              <2>  pxor xmmblock, xmm0
  5572                              <2>  %else
  5573                              <2>  %if round < 14
  5574                              <2>  aesOPERATION xmmblock, xmm0
  5575                              <2>  %else
  5576                              <2>  aesOPERATIONlast xmmblock, xmm0
  5577                              <2>  %endif
  5578                              <2>  %endif
  5579                              <2> 
  5580                              <2>  %assign block block+1
  5581                              <2>  %endrep
  5582                              <2> 
  5583                              <2>  %assign round round+1
  5584                              <2>  %endrep
  5585 000009F2 F30F6F01            <3>  movdqu xmm0, [Rcx + 16 * round]
  5586                              <3> 
  5587                              <3>  %assign block 1
  5588                              <3>  %rep BLOCK_COUNT
  5589                              <3> 
  5590                              <3>  %if round = 0
  5591                              <3>  pxor xmmblock, xmm0
  5592                              <3>  %else
  5593                              <3>  %if round < 14
  5594                              <3>  aesOPERATION xmmblock, xmm0
  5595                              <3>  %else
  5596                              <3>  aesOPERATIONlast xmmblock, xmm0
  5597                              <3>  %endif
  5598                              <3>  %endif
  5599                              <3> 
  5600                              <3>  %assign block block+1
  5601                              <3>  %endrep
  5602                              <4> 
  5603                              <4>  %if round = 0
  5604 000009F6 660FEFC8            <4>  pxor xmmblock, xmm0
  5605                              <4>  %else
  5606                              <4>  %if round < 14
  5607                              <4>  aesOPERATION xmmblock, xmm0
  5608                              <4>  %else
  5609                              <4>  aesOPERATIONlast xmmblock, xmm0
  5610                              <4>  %endif
  5611                              <4>  %endif
  5612                              <4> 
  5613                              <4>  %assign block block+1
  5614                              <4> 
  5615                              <4>  %if round = 0
  5616 000009FA 660FEFD0            <4>  pxor xmmblock, xmm0
  5617                              <4>  %else
  5618                              <4>  %if round < 14
  5619                              <4>  aesOPERATION xmmblock, xmm0
  5620                              <4>  %else
  5621                              <4>  aesOPERATIONlast xmmblock, xmm0
  5622                              <4>  %endif
  5623                              <4>  %endif
  5624                              <4> 
  5625                              <4>  %assign block block+1
  5626                              <4> 
  5627                              <4>  %if round = 0
  5628 000009FE 660FEFD8            <4>  pxor xmmblock, xmm0
  5629                              <4>  %else
  5630                              <4>  %if round < 14
  5631                              <4>  aesOPERATION xmmblock, xmm0
  5632                              <4>  %else
  5633                              <4>  aesOPERATIONlast xmmblock, xmm0
  5634                              <4>  %endif
  5635                              <4>  %endif
  5636                              <4> 
  5637                              <4>  %assign block block+1
  5638                              <4> 
  5639                              <4>  %if round = 0
  5640 00000A02 660FEFE0            <4>  pxor xmmblock, xmm0
  5641                              <4>  %else
  5642                              <4>  %if round < 14
  5643                              <4>  aesOPERATION xmmblock, xmm0
  5644                              <4>  %else
  5645                              <4>  aesOPERATIONlast xmmblock, xmm0
  5646                              <4>  %endif
  5647                              <4>  %endif
  5648                              <4> 
  5649                              <4>  %assign block block+1
  5650                              <4> 
  5651                              <4>  %if round = 0
  5652 00000A06 660FEFE8            <4>  pxor xmmblock, xmm0
  5653                              <4>  %else
  5654                              <4>  %if round < 14
  5655                              <4>  aesOPERATION xmmblock, xmm0
  5656                              <4>  %else
  5657                              <4>  aesOPERATIONlast xmmblock, xmm0
  5658                              <4>  %endif
  5659                              <4>  %endif
  5660                              <4> 
  5661                              <4>  %assign block block+1
  5662                              <4> 
  5663                              <4>  %if round = 0
  5664 00000A0A 660FEFF0            <4>  pxor xmmblock, xmm0
  5665                              <4>  %else
  5666                              <4>  %if round < 14
  5667                              <4>  aesOPERATION xmmblock, xmm0
  5668                              <4>  %else
  5669                              <4>  aesOPERATIONlast xmmblock, xmm0
  5670                              <4>  %endif
  5671                              <4>  %endif
  5672                              <4> 
  5673                              <4>  %assign block block+1
  5674                              <4> 
  5675                              <4>  %if round = 0
  5676 00000A0E 660FEFF8            <4>  pxor xmmblock, xmm0
  5677                              <4>  %else
  5678                              <4>  %if round < 14
  5679                              <4>  aesOPERATION xmmblock, xmm0
  5680                              <4>  %else
  5681                              <4>  aesOPERATIONlast xmmblock, xmm0
  5682                              <4>  %endif
  5683                              <4>  %endif
  5684                              <4> 
  5685                              <4>  %assign block block+1
  5686                              <4> 
  5687                              <4>  %if round = 0
  5688 00000A12 66440FEFC0          <4>  pxor xmmblock, xmm0
  5689                              <4>  %else
  5690                              <4>  %if round < 14
  5691                              <4>  aesOPERATION xmmblock, xmm0
  5692                              <4>  %else
  5693                              <4>  aesOPERATIONlast xmmblock, xmm0
  5694                              <4>  %endif
  5695                              <4>  %endif
  5696                              <4> 
  5697                              <4>  %assign block block+1
  5698                              <4> 
  5699                              <4>  %if round = 0
  5700 00000A17 66440FEFC8          <4>  pxor xmmblock, xmm0
  5701                              <4>  %else
  5702                              <4>  %if round < 14
  5703                              <4>  aesOPERATION xmmblock, xmm0
  5704                              <4>  %else
  5705                              <4>  aesOPERATIONlast xmmblock, xmm0
  5706                              <4>  %endif
  5707                              <4>  %endif
  5708                              <4> 
  5709                              <4>  %assign block block+1
  5710                              <4> 
  5711                              <4>  %if round = 0
  5712 00000A1C 66440FEFD0          <4>  pxor xmmblock, xmm0
  5713                              <4>  %else
  5714                              <4>  %if round < 14
  5715                              <4>  aesOPERATION xmmblock, xmm0
  5716                              <4>  %else
  5717                              <4>  aesOPERATIONlast xmmblock, xmm0
  5718                              <4>  %endif
  5719                              <4>  %endif
  5720                              <4> 
  5721                              <4>  %assign block block+1
  5722                              <4> 
  5723                              <4>  %if round = 0
  5724 00000A21 66440FEFD8          <4>  pxor xmmblock, xmm0
  5725                              <4>  %else
  5726                              <4>  %if round < 14
  5727                              <4>  aesOPERATION xmmblock, xmm0
  5728                              <4>  %else
  5729                              <4>  aesOPERATIONlast xmmblock, xmm0
  5730                              <4>  %endif
  5731                              <4>  %endif
  5732                              <4> 
  5733                              <4>  %assign block block+1
  5734                              <4> 
  5735                              <4>  %if round = 0
  5736 00000A26 66440FEFE0          <4>  pxor xmmblock, xmm0
  5737                              <4>  %else
  5738                              <4>  %if round < 14
  5739                              <4>  aesOPERATION xmmblock, xmm0
  5740                              <4>  %else
  5741                              <4>  aesOPERATIONlast xmmblock, xmm0
  5742                              <4>  %endif
  5743                              <4>  %endif
  5744                              <4> 
  5745                              <4>  %assign block block+1
  5746                              <4> 
  5747                              <4>  %if round = 0
  5748 00000A2B 66440FEFE8          <4>  pxor xmmblock, xmm0
  5749                              <4>  %else
  5750                              <4>  %if round < 14
  5751                              <4>  aesOPERATION xmmblock, xmm0
  5752                              <4>  %else
  5753                              <4>  aesOPERATIONlast xmmblock, xmm0
  5754                              <4>  %endif
  5755                              <4>  %endif
  5756                              <4> 
  5757                              <4>  %assign block block+1
  5758                              <4> 
  5759                              <4>  %if round = 0
  5760 00000A30 66440FEFF0          <4>  pxor xmmblock, xmm0
  5761                              <4>  %else
  5762                              <4>  %if round < 14
  5763                              <4>  aesOPERATION xmmblock, xmm0
  5764                              <4>  %else
  5765                              <4>  aesOPERATIONlast xmmblock, xmm0
  5766                              <4>  %endif
  5767                              <4>  %endif
  5768                              <4> 
  5769                              <4>  %assign block block+1
  5770                              <4> 
  5771                              <4>  %if round = 0
  5772 00000A35 66440FEFF8          <4>  pxor xmmblock, xmm0
  5773                              <4>  %else
  5774                              <4>  %if round < 14
  5775                              <4>  aesOPERATION xmmblock, xmm0
  5776                              <4>  %else
  5777                              <4>  aesOPERATIONlast xmmblock, xmm0
  5778                              <4>  %endif
  5779                              <4>  %endif
  5780                              <4> 
  5781                              <4>  %assign block block+1
  5782                              <3> 
  5783                              <3>  %assign round round+1
  5784 00000A3A F30F6F4110          <3>  movdqu xmm0, [Rcx + 16 * round]
  5785                              <3> 
  5786                              <3>  %assign block 1
  5787                              <3>  %rep BLOCK_COUNT
  5788                              <3> 
  5789                              <3>  %if round = 0
  5790                              <3>  pxor xmmblock, xmm0
  5791                              <3>  %else
  5792                              <3>  %if round < 14
  5793                              <3>  aesOPERATION xmmblock, xmm0
  5794                              <3>  %else
  5795                              <3>  aesOPERATIONlast xmmblock, xmm0
  5796                              <3>  %endif
  5797                              <3>  %endif
  5798                              <3> 
  5799                              <3>  %assign block block+1
  5800                              <3>  %endrep
  5801                              <4> 
  5802                              <4>  %if round = 0
  5803                              <4>  pxor xmmblock, xmm0
  5804                              <4>  %else
  5805                              <4>  %if round < 14
  5806 00000A3F 660F38DCC8          <4>  aesOPERATION xmmblock, xmm0
  5807                              <4>  %else
  5808                              <4>  aesOPERATIONlast xmmblock, xmm0
  5809                              <4>  %endif
  5810                              <4>  %endif
  5811                              <4> 
  5812                              <4>  %assign block block+1
  5813                              <4> 
  5814                              <4>  %if round = 0
  5815                              <4>  pxor xmmblock, xmm0
  5816                              <4>  %else
  5817                              <4>  %if round < 14
  5818 00000A44 660F38DCD0          <4>  aesOPERATION xmmblock, xmm0
  5819                              <4>  %else
  5820                              <4>  aesOPERATIONlast xmmblock, xmm0
  5821                              <4>  %endif
  5822                              <4>  %endif
  5823                              <4> 
  5824                              <4>  %assign block block+1
  5825                              <4> 
  5826                              <4>  %if round = 0
  5827                              <4>  pxor xmmblock, xmm0
  5828                              <4>  %else
  5829                              <4>  %if round < 14
  5830 00000A49 660F38DCD8          <4>  aesOPERATION xmmblock, xmm0
  5831                              <4>  %else
  5832                              <4>  aesOPERATIONlast xmmblock, xmm0
  5833                              <4>  %endif
  5834                              <4>  %endif
  5835                              <4> 
  5836                              <4>  %assign block block+1
  5837                              <4> 
  5838                              <4>  %if round = 0
  5839                              <4>  pxor xmmblock, xmm0
  5840                              <4>  %else
  5841                              <4>  %if round < 14
  5842 00000A4E 660F38DCE0          <4>  aesOPERATION xmmblock, xmm0
  5843                              <4>  %else
  5844                              <4>  aesOPERATIONlast xmmblock, xmm0
  5845                              <4>  %endif
  5846                              <4>  %endif
  5847                              <4> 
  5848                              <4>  %assign block block+1
  5849                              <4> 
  5850                              <4>  %if round = 0
  5851                              <4>  pxor xmmblock, xmm0
  5852                              <4>  %else
  5853                              <4>  %if round < 14
  5854 00000A53 660F38DCE8          <4>  aesOPERATION xmmblock, xmm0
  5855                              <4>  %else
  5856                              <4>  aesOPERATIONlast xmmblock, xmm0
  5857                              <4>  %endif
  5858                              <4>  %endif
  5859                              <4> 
  5860                              <4>  %assign block block+1
  5861                              <4> 
  5862                              <4>  %if round = 0
  5863                              <4>  pxor xmmblock, xmm0
  5864                              <4>  %else
  5865                              <4>  %if round < 14
  5866 00000A58 660F38DCF0          <4>  aesOPERATION xmmblock, xmm0
  5867                              <4>  %else
  5868                              <4>  aesOPERATIONlast xmmblock, xmm0
  5869                              <4>  %endif
  5870                              <4>  %endif
  5871                              <4> 
  5872                              <4>  %assign block block+1
  5873                              <4> 
  5874                              <4>  %if round = 0
  5875                              <4>  pxor xmmblock, xmm0
  5876                              <4>  %else
  5877                              <4>  %if round < 14
  5878 00000A5D 660F38DCF8          <4>  aesOPERATION xmmblock, xmm0
  5879                              <4>  %else
  5880                              <4>  aesOPERATIONlast xmmblock, xmm0
  5881                              <4>  %endif
  5882                              <4>  %endif
  5883                              <4> 
  5884                              <4>  %assign block block+1
  5885                              <4> 
  5886                              <4>  %if round = 0
  5887                              <4>  pxor xmmblock, xmm0
  5888                              <4>  %else
  5889                              <4>  %if round < 14
  5890 00000A62 66440F38DCC0        <4>  aesOPERATION xmmblock, xmm0
  5891                              <4>  %else
  5892                              <4>  aesOPERATIONlast xmmblock, xmm0
  5893                              <4>  %endif
  5894                              <4>  %endif
  5895                              <4> 
  5896                              <4>  %assign block block+1
  5897                              <4> 
  5898                              <4>  %if round = 0
  5899                              <4>  pxor xmmblock, xmm0
  5900                              <4>  %else
  5901                              <4>  %if round < 14
  5902 00000A68 66440F38DCC8        <4>  aesOPERATION xmmblock, xmm0
  5903                              <4>  %else
  5904                              <4>  aesOPERATIONlast xmmblock, xmm0
  5905                              <4>  %endif
  5906                              <4>  %endif
  5907                              <4> 
  5908                              <4>  %assign block block+1
  5909                              <4> 
  5910                              <4>  %if round = 0
  5911                              <4>  pxor xmmblock, xmm0
  5912                              <4>  %else
  5913                              <4>  %if round < 14
  5914 00000A6E 66440F38DCD0        <4>  aesOPERATION xmmblock, xmm0
  5915                              <4>  %else
  5916                              <4>  aesOPERATIONlast xmmblock, xmm0
  5917                              <4>  %endif
  5918                              <4>  %endif
  5919                              <4> 
  5920                              <4>  %assign block block+1
  5921                              <4> 
  5922                              <4>  %if round = 0
  5923                              <4>  pxor xmmblock, xmm0
  5924                              <4>  %else
  5925                              <4>  %if round < 14
  5926 00000A74 66440F38DCD8        <4>  aesOPERATION xmmblock, xmm0
  5927                              <4>  %else
  5928                              <4>  aesOPERATIONlast xmmblock, xmm0
  5929                              <4>  %endif
  5930                              <4>  %endif
  5931                              <4> 
  5932                              <4>  %assign block block+1
  5933                              <4> 
  5934                              <4>  %if round = 0
  5935                              <4>  pxor xmmblock, xmm0
  5936                              <4>  %else
  5937                              <4>  %if round < 14
  5938 00000A7A 66440F38DCE0        <4>  aesOPERATION xmmblock, xmm0
  5939                              <4>  %else
  5940                              <4>  aesOPERATIONlast xmmblock, xmm0
  5941                              <4>  %endif
  5942                              <4>  %endif
  5943                              <4> 
  5944                              <4>  %assign block block+1
  5945                              <4> 
  5946                              <4>  %if round = 0
  5947                              <4>  pxor xmmblock, xmm0
  5948                              <4>  %else
  5949                              <4>  %if round < 14
  5950 00000A80 66440F38DCE8        <4>  aesOPERATION xmmblock, xmm0
  5951                              <4>  %else
  5952                              <4>  aesOPERATIONlast xmmblock, xmm0
  5953                              <4>  %endif
  5954                              <4>  %endif
  5955                              <4> 
  5956                              <4>  %assign block block+1
  5957                              <4> 
  5958                              <4>  %if round = 0
  5959                              <4>  pxor xmmblock, xmm0
  5960                              <4>  %else
  5961                              <4>  %if round < 14
  5962 00000A86 66440F38DCF0        <4>  aesOPERATION xmmblock, xmm0
  5963                              <4>  %else
  5964                              <4>  aesOPERATIONlast xmmblock, xmm0
  5965                              <4>  %endif
  5966                              <4>  %endif
  5967                              <4> 
  5968                              <4>  %assign block block+1
  5969                              <4> 
  5970                              <4>  %if round = 0
  5971                              <4>  pxor xmmblock, xmm0
  5972                              <4>  %else
  5973                              <4>  %if round < 14
  5974 00000A8C 66440F38DCF8        <4>  aesOPERATION xmmblock, xmm0
  5975                              <4>  %else
  5976                              <4>  aesOPERATIONlast xmmblock, xmm0
  5977                              <4>  %endif
  5978                              <4>  %endif
  5979                              <4> 
  5980                              <4>  %assign block block+1
  5981                              <3> 
  5982                              <3>  %assign round round+1
  5983 00000A92 F30F6F4120          <3>  movdqu xmm0, [Rcx + 16 * round]
  5984                              <3> 
  5985                              <3>  %assign block 1
  5986                              <3>  %rep BLOCK_COUNT
  5987                              <3> 
  5988                              <3>  %if round = 0
  5989                              <3>  pxor xmmblock, xmm0
  5990                              <3>  %else
  5991                              <3>  %if round < 14
  5992                              <3>  aesOPERATION xmmblock, xmm0
  5993                              <3>  %else
  5994                              <3>  aesOPERATIONlast xmmblock, xmm0
  5995                              <3>  %endif
  5996                              <3>  %endif
  5997                              <3> 
  5998                              <3>  %assign block block+1
  5999                              <3>  %endrep
  6000                              <4> 
  6001                              <4>  %if round = 0
  6002                              <4>  pxor xmmblock, xmm0
  6003                              <4>  %else
  6004                              <4>  %if round < 14
  6005 00000A97 660F38DCC8          <4>  aesOPERATION xmmblock, xmm0
  6006                              <4>  %else
  6007                              <4>  aesOPERATIONlast xmmblock, xmm0
  6008                              <4>  %endif
  6009                              <4>  %endif
  6010                              <4> 
  6011                              <4>  %assign block block+1
  6012                              <4> 
  6013                              <4>  %if round = 0
  6014                              <4>  pxor xmmblock, xmm0
  6015                              <4>  %else
  6016                              <4>  %if round < 14
  6017 00000A9C 660F38DCD0          <4>  aesOPERATION xmmblock, xmm0
  6018                              <4>  %else
  6019                              <4>  aesOPERATIONlast xmmblock, xmm0
  6020                              <4>  %endif
  6021                              <4>  %endif
  6022                              <4> 
  6023                              <4>  %assign block block+1
  6024                              <4> 
  6025                              <4>  %if round = 0
  6026                              <4>  pxor xmmblock, xmm0
  6027                              <4>  %else
  6028                              <4>  %if round < 14
  6029 00000AA1 660F38DCD8          <4>  aesOPERATION xmmblock, xmm0
  6030                              <4>  %else
  6031                              <4>  aesOPERATIONlast xmmblock, xmm0
  6032                              <4>  %endif
  6033                              <4>  %endif
  6034                              <4> 
  6035                              <4>  %assign block block+1
  6036                              <4> 
  6037                              <4>  %if round = 0
  6038                              <4>  pxor xmmblock, xmm0
  6039                              <4>  %else
  6040                              <4>  %if round < 14
  6041 00000AA6 660F38DCE0          <4>  aesOPERATION xmmblock, xmm0
  6042                              <4>  %else
  6043                              <4>  aesOPERATIONlast xmmblock, xmm0
  6044                              <4>  %endif
  6045                              <4>  %endif
  6046                              <4> 
  6047                              <4>  %assign block block+1
  6048                              <4> 
  6049                              <4>  %if round = 0
  6050                              <4>  pxor xmmblock, xmm0
  6051                              <4>  %else
  6052                              <4>  %if round < 14
  6053 00000AAB 660F38DCE8          <4>  aesOPERATION xmmblock, xmm0
  6054                              <4>  %else
  6055                              <4>  aesOPERATIONlast xmmblock, xmm0
  6056                              <4>  %endif
  6057                              <4>  %endif
  6058                              <4> 
  6059                              <4>  %assign block block+1
  6060                              <4> 
  6061                              <4>  %if round = 0
  6062                              <4>  pxor xmmblock, xmm0
  6063                              <4>  %else
  6064                              <4>  %if round < 14
  6065 00000AB0 660F38DCF0          <4>  aesOPERATION xmmblock, xmm0
  6066                              <4>  %else
  6067                              <4>  aesOPERATIONlast xmmblock, xmm0
  6068                              <4>  %endif
  6069                              <4>  %endif
  6070                              <4> 
  6071                              <4>  %assign block block+1
  6072                              <4> 
  6073                              <4>  %if round = 0
  6074                              <4>  pxor xmmblock, xmm0
  6075                              <4>  %else
  6076                              <4>  %if round < 14
  6077 00000AB5 660F38DCF8          <4>  aesOPERATION xmmblock, xmm0
  6078                              <4>  %else
  6079                              <4>  aesOPERATIONlast xmmblock, xmm0
  6080                              <4>  %endif
  6081                              <4>  %endif
  6082                              <4> 
  6083                              <4>  %assign block block+1
  6084                              <4> 
  6085                              <4>  %if round = 0
  6086                              <4>  pxor xmmblock, xmm0
  6087                              <4>  %else
  6088                              <4>  %if round < 14
  6089 00000ABA 66440F38DCC0        <4>  aesOPERATION xmmblock, xmm0
  6090                              <4>  %else
  6091                              <4>  aesOPERATIONlast xmmblock, xmm0
  6092                              <4>  %endif
  6093                              <4>  %endif
  6094                              <4> 
  6095                              <4>  %assign block block+1
  6096                              <4> 
  6097                              <4>  %if round = 0
  6098                              <4>  pxor xmmblock, xmm0
  6099                              <4>  %else
  6100                              <4>  %if round < 14
  6101 00000AC0 66440F38DCC8        <4>  aesOPERATION xmmblock, xmm0
  6102                              <4>  %else
  6103                              <4>  aesOPERATIONlast xmmblock, xmm0
  6104                              <4>  %endif
  6105                              <4>  %endif
  6106                              <4> 
  6107                              <4>  %assign block block+1
  6108                              <4> 
  6109                              <4>  %if round = 0
  6110                              <4>  pxor xmmblock, xmm0
  6111                              <4>  %else
  6112                              <4>  %if round < 14
  6113 00000AC6 66440F38DCD0        <4>  aesOPERATION xmmblock, xmm0
  6114                              <4>  %else
  6115                              <4>  aesOPERATIONlast xmmblock, xmm0
  6116                              <4>  %endif
  6117                              <4>  %endif
  6118                              <4> 
  6119                              <4>  %assign block block+1
  6120                              <4> 
  6121                              <4>  %if round = 0
  6122                              <4>  pxor xmmblock, xmm0
  6123                              <4>  %else
  6124                              <4>  %if round < 14
  6125 00000ACC 66440F38DCD8        <4>  aesOPERATION xmmblock, xmm0
  6126                              <4>  %else
  6127                              <4>  aesOPERATIONlast xmmblock, xmm0
  6128                              <4>  %endif
  6129                              <4>  %endif
  6130                              <4> 
  6131                              <4>  %assign block block+1
  6132                              <4> 
  6133                              <4>  %if round = 0
  6134                              <4>  pxor xmmblock, xmm0
  6135                              <4>  %else
  6136                              <4>  %if round < 14
  6137 00000AD2 66440F38DCE0        <4>  aesOPERATION xmmblock, xmm0
  6138                              <4>  %else
  6139                              <4>  aesOPERATIONlast xmmblock, xmm0
  6140                              <4>  %endif
  6141                              <4>  %endif
  6142                              <4> 
  6143                              <4>  %assign block block+1
  6144                              <4> 
  6145                              <4>  %if round = 0
  6146                              <4>  pxor xmmblock, xmm0
  6147                              <4>  %else
  6148                              <4>  %if round < 14
  6149 00000AD8 66440F38DCE8        <4>  aesOPERATION xmmblock, xmm0
  6150                              <4>  %else
  6151                              <4>  aesOPERATIONlast xmmblock, xmm0
  6152                              <4>  %endif
  6153                              <4>  %endif
  6154                              <4> 
  6155                              <4>  %assign block block+1
  6156                              <4> 
  6157                              <4>  %if round = 0
  6158                              <4>  pxor xmmblock, xmm0
  6159                              <4>  %else
  6160                              <4>  %if round < 14
  6161 00000ADE 66440F38DCF0        <4>  aesOPERATION xmmblock, xmm0
  6162                              <4>  %else
  6163                              <4>  aesOPERATIONlast xmmblock, xmm0
  6164                              <4>  %endif
  6165                              <4>  %endif
  6166                              <4> 
  6167                              <4>  %assign block block+1
  6168                              <4> 
  6169                              <4>  %if round = 0
  6170                              <4>  pxor xmmblock, xmm0
  6171                              <4>  %else
  6172                              <4>  %if round < 14
  6173 00000AE4 66440F38DCF8        <4>  aesOPERATION xmmblock, xmm0
  6174                              <4>  %else
  6175                              <4>  aesOPERATIONlast xmmblock, xmm0
  6176                              <4>  %endif
  6177                              <4>  %endif
  6178                              <4> 
  6179                              <4>  %assign block block+1
  6180                              <3> 
  6181                              <3>  %assign round round+1
  6182 00000AEA F30F6F4130          <3>  movdqu xmm0, [Rcx + 16 * round]
  6183                              <3> 
  6184                              <3>  %assign block 1
  6185                              <3>  %rep BLOCK_COUNT
  6186                              <3> 
  6187                              <3>  %if round = 0
  6188                              <3>  pxor xmmblock, xmm0
  6189                              <3>  %else
  6190                              <3>  %if round < 14
  6191                              <3>  aesOPERATION xmmblock, xmm0
  6192                              <3>  %else
  6193                              <3>  aesOPERATIONlast xmmblock, xmm0
  6194                              <3>  %endif
  6195                              <3>  %endif
  6196                              <3> 
  6197                              <3>  %assign block block+1
  6198                              <3>  %endrep
  6199                              <4> 
  6200                              <4>  %if round = 0
  6201                              <4>  pxor xmmblock, xmm0
  6202                              <4>  %else
  6203                              <4>  %if round < 14
  6204 00000AEF 660F38DCC8          <4>  aesOPERATION xmmblock, xmm0
  6205                              <4>  %else
  6206                              <4>  aesOPERATIONlast xmmblock, xmm0
  6207                              <4>  %endif
  6208                              <4>  %endif
  6209                              <4> 
  6210                              <4>  %assign block block+1
  6211                              <4> 
  6212                              <4>  %if round = 0
  6213                              <4>  pxor xmmblock, xmm0
  6214                              <4>  %else
  6215                              <4>  %if round < 14
  6216 00000AF4 660F38DCD0          <4>  aesOPERATION xmmblock, xmm0
  6217                              <4>  %else
  6218                              <4>  aesOPERATIONlast xmmblock, xmm0
  6219                              <4>  %endif
  6220                              <4>  %endif
  6221                              <4> 
  6222                              <4>  %assign block block+1
  6223                              <4> 
  6224                              <4>  %if round = 0
  6225                              <4>  pxor xmmblock, xmm0
  6226                              <4>  %else
  6227                              <4>  %if round < 14
  6228 00000AF9 660F38DCD8          <4>  aesOPERATION xmmblock, xmm0
  6229                              <4>  %else
  6230                              <4>  aesOPERATIONlast xmmblock, xmm0
  6231                              <4>  %endif
  6232                              <4>  %endif
  6233                              <4> 
  6234                              <4>  %assign block block+1
  6235                              <4> 
  6236                              <4>  %if round = 0
  6237                              <4>  pxor xmmblock, xmm0
  6238                              <4>  %else
  6239                              <4>  %if round < 14
  6240 00000AFE 660F38DCE0          <4>  aesOPERATION xmmblock, xmm0
  6241                              <4>  %else
  6242                              <4>  aesOPERATIONlast xmmblock, xmm0
  6243                              <4>  %endif
  6244                              <4>  %endif
  6245                              <4> 
  6246                              <4>  %assign block block+1
  6247                              <4> 
  6248                              <4>  %if round = 0
  6249                              <4>  pxor xmmblock, xmm0
  6250                              <4>  %else
  6251                              <4>  %if round < 14
  6252 00000B03 660F38DCE8          <4>  aesOPERATION xmmblock, xmm0
  6253                              <4>  %else
  6254                              <4>  aesOPERATIONlast xmmblock, xmm0
  6255                              <4>  %endif
  6256                              <4>  %endif
  6257                              <4> 
  6258                              <4>  %assign block block+1
  6259                              <4> 
  6260                              <4>  %if round = 0
  6261                              <4>  pxor xmmblock, xmm0
  6262                              <4>  %else
  6263                              <4>  %if round < 14
  6264 00000B08 660F38DCF0          <4>  aesOPERATION xmmblock, xmm0
  6265                              <4>  %else
  6266                              <4>  aesOPERATIONlast xmmblock, xmm0
  6267                              <4>  %endif
  6268                              <4>  %endif
  6269                              <4> 
  6270                              <4>  %assign block block+1
  6271                              <4> 
  6272                              <4>  %if round = 0
  6273                              <4>  pxor xmmblock, xmm0
  6274                              <4>  %else
  6275                              <4>  %if round < 14
  6276 00000B0D 660F38DCF8          <4>  aesOPERATION xmmblock, xmm0
  6277                              <4>  %else
  6278                              <4>  aesOPERATIONlast xmmblock, xmm0
  6279                              <4>  %endif
  6280                              <4>  %endif
  6281                              <4> 
  6282                              <4>  %assign block block+1
  6283                              <4> 
  6284                              <4>  %if round = 0
  6285                              <4>  pxor xmmblock, xmm0
  6286                              <4>  %else
  6287                              <4>  %if round < 14
  6288 00000B12 66440F38DCC0        <4>  aesOPERATION xmmblock, xmm0
  6289                              <4>  %else
  6290                              <4>  aesOPERATIONlast xmmblock, xmm0
  6291                              <4>  %endif
  6292                              <4>  %endif
  6293                              <4> 
  6294                              <4>  %assign block block+1
  6295                              <4> 
  6296                              <4>  %if round = 0
  6297                              <4>  pxor xmmblock, xmm0
  6298                              <4>  %else
  6299                              <4>  %if round < 14
  6300 00000B18 66440F38DCC8        <4>  aesOPERATION xmmblock, xmm0
  6301                              <4>  %else
  6302                              <4>  aesOPERATIONlast xmmblock, xmm0
  6303                              <4>  %endif
  6304                              <4>  %endif
  6305                              <4> 
  6306                              <4>  %assign block block+1
  6307                              <4> 
  6308                              <4>  %if round = 0
  6309                              <4>  pxor xmmblock, xmm0
  6310                              <4>  %else
  6311                              <4>  %if round < 14
  6312 00000B1E 66440F38DCD0        <4>  aesOPERATION xmmblock, xmm0
  6313                              <4>  %else
  6314                              <4>  aesOPERATIONlast xmmblock, xmm0
  6315                              <4>  %endif
  6316                              <4>  %endif
  6317                              <4> 
  6318                              <4>  %assign block block+1
  6319                              <4> 
  6320                              <4>  %if round = 0
  6321                              <4>  pxor xmmblock, xmm0
  6322                              <4>  %else
  6323                              <4>  %if round < 14
  6324 00000B24 66440F38DCD8        <4>  aesOPERATION xmmblock, xmm0
  6325                              <4>  %else
  6326                              <4>  aesOPERATIONlast xmmblock, xmm0
  6327                              <4>  %endif
  6328                              <4>  %endif
  6329                              <4> 
  6330                              <4>  %assign block block+1
  6331                              <4> 
  6332                              <4>  %if round = 0
  6333                              <4>  pxor xmmblock, xmm0
  6334                              <4>  %else
  6335                              <4>  %if round < 14
  6336 00000B2A 66440F38DCE0        <4>  aesOPERATION xmmblock, xmm0
  6337                              <4>  %else
  6338                              <4>  aesOPERATIONlast xmmblock, xmm0
  6339                              <4>  %endif
  6340                              <4>  %endif
  6341                              <4> 
  6342                              <4>  %assign block block+1
  6343                              <4> 
  6344                              <4>  %if round = 0
  6345                              <4>  pxor xmmblock, xmm0
  6346                              <4>  %else
  6347                              <4>  %if round < 14
  6348 00000B30 66440F38DCE8        <4>  aesOPERATION xmmblock, xmm0
  6349                              <4>  %else
  6350                              <4>  aesOPERATIONlast xmmblock, xmm0
  6351                              <4>  %endif
  6352                              <4>  %endif
  6353                              <4> 
  6354                              <4>  %assign block block+1
  6355                              <4> 
  6356                              <4>  %if round = 0
  6357                              <4>  pxor xmmblock, xmm0
  6358                              <4>  %else
  6359                              <4>  %if round < 14
  6360 00000B36 66440F38DCF0        <4>  aesOPERATION xmmblock, xmm0
  6361                              <4>  %else
  6362                              <4>  aesOPERATIONlast xmmblock, xmm0
  6363                              <4>  %endif
  6364                              <4>  %endif
  6365                              <4> 
  6366                              <4>  %assign block block+1
  6367                              <4> 
  6368                              <4>  %if round = 0
  6369                              <4>  pxor xmmblock, xmm0
  6370                              <4>  %else
  6371                              <4>  %if round < 14
  6372 00000B3C 66440F38DCF8        <4>  aesOPERATION xmmblock, xmm0
  6373                              <4>  %else
  6374                              <4>  aesOPERATIONlast xmmblock, xmm0
  6375                              <4>  %endif
  6376                              <4>  %endif
  6377                              <4> 
  6378                              <4>  %assign block block+1
  6379                              <3> 
  6380                              <3>  %assign round round+1
  6381 00000B42 F30F6F4140          <3>  movdqu xmm0, [Rcx + 16 * round]
  6382                              <3> 
  6383                              <3>  %assign block 1
  6384                              <3>  %rep BLOCK_COUNT
  6385                              <3> 
  6386                              <3>  %if round = 0
  6387                              <3>  pxor xmmblock, xmm0
  6388                              <3>  %else
  6389                              <3>  %if round < 14
  6390                              <3>  aesOPERATION xmmblock, xmm0
  6391                              <3>  %else
  6392                              <3>  aesOPERATIONlast xmmblock, xmm0
  6393                              <3>  %endif
  6394                              <3>  %endif
  6395                              <3> 
  6396                              <3>  %assign block block+1
  6397                              <3>  %endrep
  6398                              <4> 
  6399                              <4>  %if round = 0
  6400                              <4>  pxor xmmblock, xmm0
  6401                              <4>  %else
  6402                              <4>  %if round < 14
  6403 00000B47 660F38DCC8          <4>  aesOPERATION xmmblock, xmm0
  6404                              <4>  %else
  6405                              <4>  aesOPERATIONlast xmmblock, xmm0
  6406                              <4>  %endif
  6407                              <4>  %endif
  6408                              <4> 
  6409                              <4>  %assign block block+1
  6410                              <4> 
  6411                              <4>  %if round = 0
  6412                              <4>  pxor xmmblock, xmm0
  6413                              <4>  %else
  6414                              <4>  %if round < 14
  6415 00000B4C 660F38DCD0          <4>  aesOPERATION xmmblock, xmm0
  6416                              <4>  %else
  6417                              <4>  aesOPERATIONlast xmmblock, xmm0
  6418                              <4>  %endif
  6419                              <4>  %endif
  6420                              <4> 
  6421                              <4>  %assign block block+1
  6422                              <4> 
  6423                              <4>  %if round = 0
  6424                              <4>  pxor xmmblock, xmm0
  6425                              <4>  %else
  6426                              <4>  %if round < 14
  6427 00000B51 660F38DCD8          <4>  aesOPERATION xmmblock, xmm0
  6428                              <4>  %else
  6429                              <4>  aesOPERATIONlast xmmblock, xmm0
  6430                              <4>  %endif
  6431                              <4>  %endif
  6432                              <4> 
  6433                              <4>  %assign block block+1
  6434                              <4> 
  6435                              <4>  %if round = 0
  6436                              <4>  pxor xmmblock, xmm0
  6437                              <4>  %else
  6438                              <4>  %if round < 14
  6439 00000B56 660F38DCE0          <4>  aesOPERATION xmmblock, xmm0
  6440                              <4>  %else
  6441                              <4>  aesOPERATIONlast xmmblock, xmm0
  6442                              <4>  %endif
  6443                              <4>  %endif
  6444                              <4> 
  6445                              <4>  %assign block block+1
  6446                              <4> 
  6447                              <4>  %if round = 0
  6448                              <4>  pxor xmmblock, xmm0
  6449                              <4>  %else
  6450                              <4>  %if round < 14
  6451 00000B5B 660F38DCE8          <4>  aesOPERATION xmmblock, xmm0
  6452                              <4>  %else
  6453                              <4>  aesOPERATIONlast xmmblock, xmm0
  6454                              <4>  %endif
  6455                              <4>  %endif
  6456                              <4> 
  6457                              <4>  %assign block block+1
  6458                              <4> 
  6459                              <4>  %if round = 0
  6460                              <4>  pxor xmmblock, xmm0
  6461                              <4>  %else
  6462                              <4>  %if round < 14
  6463 00000B60 660F38DCF0          <4>  aesOPERATION xmmblock, xmm0
  6464                              <4>  %else
  6465                              <4>  aesOPERATIONlast xmmblock, xmm0
  6466                              <4>  %endif
  6467                              <4>  %endif
  6468                              <4> 
  6469                              <4>  %assign block block+1
  6470                              <4> 
  6471                              <4>  %if round = 0
  6472                              <4>  pxor xmmblock, xmm0
  6473                              <4>  %else
  6474                              <4>  %if round < 14
  6475 00000B65 660F38DCF8          <4>  aesOPERATION xmmblock, xmm0
  6476                              <4>  %else
  6477                              <4>  aesOPERATIONlast xmmblock, xmm0
  6478                              <4>  %endif
  6479                              <4>  %endif
  6480                              <4> 
  6481                              <4>  %assign block block+1
  6482                              <4> 
  6483                              <4>  %if round = 0
  6484                              <4>  pxor xmmblock, xmm0
  6485                              <4>  %else
  6486                              <4>  %if round < 14
  6487 00000B6A 66440F38DCC0        <4>  aesOPERATION xmmblock, xmm0
  6488                              <4>  %else
  6489                              <4>  aesOPERATIONlast xmmblock, xmm0
  6490                              <4>  %endif
  6491                              <4>  %endif
  6492                              <4> 
  6493                              <4>  %assign block block+1
  6494                              <4> 
  6495                              <4>  %if round = 0
  6496                              <4>  pxor xmmblock, xmm0
  6497                              <4>  %else
  6498                              <4>  %if round < 14
  6499 00000B70 66440F38DCC8        <4>  aesOPERATION xmmblock, xmm0
  6500                              <4>  %else
  6501                              <4>  aesOPERATIONlast xmmblock, xmm0
  6502                              <4>  %endif
  6503                              <4>  %endif
  6504                              <4> 
  6505                              <4>  %assign block block+1
  6506                              <4> 
  6507                              <4>  %if round = 0
  6508                              <4>  pxor xmmblock, xmm0
  6509                              <4>  %else
  6510                              <4>  %if round < 14
  6511 00000B76 66440F38DCD0        <4>  aesOPERATION xmmblock, xmm0
  6512                              <4>  %else
  6513                              <4>  aesOPERATIONlast xmmblock, xmm0
  6514                              <4>  %endif
  6515                              <4>  %endif
  6516                              <4> 
  6517                              <4>  %assign block block+1
  6518                              <4> 
  6519                              <4>  %if round = 0
  6520                              <4>  pxor xmmblock, xmm0
  6521                              <4>  %else
  6522                              <4>  %if round < 14
  6523 00000B7C 66440F38DCD8        <4>  aesOPERATION xmmblock, xmm0
  6524                              <4>  %else
  6525                              <4>  aesOPERATIONlast xmmblock, xmm0
  6526                              <4>  %endif
  6527                              <4>  %endif
  6528                              <4> 
  6529                              <4>  %assign block block+1
  6530                              <4> 
  6531                              <4>  %if round = 0
  6532                              <4>  pxor xmmblock, xmm0
  6533                              <4>  %else
  6534                              <4>  %if round < 14
  6535 00000B82 66440F38DCE0        <4>  aesOPERATION xmmblock, xmm0
  6536                              <4>  %else
  6537                              <4>  aesOPERATIONlast xmmblock, xmm0
  6538                              <4>  %endif
  6539                              <4>  %endif
  6540                              <4> 
  6541                              <4>  %assign block block+1
  6542                              <4> 
  6543                              <4>  %if round = 0
  6544                              <4>  pxor xmmblock, xmm0
  6545                              <4>  %else
  6546                              <4>  %if round < 14
  6547 00000B88 66440F38DCE8        <4>  aesOPERATION xmmblock, xmm0
  6548                              <4>  %else
  6549                              <4>  aesOPERATIONlast xmmblock, xmm0
  6550                              <4>  %endif
  6551                              <4>  %endif
  6552                              <4> 
  6553                              <4>  %assign block block+1
  6554                              <4> 
  6555                              <4>  %if round = 0
  6556                              <4>  pxor xmmblock, xmm0
  6557                              <4>  %else
  6558                              <4>  %if round < 14
  6559 00000B8E 66440F38DCF0        <4>  aesOPERATION xmmblock, xmm0
  6560                              <4>  %else
  6561                              <4>  aesOPERATIONlast xmmblock, xmm0
  6562                              <4>  %endif
  6563                              <4>  %endif
  6564                              <4> 
  6565                              <4>  %assign block block+1
  6566                              <4> 
  6567                              <4>  %if round = 0
  6568                              <4>  pxor xmmblock, xmm0
  6569                              <4>  %else
  6570                              <4>  %if round < 14
  6571 00000B94 66440F38DCF8        <4>  aesOPERATION xmmblock, xmm0
  6572                              <4>  %else
  6573                              <4>  aesOPERATIONlast xmmblock, xmm0
  6574                              <4>  %endif
  6575                              <4>  %endif
  6576                              <4> 
  6577                              <4>  %assign block block+1
  6578                              <3> 
  6579                              <3>  %assign round round+1
  6580 00000B9A F30F6F4150          <3>  movdqu xmm0, [Rcx + 16 * round]
  6581                              <3> 
  6582                              <3>  %assign block 1
  6583                              <3>  %rep BLOCK_COUNT
  6584                              <3> 
  6585                              <3>  %if round = 0
  6586                              <3>  pxor xmmblock, xmm0
  6587                              <3>  %else
  6588                              <3>  %if round < 14
  6589                              <3>  aesOPERATION xmmblock, xmm0
  6590                              <3>  %else
  6591                              <3>  aesOPERATIONlast xmmblock, xmm0
  6592                              <3>  %endif
  6593                              <3>  %endif
  6594                              <3> 
  6595                              <3>  %assign block block+1
  6596                              <3>  %endrep
  6597                              <4> 
  6598                              <4>  %if round = 0
  6599                              <4>  pxor xmmblock, xmm0
  6600                              <4>  %else
  6601                              <4>  %if round < 14
  6602 00000B9F 660F38DCC8          <4>  aesOPERATION xmmblock, xmm0
  6603                              <4>  %else
  6604                              <4>  aesOPERATIONlast xmmblock, xmm0
  6605                              <4>  %endif
  6606                              <4>  %endif
  6607                              <4> 
  6608                              <4>  %assign block block+1
  6609                              <4> 
  6610                              <4>  %if round = 0
  6611                              <4>  pxor xmmblock, xmm0
  6612                              <4>  %else
  6613                              <4>  %if round < 14
  6614 00000BA4 660F38DCD0          <4>  aesOPERATION xmmblock, xmm0
  6615                              <4>  %else
  6616                              <4>  aesOPERATIONlast xmmblock, xmm0
  6617                              <4>  %endif
  6618                              <4>  %endif
  6619                              <4> 
  6620                              <4>  %assign block block+1
  6621                              <4> 
  6622                              <4>  %if round = 0
  6623                              <4>  pxor xmmblock, xmm0
  6624                              <4>  %else
  6625                              <4>  %if round < 14
  6626 00000BA9 660F38DCD8          <4>  aesOPERATION xmmblock, xmm0
  6627                              <4>  %else
  6628                              <4>  aesOPERATIONlast xmmblock, xmm0
  6629                              <4>  %endif
  6630                              <4>  %endif
  6631                              <4> 
  6632                              <4>  %assign block block+1
  6633                              <4> 
  6634                              <4>  %if round = 0
  6635                              <4>  pxor xmmblock, xmm0
  6636                              <4>  %else
  6637                              <4>  %if round < 14
  6638 00000BAE 660F38DCE0          <4>  aesOPERATION xmmblock, xmm0
  6639                              <4>  %else
  6640                              <4>  aesOPERATIONlast xmmblock, xmm0
  6641                              <4>  %endif
  6642                              <4>  %endif
  6643                              <4> 
  6644                              <4>  %assign block block+1
  6645                              <4> 
  6646                              <4>  %if round = 0
  6647                              <4>  pxor xmmblock, xmm0
  6648                              <4>  %else
  6649                              <4>  %if round < 14
  6650 00000BB3 660F38DCE8          <4>  aesOPERATION xmmblock, xmm0
  6651                              <4>  %else
  6652                              <4>  aesOPERATIONlast xmmblock, xmm0
  6653                              <4>  %endif
  6654                              <4>  %endif
  6655                              <4> 
  6656                              <4>  %assign block block+1
  6657                              <4> 
  6658                              <4>  %if round = 0
  6659                              <4>  pxor xmmblock, xmm0
  6660                              <4>  %else
  6661                              <4>  %if round < 14
  6662 00000BB8 660F38DCF0          <4>  aesOPERATION xmmblock, xmm0
  6663                              <4>  %else
  6664                              <4>  aesOPERATIONlast xmmblock, xmm0
  6665                              <4>  %endif
  6666                              <4>  %endif
  6667                              <4> 
  6668                              <4>  %assign block block+1
  6669                              <4> 
  6670                              <4>  %if round = 0
  6671                              <4>  pxor xmmblock, xmm0
  6672                              <4>  %else
  6673                              <4>  %if round < 14
  6674 00000BBD 660F38DCF8          <4>  aesOPERATION xmmblock, xmm0
  6675                              <4>  %else
  6676                              <4>  aesOPERATIONlast xmmblock, xmm0
  6677                              <4>  %endif
  6678                              <4>  %endif
  6679                              <4> 
  6680                              <4>  %assign block block+1
  6681                              <4> 
  6682                              <4>  %if round = 0
  6683                              <4>  pxor xmmblock, xmm0
  6684                              <4>  %else
  6685                              <4>  %if round < 14
  6686 00000BC2 66440F38DCC0        <4>  aesOPERATION xmmblock, xmm0
  6687                              <4>  %else
  6688                              <4>  aesOPERATIONlast xmmblock, xmm0
  6689                              <4>  %endif
  6690                              <4>  %endif
  6691                              <4> 
  6692                              <4>  %assign block block+1
  6693                              <4> 
  6694                              <4>  %if round = 0
  6695                              <4>  pxor xmmblock, xmm0
  6696                              <4>  %else
  6697                              <4>  %if round < 14
  6698 00000BC8 66440F38DCC8        <4>  aesOPERATION xmmblock, xmm0
  6699                              <4>  %else
  6700                              <4>  aesOPERATIONlast xmmblock, xmm0
  6701                              <4>  %endif
  6702                              <4>  %endif
  6703                              <4> 
  6704                              <4>  %assign block block+1
  6705                              <4> 
  6706                              <4>  %if round = 0
  6707                              <4>  pxor xmmblock, xmm0
  6708                              <4>  %else
  6709                              <4>  %if round < 14
  6710 00000BCE 66440F38DCD0        <4>  aesOPERATION xmmblock, xmm0
  6711                              <4>  %else
  6712                              <4>  aesOPERATIONlast xmmblock, xmm0
  6713                              <4>  %endif
  6714                              <4>  %endif
  6715                              <4> 
  6716                              <4>  %assign block block+1
  6717                              <4> 
  6718                              <4>  %if round = 0
  6719                              <4>  pxor xmmblock, xmm0
  6720                              <4>  %else
  6721                              <4>  %if round < 14
  6722 00000BD4 66440F38DCD8        <4>  aesOPERATION xmmblock, xmm0
  6723                              <4>  %else
  6724                              <4>  aesOPERATIONlast xmmblock, xmm0
  6725                              <4>  %endif
  6726                              <4>  %endif
  6727                              <4> 
  6728                              <4>  %assign block block+1
  6729                              <4> 
  6730                              <4>  %if round = 0
  6731                              <4>  pxor xmmblock, xmm0
  6732                              <4>  %else
  6733                              <4>  %if round < 14
  6734 00000BDA 66440F38DCE0        <4>  aesOPERATION xmmblock, xmm0
  6735                              <4>  %else
  6736                              <4>  aesOPERATIONlast xmmblock, xmm0
  6737                              <4>  %endif
  6738                              <4>  %endif
  6739                              <4> 
  6740                              <4>  %assign block block+1
  6741                              <4> 
  6742                              <4>  %if round = 0
  6743                              <4>  pxor xmmblock, xmm0
  6744                              <4>  %else
  6745                              <4>  %if round < 14
  6746 00000BE0 66440F38DCE8        <4>  aesOPERATION xmmblock, xmm0
  6747                              <4>  %else
  6748                              <4>  aesOPERATIONlast xmmblock, xmm0
  6749                              <4>  %endif
  6750                              <4>  %endif
  6751                              <4> 
  6752                              <4>  %assign block block+1
  6753                              <4> 
  6754                              <4>  %if round = 0
  6755                              <4>  pxor xmmblock, xmm0
  6756                              <4>  %else
  6757                              <4>  %if round < 14
  6758 00000BE6 66440F38DCF0        <4>  aesOPERATION xmmblock, xmm0
  6759                              <4>  %else
  6760                              <4>  aesOPERATIONlast xmmblock, xmm0
  6761                              <4>  %endif
  6762                              <4>  %endif
  6763                              <4> 
  6764                              <4>  %assign block block+1
  6765                              <4> 
  6766                              <4>  %if round = 0
  6767                              <4>  pxor xmmblock, xmm0
  6768                              <4>  %else
  6769                              <4>  %if round < 14
  6770 00000BEC 66440F38DCF8        <4>  aesOPERATION xmmblock, xmm0
  6771                              <4>  %else
  6772                              <4>  aesOPERATIONlast xmmblock, xmm0
  6773                              <4>  %endif
  6774                              <4>  %endif
  6775                              <4> 
  6776                              <4>  %assign block block+1
  6777                              <3> 
  6778                              <3>  %assign round round+1
  6779 00000BF2 F30F6F4160          <3>  movdqu xmm0, [Rcx + 16 * round]
  6780                              <3> 
  6781                              <3>  %assign block 1
  6782                              <3>  %rep BLOCK_COUNT
  6783                              <3> 
  6784                              <3>  %if round = 0
  6785                              <3>  pxor xmmblock, xmm0
  6786                              <3>  %else
  6787                              <3>  %if round < 14
  6788                              <3>  aesOPERATION xmmblock, xmm0
  6789                              <3>  %else
  6790                              <3>  aesOPERATIONlast xmmblock, xmm0
  6791                              <3>  %endif
  6792                              <3>  %endif
  6793                              <3> 
  6794                              <3>  %assign block block+1
  6795                              <3>  %endrep
  6796                              <4> 
  6797                              <4>  %if round = 0
  6798                              <4>  pxor xmmblock, xmm0
  6799                              <4>  %else
  6800                              <4>  %if round < 14
  6801 00000BF7 660F38DCC8          <4>  aesOPERATION xmmblock, xmm0
  6802                              <4>  %else
  6803                              <4>  aesOPERATIONlast xmmblock, xmm0
  6804                              <4>  %endif
  6805                              <4>  %endif
  6806                              <4> 
  6807                              <4>  %assign block block+1
  6808                              <4> 
  6809                              <4>  %if round = 0
  6810                              <4>  pxor xmmblock, xmm0
  6811                              <4>  %else
  6812                              <4>  %if round < 14
  6813 00000BFC 660F38DCD0          <4>  aesOPERATION xmmblock, xmm0
  6814                              <4>  %else
  6815                              <4>  aesOPERATIONlast xmmblock, xmm0
  6816                              <4>  %endif
  6817                              <4>  %endif
  6818                              <4> 
  6819                              <4>  %assign block block+1
  6820                              <4> 
  6821                              <4>  %if round = 0
  6822                              <4>  pxor xmmblock, xmm0
  6823                              <4>  %else
  6824                              <4>  %if round < 14
  6825 00000C01 660F38DCD8          <4>  aesOPERATION xmmblock, xmm0
  6826                              <4>  %else
  6827                              <4>  aesOPERATIONlast xmmblock, xmm0
  6828                              <4>  %endif
  6829                              <4>  %endif
  6830                              <4> 
  6831                              <4>  %assign block block+1
  6832                              <4> 
  6833                              <4>  %if round = 0
  6834                              <4>  pxor xmmblock, xmm0
  6835                              <4>  %else
  6836                              <4>  %if round < 14
  6837 00000C06 660F38DCE0          <4>  aesOPERATION xmmblock, xmm0
  6838                              <4>  %else
  6839                              <4>  aesOPERATIONlast xmmblock, xmm0
  6840                              <4>  %endif
  6841                              <4>  %endif
  6842                              <4> 
  6843                              <4>  %assign block block+1
  6844                              <4> 
  6845                              <4>  %if round = 0
  6846                              <4>  pxor xmmblock, xmm0
  6847                              <4>  %else
  6848                              <4>  %if round < 14
  6849 00000C0B 660F38DCE8          <4>  aesOPERATION xmmblock, xmm0
  6850                              <4>  %else
  6851                              <4>  aesOPERATIONlast xmmblock, xmm0
  6852                              <4>  %endif
  6853                              <4>  %endif
  6854                              <4> 
  6855                              <4>  %assign block block+1
  6856                              <4> 
  6857                              <4>  %if round = 0
  6858                              <4>  pxor xmmblock, xmm0
  6859                              <4>  %else
  6860                              <4>  %if round < 14
  6861 00000C10 660F38DCF0          <4>  aesOPERATION xmmblock, xmm0
  6862                              <4>  %else
  6863                              <4>  aesOPERATIONlast xmmblock, xmm0
  6864                              <4>  %endif
  6865                              <4>  %endif
  6866                              <4> 
  6867                              <4>  %assign block block+1
  6868                              <4> 
  6869                              <4>  %if round = 0
  6870                              <4>  pxor xmmblock, xmm0
  6871                              <4>  %else
  6872                              <4>  %if round < 14
  6873 00000C15 660F38DCF8          <4>  aesOPERATION xmmblock, xmm0
  6874                              <4>  %else
  6875                              <4>  aesOPERATIONlast xmmblock, xmm0
  6876                              <4>  %endif
  6877                              <4>  %endif
  6878                              <4> 
  6879                              <4>  %assign block block+1
  6880                              <4> 
  6881                              <4>  %if round = 0
  6882                              <4>  pxor xmmblock, xmm0
  6883                              <4>  %else
  6884                              <4>  %if round < 14
  6885 00000C1A 66440F38DCC0        <4>  aesOPERATION xmmblock, xmm0
  6886                              <4>  %else
  6887                              <4>  aesOPERATIONlast xmmblock, xmm0
  6888                              <4>  %endif
  6889                              <4>  %endif
  6890                              <4> 
  6891                              <4>  %assign block block+1
  6892                              <4> 
  6893                              <4>  %if round = 0
  6894                              <4>  pxor xmmblock, xmm0
  6895                              <4>  %else
  6896                              <4>  %if round < 14
  6897 00000C20 66440F38DCC8        <4>  aesOPERATION xmmblock, xmm0
  6898                              <4>  %else
  6899                              <4>  aesOPERATIONlast xmmblock, xmm0
  6900                              <4>  %endif
  6901                              <4>  %endif
  6902                              <4> 
  6903                              <4>  %assign block block+1
  6904                              <4> 
  6905                              <4>  %if round = 0
  6906                              <4>  pxor xmmblock, xmm0
  6907                              <4>  %else
  6908                              <4>  %if round < 14
  6909 00000C26 66440F38DCD0        <4>  aesOPERATION xmmblock, xmm0
  6910                              <4>  %else
  6911                              <4>  aesOPERATIONlast xmmblock, xmm0
  6912                              <4>  %endif
  6913                              <4>  %endif
  6914                              <4> 
  6915                              <4>  %assign block block+1
  6916                              <4> 
  6917                              <4>  %if round = 0
  6918                              <4>  pxor xmmblock, xmm0
  6919                              <4>  %else
  6920                              <4>  %if round < 14
  6921 00000C2C 66440F38DCD8        <4>  aesOPERATION xmmblock, xmm0
  6922                              <4>  %else
  6923                              <4>  aesOPERATIONlast xmmblock, xmm0
  6924                              <4>  %endif
  6925                              <4>  %endif
  6926                              <4> 
  6927                              <4>  %assign block block+1
  6928                              <4> 
  6929                              <4>  %if round = 0
  6930                              <4>  pxor xmmblock, xmm0
  6931                              <4>  %else
  6932                              <4>  %if round < 14
  6933 00000C32 66440F38DCE0        <4>  aesOPERATION xmmblock, xmm0
  6934                              <4>  %else
  6935                              <4>  aesOPERATIONlast xmmblock, xmm0
  6936                              <4>  %endif
  6937                              <4>  %endif
  6938                              <4> 
  6939                              <4>  %assign block block+1
  6940                              <4> 
  6941                              <4>  %if round = 0
  6942                              <4>  pxor xmmblock, xmm0
  6943                              <4>  %else
  6944                              <4>  %if round < 14
  6945 00000C38 66440F38DCE8        <4>  aesOPERATION xmmblock, xmm0
  6946                              <4>  %else
  6947                              <4>  aesOPERATIONlast xmmblock, xmm0
  6948                              <4>  %endif
  6949                              <4>  %endif
  6950                              <4> 
  6951                              <4>  %assign block block+1
  6952                              <4> 
  6953                              <4>  %if round = 0
  6954                              <4>  pxor xmmblock, xmm0
  6955                              <4>  %else
  6956                              <4>  %if round < 14
  6957 00000C3E 66440F38DCF0        <4>  aesOPERATION xmmblock, xmm0
  6958                              <4>  %else
  6959                              <4>  aesOPERATIONlast xmmblock, xmm0
  6960                              <4>  %endif
  6961                              <4>  %endif
  6962                              <4> 
  6963                              <4>  %assign block block+1
  6964                              <4> 
  6965                              <4>  %if round = 0
  6966                              <4>  pxor xmmblock, xmm0
  6967                              <4>  %else
  6968                              <4>  %if round < 14
  6969 00000C44 66440F38DCF8        <4>  aesOPERATION xmmblock, xmm0
  6970                              <4>  %else
  6971                              <4>  aesOPERATIONlast xmmblock, xmm0
  6972                              <4>  %endif
  6973                              <4>  %endif
  6974                              <4> 
  6975                              <4>  %assign block block+1
  6976                              <3> 
  6977                              <3>  %assign round round+1
  6978 00000C4A F30F6F4170          <3>  movdqu xmm0, [Rcx + 16 * round]
  6979                              <3> 
  6980                              <3>  %assign block 1
  6981                              <3>  %rep BLOCK_COUNT
  6982                              <3> 
  6983                              <3>  %if round = 0
  6984                              <3>  pxor xmmblock, xmm0
  6985                              <3>  %else
  6986                              <3>  %if round < 14
  6987                              <3>  aesOPERATION xmmblock, xmm0
  6988                              <3>  %else
  6989                              <3>  aesOPERATIONlast xmmblock, xmm0
  6990                              <3>  %endif
  6991                              <3>  %endif
  6992                              <3> 
  6993                              <3>  %assign block block+1
  6994                              <3>  %endrep
  6995                              <4> 
  6996                              <4>  %if round = 0
  6997                              <4>  pxor xmmblock, xmm0
  6998                              <4>  %else
  6999                              <4>  %if round < 14
  7000 00000C4F 660F38DCC8          <4>  aesOPERATION xmmblock, xmm0
  7001                              <4>  %else
  7002                              <4>  aesOPERATIONlast xmmblock, xmm0
  7003                              <4>  %endif
  7004                              <4>  %endif
  7005                              <4> 
  7006                              <4>  %assign block block+1
  7007                              <4> 
  7008                              <4>  %if round = 0
  7009                              <4>  pxor xmmblock, xmm0
  7010                              <4>  %else
  7011                              <4>  %if round < 14
  7012 00000C54 660F38DCD0          <4>  aesOPERATION xmmblock, xmm0
  7013                              <4>  %else
  7014                              <4>  aesOPERATIONlast xmmblock, xmm0
  7015                              <4>  %endif
  7016                              <4>  %endif
  7017                              <4> 
  7018                              <4>  %assign block block+1
  7019                              <4> 
  7020                              <4>  %if round = 0
  7021                              <4>  pxor xmmblock, xmm0
  7022                              <4>  %else
  7023                              <4>  %if round < 14
  7024 00000C59 660F38DCD8          <4>  aesOPERATION xmmblock, xmm0
  7025                              <4>  %else
  7026                              <4>  aesOPERATIONlast xmmblock, xmm0
  7027                              <4>  %endif
  7028                              <4>  %endif
  7029                              <4> 
  7030                              <4>  %assign block block+1
  7031                              <4> 
  7032                              <4>  %if round = 0
  7033                              <4>  pxor xmmblock, xmm0
  7034                              <4>  %else
  7035                              <4>  %if round < 14
  7036 00000C5E 660F38DCE0          <4>  aesOPERATION xmmblock, xmm0
  7037                              <4>  %else
  7038                              <4>  aesOPERATIONlast xmmblock, xmm0
  7039                              <4>  %endif
  7040                              <4>  %endif
  7041                              <4> 
  7042                              <4>  %assign block block+1
  7043                              <4> 
  7044                              <4>  %if round = 0
  7045                              <4>  pxor xmmblock, xmm0
  7046                              <4>  %else
  7047                              <4>  %if round < 14
  7048 00000C63 660F38DCE8          <4>  aesOPERATION xmmblock, xmm0
  7049                              <4>  %else
  7050                              <4>  aesOPERATIONlast xmmblock, xmm0
  7051                              <4>  %endif
  7052                              <4>  %endif
  7053                              <4> 
  7054                              <4>  %assign block block+1
  7055                              <4> 
  7056                              <4>  %if round = 0
  7057                              <4>  pxor xmmblock, xmm0
  7058                              <4>  %else
  7059                              <4>  %if round < 14
  7060 00000C68 660F38DCF0          <4>  aesOPERATION xmmblock, xmm0
  7061                              <4>  %else
  7062                              <4>  aesOPERATIONlast xmmblock, xmm0
  7063                              <4>  %endif
  7064                              <4>  %endif
  7065                              <4> 
  7066                              <4>  %assign block block+1
  7067                              <4> 
  7068                              <4>  %if round = 0
  7069                              <4>  pxor xmmblock, xmm0
  7070                              <4>  %else
  7071                              <4>  %if round < 14
  7072 00000C6D 660F38DCF8          <4>  aesOPERATION xmmblock, xmm0
  7073                              <4>  %else
  7074                              <4>  aesOPERATIONlast xmmblock, xmm0
  7075                              <4>  %endif
  7076                              <4>  %endif
  7077                              <4> 
  7078                              <4>  %assign block block+1
  7079                              <4> 
  7080                              <4>  %if round = 0
  7081                              <4>  pxor xmmblock, xmm0
  7082                              <4>  %else
  7083                              <4>  %if round < 14
  7084 00000C72 66440F38DCC0        <4>  aesOPERATION xmmblock, xmm0
  7085                              <4>  %else
  7086                              <4>  aesOPERATIONlast xmmblock, xmm0
  7087                              <4>  %endif
  7088                              <4>  %endif
  7089                              <4> 
  7090                              <4>  %assign block block+1
  7091                              <4> 
  7092                              <4>  %if round = 0
  7093                              <4>  pxor xmmblock, xmm0
  7094                              <4>  %else
  7095                              <4>  %if round < 14
  7096 00000C78 66440F38DCC8        <4>  aesOPERATION xmmblock, xmm0
  7097                              <4>  %else
  7098                              <4>  aesOPERATIONlast xmmblock, xmm0
  7099                              <4>  %endif
  7100                              <4>  %endif
  7101                              <4> 
  7102                              <4>  %assign block block+1
  7103                              <4> 
  7104                              <4>  %if round = 0
  7105                              <4>  pxor xmmblock, xmm0
  7106                              <4>  %else
  7107                              <4>  %if round < 14
  7108 00000C7E 66440F38DCD0        <4>  aesOPERATION xmmblock, xmm0
  7109                              <4>  %else
  7110                              <4>  aesOPERATIONlast xmmblock, xmm0
  7111                              <4>  %endif
  7112                              <4>  %endif
  7113                              <4> 
  7114                              <4>  %assign block block+1
  7115                              <4> 
  7116                              <4>  %if round = 0
  7117                              <4>  pxor xmmblock, xmm0
  7118                              <4>  %else
  7119                              <4>  %if round < 14
  7120 00000C84 66440F38DCD8        <4>  aesOPERATION xmmblock, xmm0
  7121                              <4>  %else
  7122                              <4>  aesOPERATIONlast xmmblock, xmm0
  7123                              <4>  %endif
  7124                              <4>  %endif
  7125                              <4> 
  7126                              <4>  %assign block block+1
  7127                              <4> 
  7128                              <4>  %if round = 0
  7129                              <4>  pxor xmmblock, xmm0
  7130                              <4>  %else
  7131                              <4>  %if round < 14
  7132 00000C8A 66440F38DCE0        <4>  aesOPERATION xmmblock, xmm0
  7133                              <4>  %else
  7134                              <4>  aesOPERATIONlast xmmblock, xmm0
  7135                              <4>  %endif
  7136                              <4>  %endif
  7137                              <4> 
  7138                              <4>  %assign block block+1
  7139                              <4> 
  7140                              <4>  %if round = 0
  7141                              <4>  pxor xmmblock, xmm0
  7142                              <4>  %else
  7143                              <4>  %if round < 14
  7144 00000C90 66440F38DCE8        <4>  aesOPERATION xmmblock, xmm0
  7145                              <4>  %else
  7146                              <4>  aesOPERATIONlast xmmblock, xmm0
  7147                              <4>  %endif
  7148                              <4>  %endif
  7149                              <4> 
  7150                              <4>  %assign block block+1
  7151                              <4> 
  7152                              <4>  %if round = 0
  7153                              <4>  pxor xmmblock, xmm0
  7154                              <4>  %else
  7155                              <4>  %if round < 14
  7156 00000C96 66440F38DCF0        <4>  aesOPERATION xmmblock, xmm0
  7157                              <4>  %else
  7158                              <4>  aesOPERATIONlast xmmblock, xmm0
  7159                              <4>  %endif
  7160                              <4>  %endif
  7161                              <4> 
  7162                              <4>  %assign block block+1
  7163                              <4> 
  7164                              <4>  %if round = 0
  7165                              <4>  pxor xmmblock, xmm0
  7166                              <4>  %else
  7167                              <4>  %if round < 14
  7168 00000C9C 66440F38DCF8        <4>  aesOPERATION xmmblock, xmm0
  7169                              <4>  %else
  7170                              <4>  aesOPERATIONlast xmmblock, xmm0
  7171                              <4>  %endif
  7172                              <4>  %endif
  7173                              <4> 
  7174                              <4>  %assign block block+1
  7175                              <3> 
  7176                              <3>  %assign round round+1
  7177 00000CA2 F30F6F8180000000    <3>  movdqu xmm0, [Rcx + 16 * round]
  7178                              <3> 
  7179                              <3>  %assign block 1
  7180                              <3>  %rep BLOCK_COUNT
  7181                              <3> 
  7182                              <3>  %if round = 0
  7183                              <3>  pxor xmmblock, xmm0
  7184                              <3>  %else
  7185                              <3>  %if round < 14
  7186                              <3>  aesOPERATION xmmblock, xmm0
  7187                              <3>  %else
  7188                              <3>  aesOPERATIONlast xmmblock, xmm0
  7189                              <3>  %endif
  7190                              <3>  %endif
  7191                              <3> 
  7192                              <3>  %assign block block+1
  7193                              <3>  %endrep
  7194                              <4> 
  7195                              <4>  %if round = 0
  7196                              <4>  pxor xmmblock, xmm0
  7197                              <4>  %else
  7198                              <4>  %if round < 14
  7199 00000CAA 660F38DCC8          <4>  aesOPERATION xmmblock, xmm0
  7200                              <4>  %else
  7201                              <4>  aesOPERATIONlast xmmblock, xmm0
  7202                              <4>  %endif
  7203                              <4>  %endif
  7204                              <4> 
  7205                              <4>  %assign block block+1
  7206                              <4> 
  7207                              <4>  %if round = 0
  7208                              <4>  pxor xmmblock, xmm0
  7209                              <4>  %else
  7210                              <4>  %if round < 14
  7211 00000CAF 660F38DCD0          <4>  aesOPERATION xmmblock, xmm0
  7212                              <4>  %else
  7213                              <4>  aesOPERATIONlast xmmblock, xmm0
  7214                              <4>  %endif
  7215                              <4>  %endif
  7216                              <4> 
  7217                              <4>  %assign block block+1
  7218                              <4> 
  7219                              <4>  %if round = 0
  7220                              <4>  pxor xmmblock, xmm0
  7221                              <4>  %else
  7222                              <4>  %if round < 14
  7223 00000CB4 660F38DCD8          <4>  aesOPERATION xmmblock, xmm0
  7224                              <4>  %else
  7225                              <4>  aesOPERATIONlast xmmblock, xmm0
  7226                              <4>  %endif
  7227                              <4>  %endif
  7228                              <4> 
  7229                              <4>  %assign block block+1
  7230                              <4> 
  7231                              <4>  %if round = 0
  7232                              <4>  pxor xmmblock, xmm0
  7233                              <4>  %else
  7234                              <4>  %if round < 14
  7235 00000CB9 660F38DCE0          <4>  aesOPERATION xmmblock, xmm0
  7236                              <4>  %else
  7237                              <4>  aesOPERATIONlast xmmblock, xmm0
  7238                              <4>  %endif
  7239                              <4>  %endif
  7240                              <4> 
  7241                              <4>  %assign block block+1
  7242                              <4> 
  7243                              <4>  %if round = 0
  7244                              <4>  pxor xmmblock, xmm0
  7245                              <4>  %else
  7246                              <4>  %if round < 14
  7247 00000CBE 660F38DCE8          <4>  aesOPERATION xmmblock, xmm0
  7248                              <4>  %else
  7249                              <4>  aesOPERATIONlast xmmblock, xmm0
  7250                              <4>  %endif
  7251                              <4>  %endif
  7252                              <4> 
  7253                              <4>  %assign block block+1
  7254                              <4> 
  7255                              <4>  %if round = 0
  7256                              <4>  pxor xmmblock, xmm0
  7257                              <4>  %else
  7258                              <4>  %if round < 14
  7259 00000CC3 660F38DCF0          <4>  aesOPERATION xmmblock, xmm0
  7260                              <4>  %else
  7261                              <4>  aesOPERATIONlast xmmblock, xmm0
  7262                              <4>  %endif
  7263                              <4>  %endif
  7264                              <4> 
  7265                              <4>  %assign block block+1
  7266                              <4> 
  7267                              <4>  %if round = 0
  7268                              <4>  pxor xmmblock, xmm0
  7269                              <4>  %else
  7270                              <4>  %if round < 14
  7271 00000CC8 660F38DCF8          <4>  aesOPERATION xmmblock, xmm0
  7272                              <4>  %else
  7273                              <4>  aesOPERATIONlast xmmblock, xmm0
  7274                              <4>  %endif
  7275                              <4>  %endif
  7276                              <4> 
  7277                              <4>  %assign block block+1
  7278                              <4> 
  7279                              <4>  %if round = 0
  7280                              <4>  pxor xmmblock, xmm0
  7281                              <4>  %else
  7282                              <4>  %if round < 14
  7283 00000CCD 66440F38DCC0        <4>  aesOPERATION xmmblock, xmm0
  7284                              <4>  %else
  7285                              <4>  aesOPERATIONlast xmmblock, xmm0
  7286                              <4>  %endif
  7287                              <4>  %endif
  7288                              <4> 
  7289                              <4>  %assign block block+1
  7290                              <4> 
  7291                              <4>  %if round = 0
  7292                              <4>  pxor xmmblock, xmm0
  7293                              <4>  %else
  7294                              <4>  %if round < 14
  7295 00000CD3 66440F38DCC8        <4>  aesOPERATION xmmblock, xmm0
  7296                              <4>  %else
  7297                              <4>  aesOPERATIONlast xmmblock, xmm0
  7298                              <4>  %endif
  7299                              <4>  %endif
  7300                              <4> 
  7301                              <4>  %assign block block+1
  7302                              <4> 
  7303                              <4>  %if round = 0
  7304                              <4>  pxor xmmblock, xmm0
  7305                              <4>  %else
  7306                              <4>  %if round < 14
  7307 00000CD9 66440F38DCD0        <4>  aesOPERATION xmmblock, xmm0
  7308                              <4>  %else
  7309                              <4>  aesOPERATIONlast xmmblock, xmm0
  7310                              <4>  %endif
  7311                              <4>  %endif
  7312                              <4> 
  7313                              <4>  %assign block block+1
  7314                              <4> 
  7315                              <4>  %if round = 0
  7316                              <4>  pxor xmmblock, xmm0
  7317                              <4>  %else
  7318                              <4>  %if round < 14
  7319 00000CDF 66440F38DCD8        <4>  aesOPERATION xmmblock, xmm0
  7320                              <4>  %else
  7321                              <4>  aesOPERATIONlast xmmblock, xmm0
  7322                              <4>  %endif
  7323                              <4>  %endif
  7324                              <4> 
  7325                              <4>  %assign block block+1
  7326                              <4> 
  7327                              <4>  %if round = 0
  7328                              <4>  pxor xmmblock, xmm0
  7329                              <4>  %else
  7330                              <4>  %if round < 14
  7331 00000CE5 66440F38DCE0        <4>  aesOPERATION xmmblock, xmm0
  7332                              <4>  %else
  7333                              <4>  aesOPERATIONlast xmmblock, xmm0
  7334                              <4>  %endif
  7335                              <4>  %endif
  7336                              <4> 
  7337                              <4>  %assign block block+1
  7338                              <4> 
  7339                              <4>  %if round = 0
  7340                              <4>  pxor xmmblock, xmm0
  7341                              <4>  %else
  7342                              <4>  %if round < 14
  7343 00000CEB 66440F38DCE8        <4>  aesOPERATION xmmblock, xmm0
  7344                              <4>  %else
  7345                              <4>  aesOPERATIONlast xmmblock, xmm0
  7346                              <4>  %endif
  7347                              <4>  %endif
  7348                              <4> 
  7349                              <4>  %assign block block+1
  7350                              <4> 
  7351                              <4>  %if round = 0
  7352                              <4>  pxor xmmblock, xmm0
  7353                              <4>  %else
  7354                              <4>  %if round < 14
  7355 00000CF1 66440F38DCF0        <4>  aesOPERATION xmmblock, xmm0
  7356                              <4>  %else
  7357                              <4>  aesOPERATIONlast xmmblock, xmm0
  7358                              <4>  %endif
  7359                              <4>  %endif
  7360                              <4> 
  7361                              <4>  %assign block block+1
  7362                              <4> 
  7363                              <4>  %if round = 0
  7364                              <4>  pxor xmmblock, xmm0
  7365                              <4>  %else
  7366                              <4>  %if round < 14
  7367 00000CF7 66440F38DCF8        <4>  aesOPERATION xmmblock, xmm0
  7368                              <4>  %else
  7369                              <4>  aesOPERATIONlast xmmblock, xmm0
  7370                              <4>  %endif
  7371                              <4>  %endif
  7372                              <4> 
  7373                              <4>  %assign block block+1
  7374                              <3> 
  7375                              <3>  %assign round round+1
  7376 00000CFD F30F6F8190000000    <3>  movdqu xmm0, [Rcx + 16 * round]
  7377                              <3> 
  7378                              <3>  %assign block 1
  7379                              <3>  %rep BLOCK_COUNT
  7380                              <3> 
  7381                              <3>  %if round = 0
  7382                              <3>  pxor xmmblock, xmm0
  7383                              <3>  %else
  7384                              <3>  %if round < 14
  7385                              <3>  aesOPERATION xmmblock, xmm0
  7386                              <3>  %else
  7387                              <3>  aesOPERATIONlast xmmblock, xmm0
  7388                              <3>  %endif
  7389                              <3>  %endif
  7390                              <3> 
  7391                              <3>  %assign block block+1
  7392                              <3>  %endrep
  7393                              <4> 
  7394                              <4>  %if round = 0
  7395                              <4>  pxor xmmblock, xmm0
  7396                              <4>  %else
  7397                              <4>  %if round < 14
  7398 00000D05 660F38DCC8          <4>  aesOPERATION xmmblock, xmm0
  7399                              <4>  %else
  7400                              <4>  aesOPERATIONlast xmmblock, xmm0
  7401                              <4>  %endif
  7402                              <4>  %endif
  7403                              <4> 
  7404                              <4>  %assign block block+1
  7405                              <4> 
  7406                              <4>  %if round = 0
  7407                              <4>  pxor xmmblock, xmm0
  7408                              <4>  %else
  7409                              <4>  %if round < 14
  7410 00000D0A 660F38DCD0          <4>  aesOPERATION xmmblock, xmm0
  7411                              <4>  %else
  7412                              <4>  aesOPERATIONlast xmmblock, xmm0
  7413                              <4>  %endif
  7414                              <4>  %endif
  7415                              <4> 
  7416                              <4>  %assign block block+1
  7417                              <4> 
  7418                              <4>  %if round = 0
  7419                              <4>  pxor xmmblock, xmm0
  7420                              <4>  %else
  7421                              <4>  %if round < 14
  7422 00000D0F 660F38DCD8          <4>  aesOPERATION xmmblock, xmm0
  7423                              <4>  %else
  7424                              <4>  aesOPERATIONlast xmmblock, xmm0
  7425                              <4>  %endif
  7426                              <4>  %endif
  7427                              <4> 
  7428                              <4>  %assign block block+1
  7429                              <4> 
  7430                              <4>  %if round = 0
  7431                              <4>  pxor xmmblock, xmm0
  7432                              <4>  %else
  7433                              <4>  %if round < 14
  7434 00000D14 660F38DCE0          <4>  aesOPERATION xmmblock, xmm0
  7435                              <4>  %else
  7436                              <4>  aesOPERATIONlast xmmblock, xmm0
  7437                              <4>  %endif
  7438                              <4>  %endif
  7439                              <4> 
  7440                              <4>  %assign block block+1
  7441                              <4> 
  7442                              <4>  %if round = 0
  7443                              <4>  pxor xmmblock, xmm0
  7444                              <4>  %else
  7445                              <4>  %if round < 14
  7446 00000D19 660F38DCE8          <4>  aesOPERATION xmmblock, xmm0
  7447                              <4>  %else
  7448                              <4>  aesOPERATIONlast xmmblock, xmm0
  7449                              <4>  %endif
  7450                              <4>  %endif
  7451                              <4> 
  7452                              <4>  %assign block block+1
  7453                              <4> 
  7454                              <4>  %if round = 0
  7455                              <4>  pxor xmmblock, xmm0
  7456                              <4>  %else
  7457                              <4>  %if round < 14
  7458 00000D1E 660F38DCF0          <4>  aesOPERATION xmmblock, xmm0
  7459                              <4>  %else
  7460                              <4>  aesOPERATIONlast xmmblock, xmm0
  7461                              <4>  %endif
  7462                              <4>  %endif
  7463                              <4> 
  7464                              <4>  %assign block block+1
  7465                              <4> 
  7466                              <4>  %if round = 0
  7467                              <4>  pxor xmmblock, xmm0
  7468                              <4>  %else
  7469                              <4>  %if round < 14
  7470 00000D23 660F38DCF8          <4>  aesOPERATION xmmblock, xmm0
  7471                              <4>  %else
  7472                              <4>  aesOPERATIONlast xmmblock, xmm0
  7473                              <4>  %endif
  7474                              <4>  %endif
  7475                              <4> 
  7476                              <4>  %assign block block+1
  7477                              <4> 
  7478                              <4>  %if round = 0
  7479                              <4>  pxor xmmblock, xmm0
  7480                              <4>  %else
  7481                              <4>  %if round < 14
  7482 00000D28 66440F38DCC0        <4>  aesOPERATION xmmblock, xmm0
  7483                              <4>  %else
  7484                              <4>  aesOPERATIONlast xmmblock, xmm0
  7485                              <4>  %endif
  7486                              <4>  %endif
  7487                              <4> 
  7488                              <4>  %assign block block+1
  7489                              <4> 
  7490                              <4>  %if round = 0
  7491                              <4>  pxor xmmblock, xmm0
  7492                              <4>  %else
  7493                              <4>  %if round < 14
  7494 00000D2E 66440F38DCC8        <4>  aesOPERATION xmmblock, xmm0
  7495                              <4>  %else
  7496                              <4>  aesOPERATIONlast xmmblock, xmm0
  7497                              <4>  %endif
  7498                              <4>  %endif
  7499                              <4> 
  7500                              <4>  %assign block block+1
  7501                              <4> 
  7502                              <4>  %if round = 0
  7503                              <4>  pxor xmmblock, xmm0
  7504                              <4>  %else
  7505                              <4>  %if round < 14
  7506 00000D34 66440F38DCD0        <4>  aesOPERATION xmmblock, xmm0
  7507                              <4>  %else
  7508                              <4>  aesOPERATIONlast xmmblock, xmm0
  7509                              <4>  %endif
  7510                              <4>  %endif
  7511                              <4> 
  7512                              <4>  %assign block block+1
  7513                              <4> 
  7514                              <4>  %if round = 0
  7515                              <4>  pxor xmmblock, xmm0
  7516                              <4>  %else
  7517                              <4>  %if round < 14
  7518 00000D3A 66440F38DCD8        <4>  aesOPERATION xmmblock, xmm0
  7519                              <4>  %else
  7520                              <4>  aesOPERATIONlast xmmblock, xmm0
  7521                              <4>  %endif
  7522                              <4>  %endif
  7523                              <4> 
  7524                              <4>  %assign block block+1
  7525                              <4> 
  7526                              <4>  %if round = 0
  7527                              <4>  pxor xmmblock, xmm0
  7528                              <4>  %else
  7529                              <4>  %if round < 14
  7530 00000D40 66440F38DCE0        <4>  aesOPERATION xmmblock, xmm0
  7531                              <4>  %else
  7532                              <4>  aesOPERATIONlast xmmblock, xmm0
  7533                              <4>  %endif
  7534                              <4>  %endif
  7535                              <4> 
  7536                              <4>  %assign block block+1
  7537                              <4> 
  7538                              <4>  %if round = 0
  7539                              <4>  pxor xmmblock, xmm0
  7540                              <4>  %else
  7541                              <4>  %if round < 14
  7542 00000D46 66440F38DCE8        <4>  aesOPERATION xmmblock, xmm0
  7543                              <4>  %else
  7544                              <4>  aesOPERATIONlast xmmblock, xmm0
  7545                              <4>  %endif
  7546                              <4>  %endif
  7547                              <4> 
  7548                              <4>  %assign block block+1
  7549                              <4> 
  7550                              <4>  %if round = 0
  7551                              <4>  pxor xmmblock, xmm0
  7552                              <4>  %else
  7553                              <4>  %if round < 14
  7554 00000D4C 66440F38DCF0        <4>  aesOPERATION xmmblock, xmm0
  7555                              <4>  %else
  7556                              <4>  aesOPERATIONlast xmmblock, xmm0
  7557                              <4>  %endif
  7558                              <4>  %endif
  7559                              <4> 
  7560                              <4>  %assign block block+1
  7561                              <4> 
  7562                              <4>  %if round = 0
  7563                              <4>  pxor xmmblock, xmm0
  7564                              <4>  %else
  7565                              <4>  %if round < 14
  7566 00000D52 66440F38DCF8        <4>  aesOPERATION xmmblock, xmm0
  7567                              <4>  %else
  7568                              <4>  aesOPERATIONlast xmmblock, xmm0
  7569                              <4>  %endif
  7570                              <4>  %endif
  7571                              <4> 
  7572                              <4>  %assign block block+1
  7573                              <3> 
  7574                              <3>  %assign round round+1
  7575 00000D58 F30F6F81A0000000    <3>  movdqu xmm0, [Rcx + 16 * round]
  7576                              <3> 
  7577                              <3>  %assign block 1
  7578                              <3>  %rep BLOCK_COUNT
  7579                              <3> 
  7580                              <3>  %if round = 0
  7581                              <3>  pxor xmmblock, xmm0
  7582                              <3>  %else
  7583                              <3>  %if round < 14
  7584                              <3>  aesOPERATION xmmblock, xmm0
  7585                              <3>  %else
  7586                              <3>  aesOPERATIONlast xmmblock, xmm0
  7587                              <3>  %endif
  7588                              <3>  %endif
  7589                              <3> 
  7590                              <3>  %assign block block+1
  7591                              <3>  %endrep
  7592                              <4> 
  7593                              <4>  %if round = 0
  7594                              <4>  pxor xmmblock, xmm0
  7595                              <4>  %else
  7596                              <4>  %if round < 14
  7597 00000D60 660F38DCC8          <4>  aesOPERATION xmmblock, xmm0
  7598                              <4>  %else
  7599                              <4>  aesOPERATIONlast xmmblock, xmm0
  7600                              <4>  %endif
  7601                              <4>  %endif
  7602                              <4> 
  7603                              <4>  %assign block block+1
  7604                              <4> 
  7605                              <4>  %if round = 0
  7606                              <4>  pxor xmmblock, xmm0
  7607                              <4>  %else
  7608                              <4>  %if round < 14
  7609 00000D65 660F38DCD0          <4>  aesOPERATION xmmblock, xmm0
  7610                              <4>  %else
  7611                              <4>  aesOPERATIONlast xmmblock, xmm0
  7612                              <4>  %endif
  7613                              <4>  %endif
  7614                              <4> 
  7615                              <4>  %assign block block+1
  7616                              <4> 
  7617                              <4>  %if round = 0
  7618                              <4>  pxor xmmblock, xmm0
  7619                              <4>  %else
  7620                              <4>  %if round < 14
  7621 00000D6A 660F38DCD8          <4>  aesOPERATION xmmblock, xmm0
  7622                              <4>  %else
  7623                              <4>  aesOPERATIONlast xmmblock, xmm0
  7624                              <4>  %endif
  7625                              <4>  %endif
  7626                              <4> 
  7627                              <4>  %assign block block+1
  7628                              <4> 
  7629                              <4>  %if round = 0
  7630                              <4>  pxor xmmblock, xmm0
  7631                              <4>  %else
  7632                              <4>  %if round < 14
  7633 00000D6F 660F38DCE0          <4>  aesOPERATION xmmblock, xmm0
  7634                              <4>  %else
  7635                              <4>  aesOPERATIONlast xmmblock, xmm0
  7636                              <4>  %endif
  7637                              <4>  %endif
  7638                              <4> 
  7639                              <4>  %assign block block+1
  7640                              <4> 
  7641                              <4>  %if round = 0
  7642                              <4>  pxor xmmblock, xmm0
  7643                              <4>  %else
  7644                              <4>  %if round < 14
  7645 00000D74 660F38DCE8          <4>  aesOPERATION xmmblock, xmm0
  7646                              <4>  %else
  7647                              <4>  aesOPERATIONlast xmmblock, xmm0
  7648                              <4>  %endif
  7649                              <4>  %endif
  7650                              <4> 
  7651                              <4>  %assign block block+1
  7652                              <4> 
  7653                              <4>  %if round = 0
  7654                              <4>  pxor xmmblock, xmm0
  7655                              <4>  %else
  7656                              <4>  %if round < 14
  7657 00000D79 660F38DCF0          <4>  aesOPERATION xmmblock, xmm0
  7658                              <4>  %else
  7659                              <4>  aesOPERATIONlast xmmblock, xmm0
  7660                              <4>  %endif
  7661                              <4>  %endif
  7662                              <4> 
  7663                              <4>  %assign block block+1
  7664                              <4> 
  7665                              <4>  %if round = 0
  7666                              <4>  pxor xmmblock, xmm0
  7667                              <4>  %else
  7668                              <4>  %if round < 14
  7669 00000D7E 660F38DCF8          <4>  aesOPERATION xmmblock, xmm0
  7670                              <4>  %else
  7671                              <4>  aesOPERATIONlast xmmblock, xmm0
  7672                              <4>  %endif
  7673                              <4>  %endif
  7674                              <4> 
  7675                              <4>  %assign block block+1
  7676                              <4> 
  7677                              <4>  %if round = 0
  7678                              <4>  pxor xmmblock, xmm0
  7679                              <4>  %else
  7680                              <4>  %if round < 14
  7681 00000D83 66440F38DCC0        <4>  aesOPERATION xmmblock, xmm0
  7682                              <4>  %else
  7683                              <4>  aesOPERATIONlast xmmblock, xmm0
  7684                              <4>  %endif
  7685                              <4>  %endif
  7686                              <4> 
  7687                              <4>  %assign block block+1
  7688                              <4> 
  7689                              <4>  %if round = 0
  7690                              <4>  pxor xmmblock, xmm0
  7691                              <4>  %else
  7692                              <4>  %if round < 14
  7693 00000D89 66440F38DCC8        <4>  aesOPERATION xmmblock, xmm0
  7694                              <4>  %else
  7695                              <4>  aesOPERATIONlast xmmblock, xmm0
  7696                              <4>  %endif
  7697                              <4>  %endif
  7698                              <4> 
  7699                              <4>  %assign block block+1
  7700                              <4> 
  7701                              <4>  %if round = 0
  7702                              <4>  pxor xmmblock, xmm0
  7703                              <4>  %else
  7704                              <4>  %if round < 14
  7705 00000D8F 66440F38DCD0        <4>  aesOPERATION xmmblock, xmm0
  7706                              <4>  %else
  7707                              <4>  aesOPERATIONlast xmmblock, xmm0
  7708                              <4>  %endif
  7709                              <4>  %endif
  7710                              <4> 
  7711                              <4>  %assign block block+1
  7712                              <4> 
  7713                              <4>  %if round = 0
  7714                              <4>  pxor xmmblock, xmm0
  7715                              <4>  %else
  7716                              <4>  %if round < 14
  7717 00000D95 66440F38DCD8        <4>  aesOPERATION xmmblock, xmm0
  7718                              <4>  %else
  7719                              <4>  aesOPERATIONlast xmmblock, xmm0
  7720                              <4>  %endif
  7721                              <4>  %endif
  7722                              <4> 
  7723                              <4>  %assign block block+1
  7724                              <4> 
  7725                              <4>  %if round = 0
  7726                              <4>  pxor xmmblock, xmm0
  7727                              <4>  %else
  7728                              <4>  %if round < 14
  7729 00000D9B 66440F38DCE0        <4>  aesOPERATION xmmblock, xmm0
  7730                              <4>  %else
  7731                              <4>  aesOPERATIONlast xmmblock, xmm0
  7732                              <4>  %endif
  7733                              <4>  %endif
  7734                              <4> 
  7735                              <4>  %assign block block+1
  7736                              <4> 
  7737                              <4>  %if round = 0
  7738                              <4>  pxor xmmblock, xmm0
  7739                              <4>  %else
  7740                              <4>  %if round < 14
  7741 00000DA1 66440F38DCE8        <4>  aesOPERATION xmmblock, xmm0
  7742                              <4>  %else
  7743                              <4>  aesOPERATIONlast xmmblock, xmm0
  7744                              <4>  %endif
  7745                              <4>  %endif
  7746                              <4> 
  7747                              <4>  %assign block block+1
  7748                              <4> 
  7749                              <4>  %if round = 0
  7750                              <4>  pxor xmmblock, xmm0
  7751                              <4>  %else
  7752                              <4>  %if round < 14
  7753 00000DA7 66440F38DCF0        <4>  aesOPERATION xmmblock, xmm0
  7754                              <4>  %else
  7755                              <4>  aesOPERATIONlast xmmblock, xmm0
  7756                              <4>  %endif
  7757                              <4>  %endif
  7758                              <4> 
  7759                              <4>  %assign block block+1
  7760                              <4> 
  7761                              <4>  %if round = 0
  7762                              <4>  pxor xmmblock, xmm0
  7763                              <4>  %else
  7764                              <4>  %if round < 14
  7765 00000DAD 66440F38DCF8        <4>  aesOPERATION xmmblock, xmm0
  7766                              <4>  %else
  7767                              <4>  aesOPERATIONlast xmmblock, xmm0
  7768                              <4>  %endif
  7769                              <4>  %endif
  7770                              <4> 
  7771                              <4>  %assign block block+1
  7772                              <3> 
  7773                              <3>  %assign round round+1
  7774 00000DB3 F30F6F81B0000000    <3>  movdqu xmm0, [Rcx + 16 * round]
  7775                              <3> 
  7776                              <3>  %assign block 1
  7777                              <3>  %rep BLOCK_COUNT
  7778                              <3> 
  7779                              <3>  %if round = 0
  7780                              <3>  pxor xmmblock, xmm0
  7781                              <3>  %else
  7782                              <3>  %if round < 14
  7783                              <3>  aesOPERATION xmmblock, xmm0
  7784                              <3>  %else
  7785                              <3>  aesOPERATIONlast xmmblock, xmm0
  7786                              <3>  %endif
  7787                              <3>  %endif
  7788                              <3> 
  7789                              <3>  %assign block block+1
  7790                              <3>  %endrep
  7791                              <4> 
  7792                              <4>  %if round = 0
  7793                              <4>  pxor xmmblock, xmm0
  7794                              <4>  %else
  7795                              <4>  %if round < 14
  7796 00000DBB 660F38DCC8          <4>  aesOPERATION xmmblock, xmm0
  7797                              <4>  %else
  7798                              <4>  aesOPERATIONlast xmmblock, xmm0
  7799                              <4>  %endif
  7800                              <4>  %endif
  7801                              <4> 
  7802                              <4>  %assign block block+1
  7803                              <4> 
  7804                              <4>  %if round = 0
  7805                              <4>  pxor xmmblock, xmm0
  7806                              <4>  %else
  7807                              <4>  %if round < 14
  7808 00000DC0 660F38DCD0          <4>  aesOPERATION xmmblock, xmm0
  7809                              <4>  %else
  7810                              <4>  aesOPERATIONlast xmmblock, xmm0
  7811                              <4>  %endif
  7812                              <4>  %endif
  7813                              <4> 
  7814                              <4>  %assign block block+1
  7815                              <4> 
  7816                              <4>  %if round = 0
  7817                              <4>  pxor xmmblock, xmm0
  7818                              <4>  %else
  7819                              <4>  %if round < 14
  7820 00000DC5 660F38DCD8          <4>  aesOPERATION xmmblock, xmm0
  7821                              <4>  %else
  7822                              <4>  aesOPERATIONlast xmmblock, xmm0
  7823                              <4>  %endif
  7824                              <4>  %endif
  7825                              <4> 
  7826                              <4>  %assign block block+1
  7827                              <4> 
  7828                              <4>  %if round = 0
  7829                              <4>  pxor xmmblock, xmm0
  7830                              <4>  %else
  7831                              <4>  %if round < 14
  7832 00000DCA 660F38DCE0          <4>  aesOPERATION xmmblock, xmm0
  7833                              <4>  %else
  7834                              <4>  aesOPERATIONlast xmmblock, xmm0
  7835                              <4>  %endif
  7836                              <4>  %endif
  7837                              <4> 
  7838                              <4>  %assign block block+1
  7839                              <4> 
  7840                              <4>  %if round = 0
  7841                              <4>  pxor xmmblock, xmm0
  7842                              <4>  %else
  7843                              <4>  %if round < 14
  7844 00000DCF 660F38DCE8          <4>  aesOPERATION xmmblock, xmm0
  7845                              <4>  %else
  7846                              <4>  aesOPERATIONlast xmmblock, xmm0
  7847                              <4>  %endif
  7848                              <4>  %endif
  7849                              <4> 
  7850                              <4>  %assign block block+1
  7851                              <4> 
  7852                              <4>  %if round = 0
  7853                              <4>  pxor xmmblock, xmm0
  7854                              <4>  %else
  7855                              <4>  %if round < 14
  7856 00000DD4 660F38DCF0          <4>  aesOPERATION xmmblock, xmm0
  7857                              <4>  %else
  7858                              <4>  aesOPERATIONlast xmmblock, xmm0
  7859                              <4>  %endif
  7860                              <4>  %endif
  7861                              <4> 
  7862                              <4>  %assign block block+1
  7863                              <4> 
  7864                              <4>  %if round = 0
  7865                              <4>  pxor xmmblock, xmm0
  7866                              <4>  %else
  7867                              <4>  %if round < 14
  7868 00000DD9 660F38DCF8          <4>  aesOPERATION xmmblock, xmm0
  7869                              <4>  %else
  7870                              <4>  aesOPERATIONlast xmmblock, xmm0
  7871                              <4>  %endif
  7872                              <4>  %endif
  7873                              <4> 
  7874                              <4>  %assign block block+1
  7875                              <4> 
  7876                              <4>  %if round = 0
  7877                              <4>  pxor xmmblock, xmm0
  7878                              <4>  %else
  7879                              <4>  %if round < 14
  7880 00000DDE 66440F38DCC0        <4>  aesOPERATION xmmblock, xmm0
  7881                              <4>  %else
  7882                              <4>  aesOPERATIONlast xmmblock, xmm0
  7883                              <4>  %endif
  7884                              <4>  %endif
  7885                              <4> 
  7886                              <4>  %assign block block+1
  7887                              <4> 
  7888                              <4>  %if round = 0
  7889                              <4>  pxor xmmblock, xmm0
  7890                              <4>  %else
  7891                              <4>  %if round < 14
  7892 00000DE4 66440F38DCC8        <4>  aesOPERATION xmmblock, xmm0
  7893                              <4>  %else
  7894                              <4>  aesOPERATIONlast xmmblock, xmm0
  7895                              <4>  %endif
  7896                              <4>  %endif
  7897                              <4> 
  7898                              <4>  %assign block block+1
  7899                              <4> 
  7900                              <4>  %if round = 0
  7901                              <4>  pxor xmmblock, xmm0
  7902                              <4>  %else
  7903                              <4>  %if round < 14
  7904 00000DEA 66440F38DCD0        <4>  aesOPERATION xmmblock, xmm0
  7905                              <4>  %else
  7906                              <4>  aesOPERATIONlast xmmblock, xmm0
  7907                              <4>  %endif
  7908                              <4>  %endif
  7909                              <4> 
  7910                              <4>  %assign block block+1
  7911                              <4> 
  7912                              <4>  %if round = 0
  7913                              <4>  pxor xmmblock, xmm0
  7914                              <4>  %else
  7915                              <4>  %if round < 14
  7916 00000DF0 66440F38DCD8        <4>  aesOPERATION xmmblock, xmm0
  7917                              <4>  %else
  7918                              <4>  aesOPERATIONlast xmmblock, xmm0
  7919                              <4>  %endif
  7920                              <4>  %endif
  7921                              <4> 
  7922                              <4>  %assign block block+1
  7923                              <4> 
  7924                              <4>  %if round = 0
  7925                              <4>  pxor xmmblock, xmm0
  7926                              <4>  %else
  7927                              <4>  %if round < 14
  7928 00000DF6 66440F38DCE0        <4>  aesOPERATION xmmblock, xmm0
  7929                              <4>  %else
  7930                              <4>  aesOPERATIONlast xmmblock, xmm0
  7931                              <4>  %endif
  7932                              <4>  %endif
  7933                              <4> 
  7934                              <4>  %assign block block+1
  7935                              <4> 
  7936                              <4>  %if round = 0
  7937                              <4>  pxor xmmblock, xmm0
  7938                              <4>  %else
  7939                              <4>  %if round < 14
  7940 00000DFC 66440F38DCE8        <4>  aesOPERATION xmmblock, xmm0
  7941                              <4>  %else
  7942                              <4>  aesOPERATIONlast xmmblock, xmm0
  7943                              <4>  %endif
  7944                              <4>  %endif
  7945                              <4> 
  7946                              <4>  %assign block block+1
  7947                              <4> 
  7948                              <4>  %if round = 0
  7949                              <4>  pxor xmmblock, xmm0
  7950                              <4>  %else
  7951                              <4>  %if round < 14
  7952 00000E02 66440F38DCF0        <4>  aesOPERATION xmmblock, xmm0
  7953                              <4>  %else
  7954                              <4>  aesOPERATIONlast xmmblock, xmm0
  7955                              <4>  %endif
  7956                              <4>  %endif
  7957                              <4> 
  7958                              <4>  %assign block block+1
  7959                              <4> 
  7960                              <4>  %if round = 0
  7961                              <4>  pxor xmmblock, xmm0
  7962                              <4>  %else
  7963                              <4>  %if round < 14
  7964 00000E08 66440F38DCF8        <4>  aesOPERATION xmmblock, xmm0
  7965                              <4>  %else
  7966                              <4>  aesOPERATIONlast xmmblock, xmm0
  7967                              <4>  %endif
  7968                              <4>  %endif
  7969                              <4> 
  7970                              <4>  %assign block block+1
  7971                              <3> 
  7972                              <3>  %assign round round+1
  7973 00000E0E F30F6F81C0000000    <3>  movdqu xmm0, [Rcx + 16 * round]
  7974                              <3> 
  7975                              <3>  %assign block 1
  7976                              <3>  %rep BLOCK_COUNT
  7977                              <3> 
  7978                              <3>  %if round = 0
  7979                              <3>  pxor xmmblock, xmm0
  7980                              <3>  %else
  7981                              <3>  %if round < 14
  7982                              <3>  aesOPERATION xmmblock, xmm0
  7983                              <3>  %else
  7984                              <3>  aesOPERATIONlast xmmblock, xmm0
  7985                              <3>  %endif
  7986                              <3>  %endif
  7987                              <3> 
  7988                              <3>  %assign block block+1
  7989                              <3>  %endrep
  7990                              <4> 
  7991                              <4>  %if round = 0
  7992                              <4>  pxor xmmblock, xmm0
  7993                              <4>  %else
  7994                              <4>  %if round < 14
  7995 00000E16 660F38DCC8          <4>  aesOPERATION xmmblock, xmm0
  7996                              <4>  %else
  7997                              <4>  aesOPERATIONlast xmmblock, xmm0
  7998                              <4>  %endif
  7999                              <4>  %endif
  8000                              <4> 
  8001                              <4>  %assign block block+1
  8002                              <4> 
  8003                              <4>  %if round = 0
  8004                              <4>  pxor xmmblock, xmm0
  8005                              <4>  %else
  8006                              <4>  %if round < 14
  8007 00000E1B 660F38DCD0          <4>  aesOPERATION xmmblock, xmm0
  8008                              <4>  %else
  8009                              <4>  aesOPERATIONlast xmmblock, xmm0
  8010                              <4>  %endif
  8011                              <4>  %endif
  8012                              <4> 
  8013                              <4>  %assign block block+1
  8014                              <4> 
  8015                              <4>  %if round = 0
  8016                              <4>  pxor xmmblock, xmm0
  8017                              <4>  %else
  8018                              <4>  %if round < 14
  8019 00000E20 660F38DCD8          <4>  aesOPERATION xmmblock, xmm0
  8020                              <4>  %else
  8021                              <4>  aesOPERATIONlast xmmblock, xmm0
  8022                              <4>  %endif
  8023                              <4>  %endif
  8024                              <4> 
  8025                              <4>  %assign block block+1
  8026                              <4> 
  8027                              <4>  %if round = 0
  8028                              <4>  pxor xmmblock, xmm0
  8029                              <4>  %else
  8030                              <4>  %if round < 14
  8031 00000E25 660F38DCE0          <4>  aesOPERATION xmmblock, xmm0
  8032                              <4>  %else
  8033                              <4>  aesOPERATIONlast xmmblock, xmm0
  8034                              <4>  %endif
  8035                              <4>  %endif
  8036                              <4> 
  8037                              <4>  %assign block block+1
  8038                              <4> 
  8039                              <4>  %if round = 0
  8040                              <4>  pxor xmmblock, xmm0
  8041                              <4>  %else
  8042                              <4>  %if round < 14
  8043 00000E2A 660F38DCE8          <4>  aesOPERATION xmmblock, xmm0
  8044                              <4>  %else
  8045                              <4>  aesOPERATIONlast xmmblock, xmm0
  8046                              <4>  %endif
  8047                              <4>  %endif
  8048                              <4> 
  8049                              <4>  %assign block block+1
  8050                              <4> 
  8051                              <4>  %if round = 0
  8052                              <4>  pxor xmmblock, xmm0
  8053                              <4>  %else
  8054                              <4>  %if round < 14
  8055 00000E2F 660F38DCF0          <4>  aesOPERATION xmmblock, xmm0
  8056                              <4>  %else
  8057                              <4>  aesOPERATIONlast xmmblock, xmm0
  8058                              <4>  %endif
  8059                              <4>  %endif
  8060                              <4> 
  8061                              <4>  %assign block block+1
  8062                              <4> 
  8063                              <4>  %if round = 0
  8064                              <4>  pxor xmmblock, xmm0
  8065                              <4>  %else
  8066                              <4>  %if round < 14
  8067 00000E34 660F38DCF8          <4>  aesOPERATION xmmblock, xmm0
  8068                              <4>  %else
  8069                              <4>  aesOPERATIONlast xmmblock, xmm0
  8070                              <4>  %endif
  8071                              <4>  %endif
  8072                              <4> 
  8073                              <4>  %assign block block+1
  8074                              <4> 
  8075                              <4>  %if round = 0
  8076                              <4>  pxor xmmblock, xmm0
  8077                              <4>  %else
  8078                              <4>  %if round < 14
  8079 00000E39 66440F38DCC0        <4>  aesOPERATION xmmblock, xmm0
  8080                              <4>  %else
  8081                              <4>  aesOPERATIONlast xmmblock, xmm0
  8082                              <4>  %endif
  8083                              <4>  %endif
  8084                              <4> 
  8085                              <4>  %assign block block+1
  8086                              <4> 
  8087                              <4>  %if round = 0
  8088                              <4>  pxor xmmblock, xmm0
  8089                              <4>  %else
  8090                              <4>  %if round < 14
  8091 00000E3F 66440F38DCC8        <4>  aesOPERATION xmmblock, xmm0
  8092                              <4>  %else
  8093                              <4>  aesOPERATIONlast xmmblock, xmm0
  8094                              <4>  %endif
  8095                              <4>  %endif
  8096                              <4> 
  8097                              <4>  %assign block block+1
  8098                              <4> 
  8099                              <4>  %if round = 0
  8100                              <4>  pxor xmmblock, xmm0
  8101                              <4>  %else
  8102                              <4>  %if round < 14
  8103 00000E45 66440F38DCD0        <4>  aesOPERATION xmmblock, xmm0
  8104                              <4>  %else
  8105                              <4>  aesOPERATIONlast xmmblock, xmm0
  8106                              <4>  %endif
  8107                              <4>  %endif
  8108                              <4> 
  8109                              <4>  %assign block block+1
  8110                              <4> 
  8111                              <4>  %if round = 0
  8112                              <4>  pxor xmmblock, xmm0
  8113                              <4>  %else
  8114                              <4>  %if round < 14
  8115 00000E4B 66440F38DCD8        <4>  aesOPERATION xmmblock, xmm0
  8116                              <4>  %else
  8117                              <4>  aesOPERATIONlast xmmblock, xmm0
  8118                              <4>  %endif
  8119                              <4>  %endif
  8120                              <4> 
  8121                              <4>  %assign block block+1
  8122                              <4> 
  8123                              <4>  %if round = 0
  8124                              <4>  pxor xmmblock, xmm0
  8125                              <4>  %else
  8126                              <4>  %if round < 14
  8127 00000E51 66440F38DCE0        <4>  aesOPERATION xmmblock, xmm0
  8128                              <4>  %else
  8129                              <4>  aesOPERATIONlast xmmblock, xmm0
  8130                              <4>  %endif
  8131                              <4>  %endif
  8132                              <4> 
  8133                              <4>  %assign block block+1
  8134                              <4> 
  8135                              <4>  %if round = 0
  8136                              <4>  pxor xmmblock, xmm0
  8137                              <4>  %else
  8138                              <4>  %if round < 14
  8139 00000E57 66440F38DCE8        <4>  aesOPERATION xmmblock, xmm0
  8140                              <4>  %else
  8141                              <4>  aesOPERATIONlast xmmblock, xmm0
  8142                              <4>  %endif
  8143                              <4>  %endif
  8144                              <4> 
  8145                              <4>  %assign block block+1
  8146                              <4> 
  8147                              <4>  %if round = 0
  8148                              <4>  pxor xmmblock, xmm0
  8149                              <4>  %else
  8150                              <4>  %if round < 14
  8151 00000E5D 66440F38DCF0        <4>  aesOPERATION xmmblock, xmm0
  8152                              <4>  %else
  8153                              <4>  aesOPERATIONlast xmmblock, xmm0
  8154                              <4>  %endif
  8155                              <4>  %endif
  8156                              <4> 
  8157                              <4>  %assign block block+1
  8158                              <4> 
  8159                              <4>  %if round = 0
  8160                              <4>  pxor xmmblock, xmm0
  8161                              <4>  %else
  8162                              <4>  %if round < 14
  8163 00000E63 66440F38DCF8        <4>  aesOPERATION xmmblock, xmm0
  8164                              <4>  %else
  8165                              <4>  aesOPERATIONlast xmmblock, xmm0
  8166                              <4>  %endif
  8167                              <4>  %endif
  8168                              <4> 
  8169                              <4>  %assign block block+1
  8170                              <3> 
  8171                              <3>  %assign round round+1
  8172 00000E69 F30F6F81D0000000    <3>  movdqu xmm0, [Rcx + 16 * round]
  8173                              <3> 
  8174                              <3>  %assign block 1
  8175                              <3>  %rep BLOCK_COUNT
  8176                              <3> 
  8177                              <3>  %if round = 0
  8178                              <3>  pxor xmmblock, xmm0
  8179                              <3>  %else
  8180                              <3>  %if round < 14
  8181                              <3>  aesOPERATION xmmblock, xmm0
  8182                              <3>  %else
  8183                              <3>  aesOPERATIONlast xmmblock, xmm0
  8184                              <3>  %endif
  8185                              <3>  %endif
  8186                              <3> 
  8187                              <3>  %assign block block+1
  8188                              <3>  %endrep
  8189                              <4> 
  8190                              <4>  %if round = 0
  8191                              <4>  pxor xmmblock, xmm0
  8192                              <4>  %else
  8193                              <4>  %if round < 14
  8194 00000E71 660F38DCC8          <4>  aesOPERATION xmmblock, xmm0
  8195                              <4>  %else
  8196                              <4>  aesOPERATIONlast xmmblock, xmm0
  8197                              <4>  %endif
  8198                              <4>  %endif
  8199                              <4> 
  8200                              <4>  %assign block block+1
  8201                              <4> 
  8202                              <4>  %if round = 0
  8203                              <4>  pxor xmmblock, xmm0
  8204                              <4>  %else
  8205                              <4>  %if round < 14
  8206 00000E76 660F38DCD0          <4>  aesOPERATION xmmblock, xmm0
  8207                              <4>  %else
  8208                              <4>  aesOPERATIONlast xmmblock, xmm0
  8209                              <4>  %endif
  8210                              <4>  %endif
  8211                              <4> 
  8212                              <4>  %assign block block+1
  8213                              <4> 
  8214                              <4>  %if round = 0
  8215                              <4>  pxor xmmblock, xmm0
  8216                              <4>  %else
  8217                              <4>  %if round < 14
  8218 00000E7B 660F38DCD8          <4>  aesOPERATION xmmblock, xmm0
  8219                              <4>  %else
  8220                              <4>  aesOPERATIONlast xmmblock, xmm0
  8221                              <4>  %endif
  8222                              <4>  %endif
  8223                              <4> 
  8224                              <4>  %assign block block+1
  8225                              <4> 
  8226                              <4>  %if round = 0
  8227                              <4>  pxor xmmblock, xmm0
  8228                              <4>  %else
  8229                              <4>  %if round < 14
  8230 00000E80 660F38DCE0          <4>  aesOPERATION xmmblock, xmm0
  8231                              <4>  %else
  8232                              <4>  aesOPERATIONlast xmmblock, xmm0
  8233                              <4>  %endif
  8234                              <4>  %endif
  8235                              <4> 
  8236                              <4>  %assign block block+1
  8237                              <4> 
  8238                              <4>  %if round = 0
  8239                              <4>  pxor xmmblock, xmm0
  8240                              <4>  %else
  8241                              <4>  %if round < 14
  8242 00000E85 660F38DCE8          <4>  aesOPERATION xmmblock, xmm0
  8243                              <4>  %else
  8244                              <4>  aesOPERATIONlast xmmblock, xmm0
  8245                              <4>  %endif
  8246                              <4>  %endif
  8247                              <4> 
  8248                              <4>  %assign block block+1
  8249                              <4> 
  8250                              <4>  %if round = 0
  8251                              <4>  pxor xmmblock, xmm0
  8252                              <4>  %else
  8253                              <4>  %if round < 14
  8254 00000E8A 660F38DCF0          <4>  aesOPERATION xmmblock, xmm0
  8255                              <4>  %else
  8256                              <4>  aesOPERATIONlast xmmblock, xmm0
  8257                              <4>  %endif
  8258                              <4>  %endif
  8259                              <4> 
  8260                              <4>  %assign block block+1
  8261                              <4> 
  8262                              <4>  %if round = 0
  8263                              <4>  pxor xmmblock, xmm0
  8264                              <4>  %else
  8265                              <4>  %if round < 14
  8266 00000E8F 660F38DCF8          <4>  aesOPERATION xmmblock, xmm0
  8267                              <4>  %else
  8268                              <4>  aesOPERATIONlast xmmblock, xmm0
  8269                              <4>  %endif
  8270                              <4>  %endif
  8271                              <4> 
  8272                              <4>  %assign block block+1
  8273                              <4> 
  8274                              <4>  %if round = 0
  8275                              <4>  pxor xmmblock, xmm0
  8276                              <4>  %else
  8277                              <4>  %if round < 14
  8278 00000E94 66440F38DCC0        <4>  aesOPERATION xmmblock, xmm0
  8279                              <4>  %else
  8280                              <4>  aesOPERATIONlast xmmblock, xmm0
  8281                              <4>  %endif
  8282                              <4>  %endif
  8283                              <4> 
  8284                              <4>  %assign block block+1
  8285                              <4> 
  8286                              <4>  %if round = 0
  8287                              <4>  pxor xmmblock, xmm0
  8288                              <4>  %else
  8289                              <4>  %if round < 14
  8290 00000E9A 66440F38DCC8        <4>  aesOPERATION xmmblock, xmm0
  8291                              <4>  %else
  8292                              <4>  aesOPERATIONlast xmmblock, xmm0
  8293                              <4>  %endif
  8294                              <4>  %endif
  8295                              <4> 
  8296                              <4>  %assign block block+1
  8297                              <4> 
  8298                              <4>  %if round = 0
  8299                              <4>  pxor xmmblock, xmm0
  8300                              <4>  %else
  8301                              <4>  %if round < 14
  8302 00000EA0 66440F38DCD0        <4>  aesOPERATION xmmblock, xmm0
  8303                              <4>  %else
  8304                              <4>  aesOPERATIONlast xmmblock, xmm0
  8305                              <4>  %endif
  8306                              <4>  %endif
  8307                              <4> 
  8308                              <4>  %assign block block+1
  8309                              <4> 
  8310                              <4>  %if round = 0
  8311                              <4>  pxor xmmblock, xmm0
  8312                              <4>  %else
  8313                              <4>  %if round < 14
  8314 00000EA6 66440F38DCD8        <4>  aesOPERATION xmmblock, xmm0
  8315                              <4>  %else
  8316                              <4>  aesOPERATIONlast xmmblock, xmm0
  8317                              <4>  %endif
  8318                              <4>  %endif
  8319                              <4> 
  8320                              <4>  %assign block block+1
  8321                              <4> 
  8322                              <4>  %if round = 0
  8323                              <4>  pxor xmmblock, xmm0
  8324                              <4>  %else
  8325                              <4>  %if round < 14
  8326 00000EAC 66440F38DCE0        <4>  aesOPERATION xmmblock, xmm0
  8327                              <4>  %else
  8328                              <4>  aesOPERATIONlast xmmblock, xmm0
  8329                              <4>  %endif
  8330                              <4>  %endif
  8331                              <4> 
  8332                              <4>  %assign block block+1
  8333                              <4> 
  8334                              <4>  %if round = 0
  8335                              <4>  pxor xmmblock, xmm0
  8336                              <4>  %else
  8337                              <4>  %if round < 14
  8338 00000EB2 66440F38DCE8        <4>  aesOPERATION xmmblock, xmm0
  8339                              <4>  %else
  8340                              <4>  aesOPERATIONlast xmmblock, xmm0
  8341                              <4>  %endif
  8342                              <4>  %endif
  8343                              <4> 
  8344                              <4>  %assign block block+1
  8345                              <4> 
  8346                              <4>  %if round = 0
  8347                              <4>  pxor xmmblock, xmm0
  8348                              <4>  %else
  8349                              <4>  %if round < 14
  8350 00000EB8 66440F38DCF0        <4>  aesOPERATION xmmblock, xmm0
  8351                              <4>  %else
  8352                              <4>  aesOPERATIONlast xmmblock, xmm0
  8353                              <4>  %endif
  8354                              <4>  %endif
  8355                              <4> 
  8356                              <4>  %assign block block+1
  8357                              <4> 
  8358                              <4>  %if round = 0
  8359                              <4>  pxor xmmblock, xmm0
  8360                              <4>  %else
  8361                              <4>  %if round < 14
  8362 00000EBE 66440F38DCF8        <4>  aesOPERATION xmmblock, xmm0
  8363                              <4>  %else
  8364                              <4>  aesOPERATIONlast xmmblock, xmm0
  8365                              <4>  %endif
  8366                              <4>  %endif
  8367                              <4> 
  8368                              <4>  %assign block block+1
  8369                              <3> 
  8370                              <3>  %assign round round+1
  8371 00000EC4 F30F6F81E0000000    <3>  movdqu xmm0, [Rcx + 16 * round]
  8372                              <3> 
  8373                              <3>  %assign block 1
  8374                              <3>  %rep BLOCK_COUNT
  8375                              <3> 
  8376                              <3>  %if round = 0
  8377                              <3>  pxor xmmblock, xmm0
  8378                              <3>  %else
  8379                              <3>  %if round < 14
  8380                              <3>  aesOPERATION xmmblock, xmm0
  8381                              <3>  %else
  8382                              <3>  aesOPERATIONlast xmmblock, xmm0
  8383                              <3>  %endif
  8384                              <3>  %endif
  8385                              <3> 
  8386                              <3>  %assign block block+1
  8387                              <3>  %endrep
  8388                              <4> 
  8389                              <4>  %if round = 0
  8390                              <4>  pxor xmmblock, xmm0
  8391                              <4>  %else
  8392                              <4>  %if round < 14
  8393                              <4>  aesOPERATION xmmblock, xmm0
  8394                              <4>  %else
  8395 00000ECC 660F38DDC8          <4>  aesOPERATIONlast xmmblock, xmm0
  8396                              <4>  %endif
  8397                              <4>  %endif
  8398                              <4> 
  8399                              <4>  %assign block block+1
  8400                              <4> 
  8401                              <4>  %if round = 0
  8402                              <4>  pxor xmmblock, xmm0
  8403                              <4>  %else
  8404                              <4>  %if round < 14
  8405                              <4>  aesOPERATION xmmblock, xmm0
  8406                              <4>  %else
  8407 00000ED1 660F38DDD0          <4>  aesOPERATIONlast xmmblock, xmm0
  8408                              <4>  %endif
  8409                              <4>  %endif
  8410                              <4> 
  8411                              <4>  %assign block block+1
  8412                              <4> 
  8413                              <4>  %if round = 0
  8414                              <4>  pxor xmmblock, xmm0
  8415                              <4>  %else
  8416                              <4>  %if round < 14
  8417                              <4>  aesOPERATION xmmblock, xmm0
  8418                              <4>  %else
  8419 00000ED6 660F38DDD8          <4>  aesOPERATIONlast xmmblock, xmm0
  8420                              <4>  %endif
  8421                              <4>  %endif
  8422                              <4> 
  8423                              <4>  %assign block block+1
  8424                              <4> 
  8425                              <4>  %if round = 0
  8426                              <4>  pxor xmmblock, xmm0
  8427                              <4>  %else
  8428                              <4>  %if round < 14
  8429                              <4>  aesOPERATION xmmblock, xmm0
  8430                              <4>  %else
  8431 00000EDB 660F38DDE0          <4>  aesOPERATIONlast xmmblock, xmm0
  8432                              <4>  %endif
  8433                              <4>  %endif
  8434                              <4> 
  8435                              <4>  %assign block block+1
  8436                              <4> 
  8437                              <4>  %if round = 0
  8438                              <4>  pxor xmmblock, xmm0
  8439                              <4>  %else
  8440                              <4>  %if round < 14
  8441                              <4>  aesOPERATION xmmblock, xmm0
  8442                              <4>  %else
  8443 00000EE0 660F38DDE8          <4>  aesOPERATIONlast xmmblock, xmm0
  8444                              <4>  %endif
  8445                              <4>  %endif
  8446                              <4> 
  8447                              <4>  %assign block block+1
  8448                              <4> 
  8449                              <4>  %if round = 0
  8450                              <4>  pxor xmmblock, xmm0
  8451                              <4>  %else
  8452                              <4>  %if round < 14
  8453                              <4>  aesOPERATION xmmblock, xmm0
  8454                              <4>  %else
  8455 00000EE5 660F38DDF0          <4>  aesOPERATIONlast xmmblock, xmm0
  8456                              <4>  %endif
  8457                              <4>  %endif
  8458                              <4> 
  8459                              <4>  %assign block block+1
  8460                              <4> 
  8461                              <4>  %if round = 0
  8462                              <4>  pxor xmmblock, xmm0
  8463                              <4>  %else
  8464                              <4>  %if round < 14
  8465                              <4>  aesOPERATION xmmblock, xmm0
  8466                              <4>  %else
  8467 00000EEA 660F38DDF8          <4>  aesOPERATIONlast xmmblock, xmm0
  8468                              <4>  %endif
  8469                              <4>  %endif
  8470                              <4> 
  8471                              <4>  %assign block block+1
  8472                              <4> 
  8473                              <4>  %if round = 0
  8474                              <4>  pxor xmmblock, xmm0
  8475                              <4>  %else
  8476                              <4>  %if round < 14
  8477                              <4>  aesOPERATION xmmblock, xmm0
  8478                              <4>  %else
  8479 00000EEF 66440F38DDC0        <4>  aesOPERATIONlast xmmblock, xmm0
  8480                              <4>  %endif
  8481                              <4>  %endif
  8482                              <4> 
  8483                              <4>  %assign block block+1
  8484                              <4> 
  8485                              <4>  %if round = 0
  8486                              <4>  pxor xmmblock, xmm0
  8487                              <4>  %else
  8488                              <4>  %if round < 14
  8489                              <4>  aesOPERATION xmmblock, xmm0
  8490                              <4>  %else
  8491 00000EF5 66440F38DDC8        <4>  aesOPERATIONlast xmmblock, xmm0
  8492                              <4>  %endif
  8493                              <4>  %endif
  8494                              <4> 
  8495                              <4>  %assign block block+1
  8496                              <4> 
  8497                              <4>  %if round = 0
  8498                              <4>  pxor xmmblock, xmm0
  8499                              <4>  %else
  8500                              <4>  %if round < 14
  8501                              <4>  aesOPERATION xmmblock, xmm0
  8502                              <4>  %else
  8503 00000EFB 66440F38DDD0        <4>  aesOPERATIONlast xmmblock, xmm0
  8504                              <4>  %endif
  8505                              <4>  %endif
  8506                              <4> 
  8507                              <4>  %assign block block+1
  8508                              <4> 
  8509                              <4>  %if round = 0
  8510                              <4>  pxor xmmblock, xmm0
  8511                              <4>  %else
  8512                              <4>  %if round < 14
  8513                              <4>  aesOPERATION xmmblock, xmm0
  8514                              <4>  %else
  8515 00000F01 66440F38DDD8        <4>  aesOPERATIONlast xmmblock, xmm0
  8516                              <4>  %endif
  8517                              <4>  %endif
  8518                              <4> 
  8519                              <4>  %assign block block+1
  8520                              <4> 
  8521                              <4>  %if round = 0
  8522                              <4>  pxor xmmblock, xmm0
  8523                              <4>  %else
  8524                              <4>  %if round < 14
  8525                              <4>  aesOPERATION xmmblock, xmm0
  8526                              <4>  %else
  8527 00000F07 66440F38DDE0        <4>  aesOPERATIONlast xmmblock, xmm0
  8528                              <4>  %endif
  8529                              <4>  %endif
  8530                              <4> 
  8531                              <4>  %assign block block+1
  8532                              <4> 
  8533                              <4>  %if round = 0
  8534                              <4>  pxor xmmblock, xmm0
  8535                              <4>  %else
  8536                              <4>  %if round < 14
  8537                              <4>  aesOPERATION xmmblock, xmm0
  8538                              <4>  %else
  8539 00000F0D 66440F38DDE8        <4>  aesOPERATIONlast xmmblock, xmm0
  8540                              <4>  %endif
  8541                              <4>  %endif
  8542                              <4> 
  8543                              <4>  %assign block block+1
  8544                              <4> 
  8545                              <4>  %if round = 0
  8546                              <4>  pxor xmmblock, xmm0
  8547                              <4>  %else
  8548                              <4>  %if round < 14
  8549                              <4>  aesOPERATION xmmblock, xmm0
  8550                              <4>  %else
  8551 00000F13 66440F38DDF0        <4>  aesOPERATIONlast xmmblock, xmm0
  8552                              <4>  %endif
  8553                              <4>  %endif
  8554                              <4> 
  8555                              <4>  %assign block block+1
  8556                              <4> 
  8557                              <4>  %if round = 0
  8558                              <4>  pxor xmmblock, xmm0
  8559                              <4>  %else
  8560                              <4>  %if round < 14
  8561                              <4>  aesOPERATION xmmblock, xmm0
  8562                              <4>  %else
  8563 00000F19 66440F38DDF8        <4>  aesOPERATIONlast xmmblock, xmm0
  8564                              <4>  %endif
  8565                              <4>  %endif
  8566                              <4> 
  8567                              <4>  %assign block block+1
  8568                              <3> 
  8569                              <3>  %assign round round+1
  8570                              <2> 
  8571                              <2> 
  8572                              <2>  %assign block 1
  8573                              <2>  %rep BLOCK_COUNT
  8574                              <2>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  8575                              <2>  %assign block block+1
  8576                              <2>  %endrep
  8577 00000F1F F30F7F0A            <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  8578                              <3>  %assign block block+1
  8579 00000F23 F30F7F5210          <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  8580                              <3>  %assign block block+1
  8581 00000F28 F30F7F5A20          <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  8582                              <3>  %assign block block+1
  8583 00000F2D F30F7F6230          <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  8584                              <3>  %assign block block+1
  8585 00000F32 F30F7F6A40          <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  8586                              <3>  %assign block block+1
  8587 00000F37 F30F7F7250          <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  8588                              <3>  %assign block block+1
  8589 00000F3C F30F7F7A60          <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  8590                              <3>  %assign block block+1
  8591 00000F41 F3440F7F4270        <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  8592                              <3>  %assign block block+1
  8593 00000F47 F3440F7F8A80000000  <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  8594                              <3>  %assign block block+1
  8595 00000F50 F3440F7F9290000000  <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  8596                              <3>  %assign block block+1
  8597 00000F59 F3440F7F9AA0000000  <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  8598                              <3>  %assign block block+1
  8599 00000F62 F3440F7FA2B0000000  <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  8600                              <3>  %assign block block+1
  8601 00000F6B F3440F7FAAC0000000  <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  8602                              <3>  %assign block block+1
  8603 00000F74 F3440F7FB2D0000000  <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  8604                              <3>  %assign block block+1
  8605 00000F7D F3440F7FBAE0000000  <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  8606                              <3>  %assign block block+1
  8607                              <2> 
  8608                              <2>  %undef OPERATION
  8609                              <2>  %undef BLOCK_COUNT
  8610                              <1> 
  8611 00000F86 4881C2F0000000      <1>  add Rdx, 16 * MAX_REG_BLOCK_COUNT
  8612 00000F8D FFC8                <1>  dec eax
  8613 00000F8F 0F85F6F9FFFF        <1>  jnz .1
  8614                              <1> 
  8615                              <1>  %if (32 % MAX_REG_BLOCK_COUNT) != 0
  8616                              <1>  aes_hw_cpu OPERATION_32_BLOCKS, (32 % MAX_REG_BLOCK_COUNT)
  8617                              <2>  %define OPERATION %1
  8618                              <2>  %define BLOCK_COUNT %2
  8619                              <2> 
  8620                              <2> 
  8621                              <2>  %assign block 1
  8622                              <2>  %rep BLOCK_COUNT
  8623                              <2>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  8624                              <2>  %assign block block+1
  8625                              <2>  %endrep
  8626 00000F95 F30F6F0A            <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  8627                              <3>  %assign block block+1
  8628 00000F99 F30F6F5210          <3>  movdqu xmmblock, [Rdx + 16 * (block - 1)]
  8629                              <3>  %assign block block+1
  8630                              <2> 
  8631                              <2> 
  8632                              <2>  %assign round 0
  8633                              <2>  %rep 15
  8634                              <2>  movdqu xmm0, [Rcx + 16 * round]
  8635                              <2> 
  8636                              <2>  %assign block 1
  8637                              <2>  %rep BLOCK_COUNT
  8638                              <2> 
  8639                              <2>  %if round = 0
  8640                              <2>  pxor xmmblock, xmm0
  8641                              <2>  %else
  8642                              <2>  %if round < 14
  8643                              <2>  aesOPERATION xmmblock, xmm0
  8644                              <2>  %else
  8645                              <2>  aesOPERATIONlast xmmblock, xmm0
  8646                              <2>  %endif
  8647                              <2>  %endif
  8648                              <2> 
  8649                              <2>  %assign block block+1
  8650                              <2>  %endrep
  8651                              <2> 
  8652                              <2>  %assign round round+1
  8653                              <2>  %endrep
  8654 00000F9E F30F6F01            <3>  movdqu xmm0, [Rcx + 16 * round]
  8655                              <3> 
  8656                              <3>  %assign block 1
  8657                              <3>  %rep BLOCK_COUNT
  8658                              <3> 
  8659                              <3>  %if round = 0
  8660                              <3>  pxor xmmblock, xmm0
  8661                              <3>  %else
  8662                              <3>  %if round < 14
  8663                              <3>  aesOPERATION xmmblock, xmm0
  8664                              <3>  %else
  8665                              <3>  aesOPERATIONlast xmmblock, xmm0
  8666                              <3>  %endif
  8667                              <3>  %endif
  8668                              <3> 
  8669                              <3>  %assign block block+1
  8670                              <3>  %endrep
  8671                              <4> 
  8672                              <4>  %if round = 0
  8673 00000FA2 660FEFC8            <4>  pxor xmmblock, xmm0
  8674                              <4>  %else
  8675                              <4>  %if round < 14
  8676                              <4>  aesOPERATION xmmblock, xmm0
  8677                              <4>  %else
  8678                              <4>  aesOPERATIONlast xmmblock, xmm0
  8679                              <4>  %endif
  8680                              <4>  %endif
  8681                              <4> 
  8682                              <4>  %assign block block+1
  8683                              <4> 
  8684                              <4>  %if round = 0
  8685 00000FA6 660FEFD0            <4>  pxor xmmblock, xmm0
  8686                              <4>  %else
  8687                              <4>  %if round < 14
  8688                              <4>  aesOPERATION xmmblock, xmm0
  8689                              <4>  %else
  8690                              <4>  aesOPERATIONlast xmmblock, xmm0
  8691                              <4>  %endif
  8692                              <4>  %endif
  8693                              <4> 
  8694                              <4>  %assign block block+1
  8695                              <3> 
  8696                              <3>  %assign round round+1
  8697 00000FAA F30F6F4110          <3>  movdqu xmm0, [Rcx + 16 * round]
  8698                              <3> 
  8699                              <3>  %assign block 1
  8700                              <3>  %rep BLOCK_COUNT
  8701                              <3> 
  8702                              <3>  %if round = 0
  8703                              <3>  pxor xmmblock, xmm0
  8704                              <3>  %else
  8705                              <3>  %if round < 14
  8706                              <3>  aesOPERATION xmmblock, xmm0
  8707                              <3>  %else
  8708                              <3>  aesOPERATIONlast xmmblock, xmm0
  8709                              <3>  %endif
  8710                              <3>  %endif
  8711                              <3> 
  8712                              <3>  %assign block block+1
  8713                              <3>  %endrep
  8714                              <4> 
  8715                              <4>  %if round = 0
  8716                              <4>  pxor xmmblock, xmm0
  8717                              <4>  %else
  8718                              <4>  %if round < 14
  8719 00000FAF 660F38DCC8          <4>  aesOPERATION xmmblock, xmm0
  8720                              <4>  %else
  8721                              <4>  aesOPERATIONlast xmmblock, xmm0
  8722                              <4>  %endif
  8723                              <4>  %endif
  8724                              <4> 
  8725                              <4>  %assign block block+1
  8726                              <4> 
  8727                              <4>  %if round = 0
  8728                              <4>  pxor xmmblock, xmm0
  8729                              <4>  %else
  8730                              <4>  %if round < 14
  8731 00000FB4 660F38DCD0          <4>  aesOPERATION xmmblock, xmm0
  8732                              <4>  %else
  8733                              <4>  aesOPERATIONlast xmmblock, xmm0
  8734                              <4>  %endif
  8735                              <4>  %endif
  8736                              <4> 
  8737                              <4>  %assign block block+1
  8738                              <3> 
  8739                              <3>  %assign round round+1
  8740 00000FB9 F30F6F4120          <3>  movdqu xmm0, [Rcx + 16 * round]
  8741                              <3> 
  8742                              <3>  %assign block 1
  8743                              <3>  %rep BLOCK_COUNT
  8744                              <3> 
  8745                              <3>  %if round = 0
  8746                              <3>  pxor xmmblock, xmm0
  8747                              <3>  %else
  8748                              <3>  %if round < 14
  8749                              <3>  aesOPERATION xmmblock, xmm0
  8750                              <3>  %else
  8751                              <3>  aesOPERATIONlast xmmblock, xmm0
  8752                              <3>  %endif
  8753                              <3>  %endif
  8754                              <3> 
  8755                              <3>  %assign block block+1
  8756                              <3>  %endrep
  8757                              <4> 
  8758                              <4>  %if round = 0
  8759                              <4>  pxor xmmblock, xmm0
  8760                              <4>  %else
  8761                              <4>  %if round < 14
  8762 00000FBE 660F38DCC8          <4>  aesOPERATION xmmblock, xmm0
  8763                              <4>  %else
  8764                              <4>  aesOPERATIONlast xmmblock, xmm0
  8765                              <4>  %endif
  8766                              <4>  %endif
  8767                              <4> 
  8768                              <4>  %assign block block+1
  8769                              <4> 
  8770                              <4>  %if round = 0
  8771                              <4>  pxor xmmblock, xmm0
  8772                              <4>  %else
  8773                              <4>  %if round < 14
  8774 00000FC3 660F38DCD0          <4>  aesOPERATION xmmblock, xmm0
  8775                              <4>  %else
  8776                              <4>  aesOPERATIONlast xmmblock, xmm0
  8777                              <4>  %endif
  8778                              <4>  %endif
  8779                              <4> 
  8780                              <4>  %assign block block+1
  8781                              <3> 
  8782                              <3>  %assign round round+1
  8783 00000FC8 F30F6F4130          <3>  movdqu xmm0, [Rcx + 16 * round]
  8784                              <3> 
  8785                              <3>  %assign block 1
  8786                              <3>  %rep BLOCK_COUNT
  8787                              <3> 
  8788                              <3>  %if round = 0
  8789                              <3>  pxor xmmblock, xmm0
  8790                              <3>  %else
  8791                              <3>  %if round < 14
  8792                              <3>  aesOPERATION xmmblock, xmm0
  8793                              <3>  %else
  8794                              <3>  aesOPERATIONlast xmmblock, xmm0
  8795                              <3>  %endif
  8796                              <3>  %endif
  8797                              <3> 
  8798                              <3>  %assign block block+1
  8799                              <3>  %endrep
  8800                              <4> 
  8801                              <4>  %if round = 0
  8802                              <4>  pxor xmmblock, xmm0
  8803                              <4>  %else
  8804                              <4>  %if round < 14
  8805 00000FCD 660F38DCC8          <4>  aesOPERATION xmmblock, xmm0
  8806                              <4>  %else
  8807                              <4>  aesOPERATIONlast xmmblock, xmm0
  8808                              <4>  %endif
  8809                              <4>  %endif
  8810                              <4> 
  8811                              <4>  %assign block block+1
  8812                              <4> 
  8813                              <4>  %if round = 0
  8814                              <4>  pxor xmmblock, xmm0
  8815                              <4>  %else
  8816                              <4>  %if round < 14
  8817 00000FD2 660F38DCD0          <4>  aesOPERATION xmmblock, xmm0
  8818                              <4>  %else
  8819                              <4>  aesOPERATIONlast xmmblock, xmm0
  8820                              <4>  %endif
  8821                              <4>  %endif
  8822                              <4> 
  8823                              <4>  %assign block block+1
  8824                              <3> 
  8825                              <3>  %assign round round+1
  8826 00000FD7 F30F6F4140          <3>  movdqu xmm0, [Rcx + 16 * round]
  8827                              <3> 
  8828                              <3>  %assign block 1
  8829                              <3>  %rep BLOCK_COUNT
  8830                              <3> 
  8831                              <3>  %if round = 0
  8832                              <3>  pxor xmmblock, xmm0
  8833                              <3>  %else
  8834                              <3>  %if round < 14
  8835                              <3>  aesOPERATION xmmblock, xmm0
  8836                              <3>  %else
  8837                              <3>  aesOPERATIONlast xmmblock, xmm0
  8838                              <3>  %endif
  8839                              <3>  %endif
  8840                              <3> 
  8841                              <3>  %assign block block+1
  8842                              <3>  %endrep
  8843                              <4> 
  8844                              <4>  %if round = 0
  8845                              <4>  pxor xmmblock, xmm0
  8846                              <4>  %else
  8847                              <4>  %if round < 14
  8848 00000FDC 660F38DCC8          <4>  aesOPERATION xmmblock, xmm0
  8849                              <4>  %else
  8850                              <4>  aesOPERATIONlast xmmblock, xmm0
  8851                              <4>  %endif
  8852                              <4>  %endif
  8853                              <4> 
  8854                              <4>  %assign block block+1
  8855                              <4> 
  8856                              <4>  %if round = 0
  8857                              <4>  pxor xmmblock, xmm0
  8858                              <4>  %else
  8859                              <4>  %if round < 14
  8860 00000FE1 660F38DCD0          <4>  aesOPERATION xmmblock, xmm0
  8861                              <4>  %else
  8862                              <4>  aesOPERATIONlast xmmblock, xmm0
  8863                              <4>  %endif
  8864                              <4>  %endif
  8865                              <4> 
  8866                              <4>  %assign block block+1
  8867                              <3> 
  8868                              <3>  %assign round round+1
  8869 00000FE6 F30F6F4150          <3>  movdqu xmm0, [Rcx + 16 * round]
  8870                              <3> 
  8871                              <3>  %assign block 1
  8872                              <3>  %rep BLOCK_COUNT
  8873                              <3> 
  8874                              <3>  %if round = 0
  8875                              <3>  pxor xmmblock, xmm0
  8876                              <3>  %else
  8877                              <3>  %if round < 14
  8878                              <3>  aesOPERATION xmmblock, xmm0
  8879                              <3>  %else
  8880                              <3>  aesOPERATIONlast xmmblock, xmm0
  8881                              <3>  %endif
  8882                              <3>  %endif
  8883                              <3> 
  8884                              <3>  %assign block block+1
  8885                              <3>  %endrep
  8886                              <4> 
  8887                              <4>  %if round = 0
  8888                              <4>  pxor xmmblock, xmm0
  8889                              <4>  %else
  8890                              <4>  %if round < 14
  8891 00000FEB 660F38DCC8          <4>  aesOPERATION xmmblock, xmm0
  8892                              <4>  %else
  8893                              <4>  aesOPERATIONlast xmmblock, xmm0
  8894                              <4>  %endif
  8895                              <4>  %endif
  8896                              <4> 
  8897                              <4>  %assign block block+1
  8898                              <4> 
  8899                              <4>  %if round = 0
  8900                              <4>  pxor xmmblock, xmm0
  8901                              <4>  %else
  8902                              <4>  %if round < 14
  8903 00000FF0 660F38DCD0          <4>  aesOPERATION xmmblock, xmm0
  8904                              <4>  %else
  8905                              <4>  aesOPERATIONlast xmmblock, xmm0
  8906                              <4>  %endif
  8907                              <4>  %endif
  8908                              <4> 
  8909                              <4>  %assign block block+1
  8910                              <3> 
  8911                              <3>  %assign round round+1
  8912 00000FF5 F30F6F4160          <3>  movdqu xmm0, [Rcx + 16 * round]
  8913                              <3> 
  8914                              <3>  %assign block 1
  8915                              <3>  %rep BLOCK_COUNT
  8916                              <3> 
  8917                              <3>  %if round = 0
  8918                              <3>  pxor xmmblock, xmm0
  8919                              <3>  %else
  8920                              <3>  %if round < 14
  8921                              <3>  aesOPERATION xmmblock, xmm0
  8922                              <3>  %else
  8923                              <3>  aesOPERATIONlast xmmblock, xmm0
  8924                              <3>  %endif
  8925                              <3>  %endif
  8926                              <3> 
  8927                              <3>  %assign block block+1
  8928                              <3>  %endrep
  8929                              <4> 
  8930                              <4>  %if round = 0
  8931                              <4>  pxor xmmblock, xmm0
  8932                              <4>  %else
  8933                              <4>  %if round < 14
  8934 00000FFA 660F38DCC8          <4>  aesOPERATION xmmblock, xmm0
  8935                              <4>  %else
  8936                              <4>  aesOPERATIONlast xmmblock, xmm0
  8937                              <4>  %endif
  8938                              <4>  %endif
  8939                              <4> 
  8940                              <4>  %assign block block+1
  8941                              <4> 
  8942                              <4>  %if round = 0
  8943                              <4>  pxor xmmblock, xmm0
  8944                              <4>  %else
  8945                              <4>  %if round < 14
  8946 00000FFF 660F38DCD0          <4>  aesOPERATION xmmblock, xmm0
  8947                              <4>  %else
  8948                              <4>  aesOPERATIONlast xmmblock, xmm0
  8949                              <4>  %endif
  8950                              <4>  %endif
  8951                              <4> 
  8952                              <4>  %assign block block+1
  8953                              <3> 
  8954                              <3>  %assign round round+1
  8955 00001004 F30F6F4170          <3>  movdqu xmm0, [Rcx + 16 * round]
  8956                              <3> 
  8957                              <3>  %assign block 1
  8958                              <3>  %rep BLOCK_COUNT
  8959                              <3> 
  8960                              <3>  %if round = 0
  8961                              <3>  pxor xmmblock, xmm0
  8962                              <3>  %else
  8963                              <3>  %if round < 14
  8964                              <3>  aesOPERATION xmmblock, xmm0
  8965                              <3>  %else
  8966                              <3>  aesOPERATIONlast xmmblock, xmm0
  8967                              <3>  %endif
  8968                              <3>  %endif
  8969                              <3> 
  8970                              <3>  %assign block block+1
  8971                              <3>  %endrep
  8972                              <4> 
  8973                              <4>  %if round = 0
  8974                              <4>  pxor xmmblock, xmm0
  8975                              <4>  %else
  8976                              <4>  %if round < 14
  8977 00001009 660F38DCC8          <4>  aesOPERATION xmmblock, xmm0
  8978                              <4>  %else
  8979                              <4>  aesOPERATIONlast xmmblock, xmm0
  8980                              <4>  %endif
  8981                              <4>  %endif
  8982                              <4> 
  8983                              <4>  %assign block block+1
  8984                              <4> 
  8985                              <4>  %if round = 0
  8986                              <4>  pxor xmmblock, xmm0
  8987                              <4>  %else
  8988                              <4>  %if round < 14
  8989 0000100E 660F38DCD0          <4>  aesOPERATION xmmblock, xmm0
  8990                              <4>  %else
  8991                              <4>  aesOPERATIONlast xmmblock, xmm0
  8992                              <4>  %endif
  8993                              <4>  %endif
  8994                              <4> 
  8995                              <4>  %assign block block+1
  8996                              <3> 
  8997                              <3>  %assign round round+1
  8998 00001013 F30F6F8180000000    <3>  movdqu xmm0, [Rcx + 16 * round]
  8999                              <3> 
  9000                              <3>  %assign block 1
  9001                              <3>  %rep BLOCK_COUNT
  9002                              <3> 
  9003                              <3>  %if round = 0
  9004                              <3>  pxor xmmblock, xmm0
  9005                              <3>  %else
  9006                              <3>  %if round < 14
  9007                              <3>  aesOPERATION xmmblock, xmm0
  9008                              <3>  %else
  9009                              <3>  aesOPERATIONlast xmmblock, xmm0
  9010                              <3>  %endif
  9011                              <3>  %endif
  9012                              <3> 
  9013                              <3>  %assign block block+1
  9014                              <3>  %endrep
  9015                              <4> 
  9016                              <4>  %if round = 0
  9017                              <4>  pxor xmmblock, xmm0
  9018                              <4>  %else
  9019                              <4>  %if round < 14
  9020 0000101B 660F38DCC8          <4>  aesOPERATION xmmblock, xmm0
  9021                              <4>  %else
  9022                              <4>  aesOPERATIONlast xmmblock, xmm0
  9023                              <4>  %endif
  9024                              <4>  %endif
  9025                              <4> 
  9026                              <4>  %assign block block+1
  9027                              <4> 
  9028                              <4>  %if round = 0
  9029                              <4>  pxor xmmblock, xmm0
  9030                              <4>  %else
  9031                              <4>  %if round < 14
  9032 00001020 660F38DCD0          <4>  aesOPERATION xmmblock, xmm0
  9033                              <4>  %else
  9034                              <4>  aesOPERATIONlast xmmblock, xmm0
  9035                              <4>  %endif
  9036                              <4>  %endif
  9037                              <4> 
  9038                              <4>  %assign block block+1
  9039                              <3> 
  9040                              <3>  %assign round round+1
  9041 00001025 F30F6F8190000000    <3>  movdqu xmm0, [Rcx + 16 * round]
  9042                              <3> 
  9043                              <3>  %assign block 1
  9044                              <3>  %rep BLOCK_COUNT
  9045                              <3> 
  9046                              <3>  %if round = 0
  9047                              <3>  pxor xmmblock, xmm0
  9048                              <3>  %else
  9049                              <3>  %if round < 14
  9050                              <3>  aesOPERATION xmmblock, xmm0
  9051                              <3>  %else
  9052                              <3>  aesOPERATIONlast xmmblock, xmm0
  9053                              <3>  %endif
  9054                              <3>  %endif
  9055                              <3> 
  9056                              <3>  %assign block block+1
  9057                              <3>  %endrep
  9058                              <4> 
  9059                              <4>  %if round = 0
  9060                              <4>  pxor xmmblock, xmm0
  9061                              <4>  %else
  9062                              <4>  %if round < 14
  9063 0000102D 660F38DCC8          <4>  aesOPERATION xmmblock, xmm0
  9064                              <4>  %else
  9065                              <4>  aesOPERATIONlast xmmblock, xmm0
  9066                              <4>  %endif
  9067                              <4>  %endif
  9068                              <4> 
  9069                              <4>  %assign block block+1
  9070                              <4> 
  9071                              <4>  %if round = 0
  9072                              <4>  pxor xmmblock, xmm0
  9073                              <4>  %else
  9074                              <4>  %if round < 14
  9075 00001032 660F38DCD0          <4>  aesOPERATION xmmblock, xmm0
  9076                              <4>  %else
  9077                              <4>  aesOPERATIONlast xmmblock, xmm0
  9078                              <4>  %endif
  9079                              <4>  %endif
  9080                              <4> 
  9081                              <4>  %assign block block+1
  9082                              <3> 
  9083                              <3>  %assign round round+1
  9084 00001037 F30F6F81A0000000    <3>  movdqu xmm0, [Rcx + 16 * round]
  9085                              <3> 
  9086                              <3>  %assign block 1
  9087                              <3>  %rep BLOCK_COUNT
  9088                              <3> 
  9089                              <3>  %if round = 0
  9090                              <3>  pxor xmmblock, xmm0
  9091                              <3>  %else
  9092                              <3>  %if round < 14
  9093                              <3>  aesOPERATION xmmblock, xmm0
  9094                              <3>  %else
  9095                              <3>  aesOPERATIONlast xmmblock, xmm0
  9096                              <3>  %endif
  9097                              <3>  %endif
  9098                              <3> 
  9099                              <3>  %assign block block+1
  9100                              <3>  %endrep
  9101                              <4> 
  9102                              <4>  %if round = 0
  9103                              <4>  pxor xmmblock, xmm0
  9104                              <4>  %else
  9105                              <4>  %if round < 14
  9106 0000103F 660F38DCC8          <4>  aesOPERATION xmmblock, xmm0
  9107                              <4>  %else
  9108                              <4>  aesOPERATIONlast xmmblock, xmm0
  9109                              <4>  %endif
  9110                              <4>  %endif
  9111                              <4> 
  9112                              <4>  %assign block block+1
  9113                              <4> 
  9114                              <4>  %if round = 0
  9115                              <4>  pxor xmmblock, xmm0
  9116                              <4>  %else
  9117                              <4>  %if round < 14
  9118 00001044 660F38DCD0          <4>  aesOPERATION xmmblock, xmm0
  9119                              <4>  %else
  9120                              <4>  aesOPERATIONlast xmmblock, xmm0
  9121                              <4>  %endif
  9122                              <4>  %endif
  9123                              <4> 
  9124                              <4>  %assign block block+1
  9125                              <3> 
  9126                              <3>  %assign round round+1
  9127 00001049 F30F6F81B0000000    <3>  movdqu xmm0, [Rcx + 16 * round]
  9128                              <3> 
  9129                              <3>  %assign block 1
  9130                              <3>  %rep BLOCK_COUNT
  9131                              <3> 
  9132                              <3>  %if round = 0
  9133                              <3>  pxor xmmblock, xmm0
  9134                              <3>  %else
  9135                              <3>  %if round < 14
  9136                              <3>  aesOPERATION xmmblock, xmm0
  9137                              <3>  %else
  9138                              <3>  aesOPERATIONlast xmmblock, xmm0
  9139                              <3>  %endif
  9140                              <3>  %endif
  9141                              <3> 
  9142                              <3>  %assign block block+1
  9143                              <3>  %endrep
  9144                              <4> 
  9145                              <4>  %if round = 0
  9146                              <4>  pxor xmmblock, xmm0
  9147                              <4>  %else
  9148                              <4>  %if round < 14
  9149 00001051 660F38DCC8          <4>  aesOPERATION xmmblock, xmm0
  9150                              <4>  %else
  9151                              <4>  aesOPERATIONlast xmmblock, xmm0
  9152                              <4>  %endif
  9153                              <4>  %endif
  9154                              <4> 
  9155                              <4>  %assign block block+1
  9156                              <4> 
  9157                              <4>  %if round = 0
  9158                              <4>  pxor xmmblock, xmm0
  9159                              <4>  %else
  9160                              <4>  %if round < 14
  9161 00001056 660F38DCD0          <4>  aesOPERATION xmmblock, xmm0
  9162                              <4>  %else
  9163                              <4>  aesOPERATIONlast xmmblock, xmm0
  9164                              <4>  %endif
  9165                              <4>  %endif
  9166                              <4> 
  9167                              <4>  %assign block block+1
  9168                              <3> 
  9169                              <3>  %assign round round+1
  9170 0000105B F30F6F81C0000000    <3>  movdqu xmm0, [Rcx + 16 * round]
  9171                              <3> 
  9172                              <3>  %assign block 1
  9173                              <3>  %rep BLOCK_COUNT
  9174                              <3> 
  9175                              <3>  %if round = 0
  9176                              <3>  pxor xmmblock, xmm0
  9177                              <3>  %else
  9178                              <3>  %if round < 14
  9179                              <3>  aesOPERATION xmmblock, xmm0
  9180                              <3>  %else
  9181                              <3>  aesOPERATIONlast xmmblock, xmm0
  9182                              <3>  %endif
  9183                              <3>  %endif
  9184                              <3> 
  9185                              <3>  %assign block block+1
  9186                              <3>  %endrep
  9187                              <4> 
  9188                              <4>  %if round = 0
  9189                              <4>  pxor xmmblock, xmm0
  9190                              <4>  %else
  9191                              <4>  %if round < 14
  9192 00001063 660F38DCC8          <4>  aesOPERATION xmmblock, xmm0
  9193                              <4>  %else
  9194                              <4>  aesOPERATIONlast xmmblock, xmm0
  9195                              <4>  %endif
  9196                              <4>  %endif
  9197                              <4> 
  9198                              <4>  %assign block block+1
  9199                              <4> 
  9200                              <4>  %if round = 0
  9201                              <4>  pxor xmmblock, xmm0
  9202                              <4>  %else
  9203                              <4>  %if round < 14
  9204 00001068 660F38DCD0          <4>  aesOPERATION xmmblock, xmm0
  9205                              <4>  %else
  9206                              <4>  aesOPERATIONlast xmmblock, xmm0
  9207                              <4>  %endif
  9208                              <4>  %endif
  9209                              <4> 
  9210                              <4>  %assign block block+1
  9211                              <3> 
  9212                              <3>  %assign round round+1
  9213 0000106D F30F6F81D0000000    <3>  movdqu xmm0, [Rcx + 16 * round]
  9214                              <3> 
  9215                              <3>  %assign block 1
  9216                              <3>  %rep BLOCK_COUNT
  9217                              <3> 
  9218                              <3>  %if round = 0
  9219                              <3>  pxor xmmblock, xmm0
  9220                              <3>  %else
  9221                              <3>  %if round < 14
  9222                              <3>  aesOPERATION xmmblock, xmm0
  9223                              <3>  %else
  9224                              <3>  aesOPERATIONlast xmmblock, xmm0
  9225                              <3>  %endif
  9226                              <3>  %endif
  9227                              <3> 
  9228                              <3>  %assign block block+1
  9229                              <3>  %endrep
  9230                              <4> 
  9231                              <4>  %if round = 0
  9232                              <4>  pxor xmmblock, xmm0
  9233                              <4>  %else
  9234                              <4>  %if round < 14
  9235 00001075 660F38DCC8          <4>  aesOPERATION xmmblock, xmm0
  9236                              <4>  %else
  9237                              <4>  aesOPERATIONlast xmmblock, xmm0
  9238                              <4>  %endif
  9239                              <4>  %endif
  9240                              <4> 
  9241                              <4>  %assign block block+1
  9242                              <4> 
  9243                              <4>  %if round = 0
  9244                              <4>  pxor xmmblock, xmm0
  9245                              <4>  %else
  9246                              <4>  %if round < 14
  9247 0000107A 660F38DCD0          <4>  aesOPERATION xmmblock, xmm0
  9248                              <4>  %else
  9249                              <4>  aesOPERATIONlast xmmblock, xmm0
  9250                              <4>  %endif
  9251                              <4>  %endif
  9252                              <4> 
  9253                              <4>  %assign block block+1
  9254                              <3> 
  9255                              <3>  %assign round round+1
  9256 0000107F F30F6F81E0000000    <3>  movdqu xmm0, [Rcx + 16 * round]
  9257                              <3> 
  9258                              <3>  %assign block 1
  9259                              <3>  %rep BLOCK_COUNT
  9260                              <3> 
  9261                              <3>  %if round = 0
  9262                              <3>  pxor xmmblock, xmm0
  9263                              <3>  %else
  9264                              <3>  %if round < 14
  9265                              <3>  aesOPERATION xmmblock, xmm0
  9266                              <3>  %else
  9267                              <3>  aesOPERATIONlast xmmblock, xmm0
  9268                              <3>  %endif
  9269                              <3>  %endif
  9270                              <3> 
  9271                              <3>  %assign block block+1
  9272                              <3>  %endrep
  9273                              <4> 
  9274                              <4>  %if round = 0
  9275                              <4>  pxor xmmblock, xmm0
  9276                              <4>  %else
  9277                              <4>  %if round < 14
  9278                              <4>  aesOPERATION xmmblock, xmm0
  9279                              <4>  %else
  9280 00001087 660F38DDC8          <4>  aesOPERATIONlast xmmblock, xmm0
  9281                              <4>  %endif
  9282                              <4>  %endif
  9283                              <4> 
  9284                              <4>  %assign block block+1
  9285                              <4> 
  9286                              <4>  %if round = 0
  9287                              <4>  pxor xmmblock, xmm0
  9288                              <4>  %else
  9289                              <4>  %if round < 14
  9290                              <4>  aesOPERATION xmmblock, xmm0
  9291                              <4>  %else
  9292 0000108C 660F38DDD0          <4>  aesOPERATIONlast xmmblock, xmm0
  9293                              <4>  %endif
  9294                              <4>  %endif
  9295                              <4> 
  9296                              <4>  %assign block block+1
  9297                              <3> 
  9298                              <3>  %assign round round+1
  9299                              <2> 
  9300                              <2> 
  9301                              <2>  %assign block 1
  9302                              <2>  %rep BLOCK_COUNT
  9303                              <2>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  9304                              <2>  %assign block block+1
  9305                              <2>  %endrep
  9306 00001091 F30F7F0A            <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  9307                              <3>  %assign block block+1
  9308 00001095 F30F7F5210          <3>  movdqu [Rdx + 16 * (block - 1)], xmmblock
  9309                              <3>  %assign block block+1
  9310                              <2> 
  9311                              <2>  %undef OPERATION
  9312                              <2>  %undef BLOCK_COUNT
  9313                              <1>  %endif
  9314                              <1> 
  9315                              <1>  %ifidn __OUTPUT_FORMAT__, win64
  9316                              <1>  %if MAX_REG_BLOCK_COUNT > 5
  9317                              <1>  pop_xmm 6, MAX_REG_BLOCK_COUNT
  9318                              <2>  %assign stackoffset 0
  9319                              <2>  %assign regnumber %1
  9320                              <2> 
  9321                              <2>  %rep (%2 - %1 + 1)
  9322                              <2>  movdqu xmmregnumber, [rsp + 16 * stackoffset]
  9323                              <2> 
  9324                              <2>  %assign stackoffset stackoffset+1
  9325                              <2>  %assign regnumber regnumber+1
  9326                              <2>  %endrep
  9327 0000109A F30F6F3424          <3>  movdqu xmmregnumber, [rsp + 16 * stackoffset]
  9328                              <3> 
  9329                              <3>  %assign stackoffset stackoffset+1
  9330                              <3>  %assign regnumber regnumber+1
  9331 0000109F F30F6F7C2410        <3>  movdqu xmmregnumber, [rsp + 16 * stackoffset]
  9332                              <3> 
  9333                              <3>  %assign stackoffset stackoffset+1
  9334                              <3>  %assign regnumber regnumber+1
  9335 000010A5 F3440F6F442420      <3>  movdqu xmmregnumber, [rsp + 16 * stackoffset]
  9336                              <3> 
  9337                              <3>  %assign stackoffset stackoffset+1
  9338                              <3>  %assign regnumber regnumber+1
  9339 000010AC F3440F6F4C2430      <3>  movdqu xmmregnumber, [rsp + 16 * stackoffset]
  9340                              <3> 
  9341                              <3>  %assign stackoffset stackoffset+1
  9342                              <3>  %assign regnumber regnumber+1
  9343 000010B3 F3440F6F542440      <3>  movdqu xmmregnumber, [rsp + 16 * stackoffset]
  9344                              <3> 
  9345                              <3>  %assign stackoffset stackoffset+1
  9346                              <3>  %assign regnumber regnumber+1
  9347 000010BA F3440F6F5C2450      <3>  movdqu xmmregnumber, [rsp + 16 * stackoffset]
  9348                              <3> 
  9349                              <3>  %assign stackoffset stackoffset+1
  9350                              <3>  %assign regnumber regnumber+1
  9351 000010C1 F3440F6F642460      <3>  movdqu xmmregnumber, [rsp + 16 * stackoffset]
  9352                              <3> 
  9353                              <3>  %assign stackoffset stackoffset+1
  9354                              <3>  %assign regnumber regnumber+1
  9355 000010C8 F3440F6F6C2470      <3>  movdqu xmmregnumber, [rsp + 16 * stackoffset]
  9356                              <3> 
  9357                              <3>  %assign stackoffset stackoffset+1
  9358                              <3>  %assign regnumber regnumber+1
  9359 000010CF F3440F6FB424800000- <3>  movdqu xmmregnumber, [rsp + 16 * stackoffset]
  9360 000010D8 00                  <3>
  9361                              <3> 
  9362                              <3>  %assign stackoffset stackoffset+1
  9363                              <3>  %assign regnumber regnumber+1
  9364 000010D9 F3440F6FBC24900000- <3>  movdqu xmmregnumber, [rsp + 16 * stackoffset]
  9365 000010E2 00                  <3>
  9366                              <3> 
  9367                              <3>  %assign stackoffset stackoffset+1
  9368                              <3>  %assign regnumber regnumber+1
  9369                              <2> 
  9370 000010E3 4881C4A0000000      <2>  add rsp, 16 * (%2 - %1 + 1)
  9371                              <1>  %endif
  9372                              <1>  %endif
  9373                              <1> 
  9374                              <1>  %undef OPERATION_32_BLOCKS
  9375                              <1>  %undef MAX_REG_BLOCK_COUNT
  9376                                  	aes_function_exit
  9377                              <1> 
  9378                              <1> 
  9379                              <1> 
  9380                              <1>  %ifdef MS_STDCALL
  9381                              <1>  ret 8
  9382                              <1>  %else
  9383 000010EA C3                  <1>  ret
  9384                              <1>  %endif
  9385                              <1> 
  9386                                  
  9387                                  
  9388                                  %endif	; __BITS__ != 16
